/* Generated by Spago v0.93.44 */
(()=>{var gc=function(t){return function(e){for(var n=t.length,r=e.length,u=new Array(n*r),a=0,o=0;o<n;o++)for(var l=t[o],i=0;i<r;i++)u[a++]=l(e[i]);return u}};var la={compose:function(t){return function(e){return function(n){return t(e(n))}}}};var G=function(t){return t.identity},Q={identity:function(t){return t},Semigroupoid0:function(){return la}};var kt=!0;var et=function(t){return function(e){return function(n){return t(n)(e)}}},tt=function(t){return function(e){return t}};var hc=function(t){return function(e){for(var n=e.length,r=new Array(n),u=0;u<n;u++)r[u]=t(e[u]);return r}};var B=function(){function t(){}return t.value=new t,t}();var v=function(t){return t.map},ae=function(t){var e=v(t);return function(n){return function(r){return e(r)(n)}}},At=function(t){return v(t)(tt(void 0))};var an=function(t){var e=v(t);return function(n){return e(tt(n))}};var Wt={map:hc};var wv=G(Q);var ca={apply:gc,Functor0:function(){return Wt}},dt=function(t){return t.apply},Rc=function(t){var e=dt(t),n=v(t.Functor0());return function(r){return function(u){return e(n(tt)(r))(u)}}},ve=function(t){var e=dt(t),n=v(t.Functor0());return function(r){return function(u){return e(n(tt(wv))(r))(u)}}};var R=function(t){return t.pure};var to=function(t){var e=dt(t.Apply0()),n=R(t);return function(r){return function(u){return e(n(r))(u)}}};var Dc=typeof Array.prototype.flatMap=="function"?function(t){return function(e){return t.flatMap(e)}}:function(t){return function(e){for(var n=[],r=t.length,u=0;u<r;u++)for(var a=e(t[u]),o=a.length,l=0;l<o;l++)n.push(a[l]);return n}};var $e=function(t){return t.discard};var sa={bind:Dc,Apply0:function(){return ca}},E=function(t){return t.bind},De=function(t){return et(E(t))};var qe={discard:function(t){return E(t)}};var Fc=function(t){return function(e){return function(n){for(var r=e,u=n.length,a=u-1;a>=0;a--)r=t(n[a])(r);return r}}},wc=function(t){return function(e){return function(n){for(var r=e,u=n.length,a=0;a<u;a++)r=t(r)(n[a]);return r}}};var bc=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var ue=function(t){return t.reflectSymbol};var we=function(t){return function(e){return e[t]}},me=function(t){return function(e){return function(n){var r={};for(var u in n)({}).hasOwnProperty.call(n,u)&&(r[u]=n[u]);return r[t]=e,r}}};var Be={append:bc};var q=function(t){return t.append};var Lt=function(t){return t.alt};var Cc="\uFFFF",Ec="\0",Nv=Number.POSITIVE_INFINITY,Sv=Number.NEGATIVE_INFINITY;var Bu=function(t){return function(e){return function(n){return function(r){return function(u){return r<u?t:r===u?e:n}}}}};var Mc=Bu,xc=Bu;var Lc=Bu;var ku=function(t){return function(e){return t===e}};var Ic=ku,Nc=ku,Sc=ku;var Pc={eq:Nc},da={eq:Ic},pa={eq:Sc};var Y=function(t){return t.eq};var k=function(){function t(){}return t.value=new t,t}(),U=function(){function t(){}return t.value=new t,t}(),rt=function(){function t(){}return t.value=new t,t}();var vr={eq:function(t){return function(e){return t instanceof k&&e instanceof k||t instanceof U&&e instanceof U||t instanceof rt&&e instanceof rt}}};var Ac=function(t){return function(e){return t-e|0}},Wc=function(t){return function(e){return t-e}};var Uc=function(t){return function(e){return t+e|0}},Hc=function(t){return function(e){return t*e|0}},$c=function(t){return function(e){return t+e}},qc=function(t){return function(e){return t*e}};var Oc=function(t){return t.zeroRecord},be=function(t){return t.zero};var mr={addRecord:function(t){return function(e){return function(n){return{}}}},mulRecord:function(t){return function(e){return function(n){return{}}}},oneRecord:function(t){return function(e){return{}}},zeroRecord:function(t){return function(e){return{}}}};var ke={add:$c,zero:0,mul:qc,one:1},va={add:Uc,zero:0,mul:Hc,one:1},Bc=function(t){return t.oneRecord},ze=function(t){return t.one},kc=function(t){return t.mulRecord},le=function(t){return t.mul},zc=function(t){return t.addRecord},_r=function(){return function(t){return{add:zc(t)(B.value),mul:kc(t)(B.value),one:Bc(t)(B.value)(B.value),zero:Oc(t)(B.value)(B.value)}}},_e=function(t){return t.add};var Rn=function(t){var e=ue(t);return function(){return function(n){var r=zc(n),u=kc(n),a=Bc(n),o=Oc(n);return function(l){var i=_e(l),f=le(l),c=ze(l),p=be(l);return{addRecord:function(m){return function(h){return function(w){var C=r(B.value)(h)(w),W=e(B.value),J=me(W),st=we(W);return J(i(st(h))(st(w)))(C)}}},mulRecord:function(m){return function(h){return function(w){var C=u(B.value)(h)(w),W=e(B.value),J=me(W),st=we(W);return J(f(st(h))(st(w)))(C)}}},oneRecord:function(m){return function(h){var w=a(B.value)(B.value),C=e(B.value),W=me(C);return W(c)(w)}},zeroRecord:function(m){return function(h){var w=o(B.value)(B.value),C=e(B.value),W=me(C);return W(p)(w)}}}}}}};var $v=_r(),Jc=function(t){return t.subRecord},gr=function(t){return t.sub};var zu={subRecord:function(t){return function(e){return function(n){return{}}}},SemiringRecord0:function(){return mr}},ma=function(t){var e=ue(t),n=Rn(t)();return function(){return function(r){var u=Jc(r),a=n(r.SemiringRecord0());return function(o){var l=gr(o),i=a(o.Semiring0());return{subRecord:function(f){return function(c){return function(p){var m=u(B.value)(c)(p),h=e(B.value),w=me(h),C=we(h);return w(l(C(c))(C(p)))(m)}}},SemiringRecord0:function(){return i}}}}}},Ju=function(){return function(t){var e=$v(t.SemiringRecord0());return{sub:Jc(t)(B.value),Semiring0:function(){return e}}}};var _a={sub:Wc,Semiring0:function(){return ke}},Gc={sub:Ac,Semiring0:function(){return va}};var ro=function(){return{compare:xc(k.value)(rt.value)(U.value),Eq0:function(){return Pc}}}(),ge=function(){return{compare:Mc(k.value)(rt.value)(U.value),Eq0:function(){return da}}}(),ga=function(){return{compare:Lc(k.value)(rt.value)(U.value),Eq0:function(){return pa}}}();var z=function(t){return t.compare};var un=function(t){return t.top};var oo={top:Cc,bottom:Ec,Ord0:function(){return ga}};var yn=function(t){return t.bottom};var Xc=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"},Yc=function(t){var e=t.charCodeAt(0);if(e<32||e===127){switch(t){case"\x07":return"'\\a'";case"\b":return"'\\b'";case"\f":return"'\\f'";case`
`:return"'\\n'";case"\r":return"'\\r'";case"	":return"'\\t'";case"\v":return"'\\v'"}return"'\\"+e.toString(10)+"'"}return t==="'"||t==="\\"?"'\\"+t+"'":"'"+t+"'"};var Qc=function(t){return function(e){for(var n=[],r=0,u=e.length;r<u;r++)n[r]=t(e[r]);return"["+n.join(",")+"]"}};var ha={show:Xc};var Ra={show:Yc};var x=function(t){return t.show},Vu=function(t){return{show:Qc(x(t))}};var Xv=G(Q),d=function(){function t(){}return t.value=new t,t}(),s=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}();var Te=function(t){return function(e){return function(n){if(n instanceof d)return t;if(n instanceof s)return e(n.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[t.constructor.name,e.constructor.name,n.constructor.name])}}},Dn=Te(!0)(tt(!1));var pt={map:function(t){return function(e){return e instanceof s?new s(t(e.value0)):d.value}}};var te=function(t){return Te(t)(Xv)},Je=function(){return function(t){if(t instanceof s)return t.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[t.constructor.name])}};var Tt=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),yt=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}();var Bn=function(t){return t.defer};var tf=function(t){return function(e){return t&&e}},ef=function(t){return function(e){return t||e}},nf=function(t){return!t};var Fa=function(t){return t.not};var uo=function(t){return t.ff};var yr=function(t){return t.disj},Ce={ff:!1,tt:!0,implies:function(t){return function(e){return yr(Ce)(Fa(Ce)(t))(e)}},conj:tf,disj:ef,not:nf};var rf=function(t){return Math.min(Math.abs(t),2147483647)},of=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},af=function(t){return function(e){if(e===0)return 0;var n=Math.abs(e);return(t%n+n)%n}};var uf={Ring0:function(){return Gc}};var lo=function(t){return t.mod};var wa={degree:rf,div:of,mod:af,CommutativeRing0:function(){return uf}};var Dt=function(t){return t.mempty};var L=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var cn=function(t){return t.value1};var fn=function(t){return t.value0};var Ea=function(t){return t};var s1=function(t){var e=yr(t);return{append:function(n){return function(r){return e(n)(r)}}}};var el=function(t){var e=s1(t);return{mempty:uo(t),Semigroup0:function(){return e}}};var _=function(t){return t};var nl=function(){return _};var df=nl();var kn=function(){return df};var rl=function(){return function(){return function(){return function(){return function(t){return df}}}}};var _1=G(Q),g1=Y(vr);var h1=rl()()()(),jt=function(t){return t.foldr};var Jn=function(t){var e=ve(t.Apply0()),n=R(t);return function(r){var u=jt(r);return function(a){return u(function(o){return e(a(o))})(n(void 0))}}},so=function(t){var e=Jn(t);return function(n){return et(e(n))}};var Ft=function(t){return t.foldl};var vf=function(t){var e=Ft(t);return function(n){var r=function(u){return function(a){if(u instanceof d)return new s(a);if(u instanceof s)return new s(function(){var o=g1(n(u.value0)(a))(U.value);return o?u.value0:a}());throw new Error("Failed pattern match at Data.Foldable (line 441, column 3 - line 441, column 27): "+[u.constructor.name,a.constructor.name])}};return e(r)(d.value)}},po=function(t){var e=z(t);return function(n){return vf(n)(e)}};var al=function(t){var e=Ft(t);return function(n){return e(_e(n))(be(n))}};var mf=function(t){var e=jt(t);return function(n){var r=q(n.Semigroup0()),u=Dt(n);return function(a){return e(function(o){return function(l){return r(a(o))(l)}})(u)}}},vt={foldr:Fc,foldl:wc,foldMap:function(t){return mf(vt)(t)}};var Ge=function(t){return t.foldMap};var Gn=function(t){var e=Ge(t);return function(n){return h1(Ea)(e(el(n)))}};var Vn=function(t){var e=Gn(t);return function(n){return e(n)(_1)}};var La=function(t){return t.toUpperCase()};var jn=function(t){return function(e){return e.join(t)}};var Tr=function(t){return t===""};var _f=function(){function t(u){return[u]}function e(u){return function(a){return[u,a]}}function n(u){return function(a){return function(o){return[u,a,o]}}}function r(u){return function(a){return u.concat(a)}}return function(u){return function(a){return function(o){return function(l){return function(i){function f(c,p){switch(p-c){case 0:return o([]);case 1:return a(t)(l(i[c]));case 2:return u(a(e)(l(i[c])))(l(i[c+1]));case 3:return u(u(a(n)(l(i[c])))(l(i[c+1])))(l(i[c+2]));default:var m=c+Math.floor((p-c)/4)*2;return u(a(r)(f(c,m)))(f(m,p))}}return f(0,i.length)}}}}}}();var Cr=function(t){return t};var il={map:function(t){return function(e){return t(e)}}};var Rf={apply:function(t){return function(e){return t(e)}},Functor0:function(){return il}},F1={bind:function(t){return function(e){return e(t)}},Apply0:function(){return Rf}},w1={pure:Cr,Apply0:function(){return Rf}},yf={Applicative0:function(){return w1},Bind1:function(){return F1}};var rm=G(Q),$t=function(t){return t.traverse};var om=function(t){var e=$t(t);return function(n){return e(n)(rm)}},ee={traverse:function(t){var e=t.Apply0();return _f(dt(e))(v(e.Functor0()))(R(t))},sequence:function(t){return om(ee)(t)},Functor0:function(){return Wt},Foldable1:function(){return vt}};var xf=function(t){return function(e){var n=$t(e)(t);return function(r){return function(u){return n(u)(r)}}}};var Lf=function(t){return function(){return t}},If=function(t){return function(e){return function(){return e(t())()}}};var Sf=function(t){var e=E(t.Bind1()),n=R(t.Applicative0());return function(r){return function(u){return e(u)(function(a){return n(r(a))})}}},Yn=function(t){var e=E(t.Bind1()),n=R(t.Applicative0());return function(r){return function(u){return e(r)(function(a){return e(u)(function(o){return n(a(o))})})}}};var Pf=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}},wt={Applicative0:function(){return Ct},Bind1:function(){return bn}},bn={bind:If,Apply0:function(){return vl(0)}},Ct={pure:Lf,Apply0:function(){return vl(0)}},Af=Pf("functorEffect","Effect",function(){return{map:to(Ct)}}),vl=Pf("applyEffect","Effect",function(){return{apply:Yn(wt),Functor0:function(){return Af(0)}}}),A=Af(20),Pa=vl(23);var Yt={liftEffect:G(Q),Monad0:function(){return wt}},qt=function(t){return t.liftEffect};function Wf(t){return function(e){return function(n){return function(){var r=new Image;r.src=t,r.addEventListener("load",function(){n(r)()},!1),r.addEventListener("error",function(){e()},!1)}}}}function Uf(t,e,n){return function(){var r=document.getElementById(t);return r&&r instanceof HTMLCanvasElement?e(r):n}}function Qn(t){return function(){return t.getContext("2d")}}function _o(t){return function(){return t.width}}function go(t){return function(){return t.height}}function ml(t){return function(e){return function(){t.width=e}}}function _l(t){return function(e){return function(){t.height=e}}}function Aa(t){return function(){return t.toDataURL()}}function Le(t){return function(e){return function(){t.fillStyle=e}}}function gl(t){return function(e){return function(){t.shadowColor=e}}}function hl(t){return function(e){return function(){t.shadowBlur=e}}}function Rl(t){return function(e){return function(){t.shadowOffsetX=e}}}function yl(t){return function(e){return function(){t.shadowOffsetY=e}}}function Hf(t){return function(e){return function(){t.globalCompositeOperation=e}}}function ho(t){return function(){t.beginPath()}}function Ro(t){return function(){t.fill()}}function yo(t){return function(e){return function(n){return function(){t.lineTo(e,n)}}}}function Dl(t){return function(e){return function(n){return function(){t.moveTo(e,n)}}}}function Fl(t){return function(){t.closePath()}}function wl(t){return function(e){return function(){t.rect(e.x,e.y,e.width,e.height)}}}function bl(t){return function(e){return function(){t.clearRect(e.x,e.y,e.width,e.height)}}}function Tl(t){return function(e){return function(){t.translate(e.translateX,e.translateY)}}}function $f(t){return function(e){return function(){t.textAlign=e}}}function qf(t){return function(e){return function(){t.textBaseline=e}}}function Er(t){return function(e){return function(){t.font=e}}}function Do(t){return function(e){return function(n){return function(r){return function(){t.fillText(e,n,r)}}}}}function Cl(t){return function(){t.save()}}function El(t){return function(){t.restore()}}function Ml(t){return function(e){return function(n){return function(r){return function(u){return function(a){return function(){t.drawImage(e,n,r,u,a)}}}}}}}function xl(t){return function(e){return function(n){return function(r){return function(u){return function(a){return function(o){return function(l){return function(i){return function(f){return function(){t.drawImage(e,n,r,u,a,o,l,i,f)}}}}}}}}}}}var vm=ve(Pa),Ee=function(){function t(){}return t.value=new t,t}(),mm=function(){function t(){}return t.value=new t,t}(),_m=function(){function t(){}return t.value=new t,t}(),gm=function(){function t(){}return t.value=new t,t}(),hm=function(){function t(){}return t.value=new t,t}(),Ie=function(){function t(){}return t.value=new t,t}(),ie=function(){function t(){}return t.value=new t,t}(),Tn=function(){function t(){}return t.value=new t,t}(),Mr=function(){function t(){}return t.value=new t,t}(),xr=function(){function t(){}return t.value=new t,t}(),Lr=function(){function t(){}return t.value=new t,t}();var Ne=function(){function t(){}return t.value=new t,t}(),Rm=function(){function t(){}return t.value=new t,t}(),ym=function(){function t(){}return t.value=new t,t}(),Dm=function(){function t(){}return t.value=new t,t}(),Fm=function(){function t(){}return t.value=new t,t}(),wm=function(){function t(){}return t.value=new t,t}(),bm=function(){function t(){}return t.value=new t,t}(),Tm=function(){function t(){}return t.value=new t,t}(),Cm=function(){function t(){}return t.value=new t,t}(),Em=function(){function t(){}return t.value=new t,t}(),Mm=function(){function t(){}return t.value=new t,t}(),xm=function(){function t(){}return t.value=new t,t}(),Lm=function(){function t(){}return t.value=new t,t}(),Im=function(){function t(){}return t.value=new t,t}(),Nm=function(){function t(){}return t.value=new t,t}(),Sm=function(){function t(){}return t.value=new t,t}(),Pm=function(){function t(){}return t.value=new t,t}(),Am=function(){function t(){}return t.value=new t,t}(),Wm=function(){function t(){}return t.value=new t,t}(),Um=function(){function t(){}return t.value=new t,t}(),Hm=function(){function t(){}return t.value=new t,t}(),$m=function(){function t(){}return t.value=new t,t}(),qm=function(){function t(){}return t.value=new t,t}(),Om=function(){function t(){}return t.value=new t,t}(),Bm=function(){function t(){}return t.value=new t,t}(),km=function(){function t(){}return t.value=new t,t}(),bt=function(t){return function(e){return function(){Cl(t)();var r=e();return El(t)(),r}}},Il=function(t){return function(e){return Wf(t)(e(d.value))(function(n){return e(s.create(n))})}};var Ir=function(t){return function(e){var n=function(r){if(r instanceof Ee)return"top";if(r instanceof mm)return"hanging";if(r instanceof _m)return"middle";if(r instanceof gm)return"alphabetic";if(r instanceof hm)return"ideographic";if(r instanceof Ie)return"bottom";throw new Error("Failed pattern match at Graphics.Canvas (line 577, column 5 - line 577, column 33): "+[r.constructor.name])};return qf(t)(n(e))}},Nr=function(t){return function(e){var n=function(r){if(r instanceof ie)return"left";if(r instanceof Tn)return"right";if(r instanceof Mr)return"center";if(r instanceof xr)return"start";if(r instanceof Lr)return"end";throw new Error("Failed pattern match at Graphics.Canvas (line 531, column 5 - line 531, column 32): "+[r.constructor.name])};return $f(t)(n(e))}};var zf=function(t){return function(e){var n=function(r){if(r instanceof Ne)return"source-over";if(r instanceof Rm)return"source-in";if(r instanceof ym)return"source-out";if(r instanceof Dm)return"source-atop";if(r instanceof Fm)return"destination-over";if(r instanceof wm)return"destination-in";if(r instanceof bm)return"destination-out";if(r instanceof Tm)return"destination-atop";if(r instanceof Cm)return"lighter";if(r instanceof Em)return"copy";if(r instanceof Mm)return"xor";if(r instanceof xm)return"multiply";if(r instanceof Lm)return"screen";if(r instanceof Im)return"overlay";if(r instanceof Nm)return"darken";if(r instanceof Sm)return"lighten";if(r instanceof Pm)return"color-dodge";if(r instanceof Am)return"color-burn";if(r instanceof Wm)return"hard-light";if(r instanceof Um)return"soft-light";if(r instanceof Hm)return"difference";if(r instanceof $m)return"exclusion";if(r instanceof qm)return"hue";if(r instanceof Om)return"saturation";if(r instanceof Bm)return"color";if(r instanceof km)return"luminosity";throw new Error("Failed pattern match at Graphics.Canvas (line 326, column 5 - line 326, column 45): "+[r.constructor.name])};return Hf(t)(n(e))}},Nl=function(t){return function(e){return vm(_l(t)(e.height))(ml(t)(e.width))}},Sl=function(t){return Uf(t,s.create,d.value)},Jf=function(t){return function(){var n=_o(t)(),r=go(t)();return{width:n,height:r}}},Gf=function(t){return function(e){return function(){ho(t)();var r=e();return Ro(t)(),r}}};var Wa=isFinite;function Vf(t,e,n,r){var u=parseFloat(t);return e(u)?n(u):r}var Sr=Math.round;var Ua=Math.tan;var jf=3.141592653589793;var Ha=function(t){return Vf(t,Wa,s.create,d.value)};var $a=function(t){return function(e){return e(function(n){return t(n)})}},Ve=function(t){return function(e){return{x:e.x+t.translateX,y:e.y+t.translateY}}};var mt=function(t){return t.translate},Xf=function(t){return function(e){return{width:e.width*t.scaleX,height:e.height*t.scaleY}}},qa=function(t){return t.scale},Yf=function(t){var e=qa(t);return function(n){return e({scaleX:n,scaleY:n})}},_t=function(t){return t.position},Nt=function(t){return function(e){return function(n){return n(t)(e)}}},Ym=function(t){var e=v(t);return function(n){return $a(function(r){var u=e(Nt(r)),a=n(r);return function(o){return u(a(o))}})}};var Pe=function(t){return t.mapLayerWrapper},gt=function(t){return t.draw},Qf=function(t){var e=mt(t);return function(n){return function(r){return function(u){var a={translateX:r.translateX-n.offsetX,translateY:r.translateY-n.offsetY};return e(a)(u)}}}},ne=function(t){var e=R(t);return function(n){var r=Qf(n);return function(u){return function(a){return function(o){if(u instanceof d)return e(o);if(u instanceof s)return r(u.value0)(a)(o);throw new Error("Failed pattern match at Template.Layer (line 61, column 1 - line 61, column 115): "+[u.constructor.name,a.constructor.name,o.constructor.name])}}}}},Et=function(t){return t.dragStart},Mt=function(t){return t.dragEnd},Jt=function(t){return t.drag},St=function(t){return t.containsPoint},Cn=function(t){var e=Ym(t);return{position:$a(function(n){return _t(n)}),translate:function(n){return e(function(r){return mt(r)(n)})},containsPoint:function(n){return $a(function(r){return St(r)(n)})},draw:function(n){return $a(function(r){return gt(r)(n)})},dragStart:function(n){return e(function(r){return Et(r)(n)})},drag:function(n){return e(function(r){return Jt(r)(n)})},dragEnd:e(function(n){return Mt(n)})}};var Zf=function(t){return function(e){return function(n){return function(r){return{position:t,dimensions:e,angle:n,fillStyle:r,dragOffset:d.value}}}}},Kf=function(t){return t*jf/180},Pl=function(t){var e=t.Applicative0(),n=R(e),r=ne(e);return{position:function(u){return n(u.position)},translate:function(u){return function(a){return n({dimensions:a.dimensions,angle:a.angle,fillStyle:a.fillStyle,dragOffset:a.dragOffset,position:Ve(u)(a.position)})}},containsPoint:function(u){return function(a){var o=(a.dimensions.height-u.y)/Ua(Kf(a.angle));return n(a.position.x+o<=u.x&&u.x<=a.position.x+a.dimensions.width&&a.position.y<=u.y&&u.y<=a.position.y+a.dimensions.height)}},draw:function(u){return function(a){return bt(u)(function(){return Le(u)(a.fillStyle)(),ho(u)(),Dl(u)(a.position.x)(a.position.y+a.dimensions.height)(),yo(u)(a.position.x+a.dimensions.width)(a.position.y+a.dimensions.height)(),yo(u)(a.position.x+a.dimensions.width)(a.position.y)(),yo(u)(a.position.x+a.dimensions.height/Ua(Kf(a.angle)))(a.position.y)(),Fl(u)(),Ro(u)()})}},dragStart:function(u){return function(a){return n({position:a.position,dimensions:a.dimensions,angle:a.angle,fillStyle:a.fillStyle,dragOffset:new s(u)})}},drag:function(u){return function(a){return r(Pl(t))(a.dragOffset)(u)(a)}},dragEnd:function(u){return n({position:u.position,dimensions:u.dimensions,angle:u.angle,fillStyle:u.fillStyle,dragOffset:d.value})}}};var ts=function(t,e){for(var n=t>e?-1:1,r=new Array(n*(e-t)+1),u=t,a=0;u!==e;)r[a++]=u,u+=n;return r[a]=u,r},Km=function(t,e){if(t<1)return[];var n=new Array(t);return n.fill(e)},Zm=function(t,e){for(var n=[],r=0,u=0;u<t;u++)n[r++]=e;return n},t_=typeof Array.prototype.fill=="function"?Km:Zm,es=function(){function t(u,a){this.head=u,this.tail=a}var e={};function n(u){return function(a){return new t(u,a)}}function r(u){for(var a=[],o=0,l=u;l!==e;)a[o++]=l.head,l=l.tail;return a}return function(u,a){return r(u(n)(e)(a))}}(),Pt=function(t){return t.length};var ns=function(t,e,n,r){return r<0||r>=n.length?e:t(n[r])};var rs=function(t,e,n,r){for(var u=0,a=r.length;u<a;u++)if(n(r[u]))return t(u);return e};var os=function(t,e,n,r,u){if(n<0||n>=u.length)return e;var a=u.slice();return a[n]=r,t(a)},En=function(t){return t.slice().reverse()},Mn=function(t){if(t.length<=1e4)return Array.prototype.concat.apply([],t);for(var e=[],n=0,r=t.length;n<r;n++)for(var u=t[n],a=0,o=u.length;a<o;a++)e.push(u[a]);return e};var as=function(t,e,n){for(var r=n.length,u=e,a=new Array(r),o=0;o<r;o++)u=t(u)(n[o]),a[o]=u;return a};var us=function(t,e,n){return n.slice(t,e)},ls=function(t,e,n){for(var r=e.length<n.length?e.length:n.length,u=new Array(r),a=0;a<r;a++)u[a]=t(e[a])(n[a]);return u},is=function(t,e){for(var n=e.length,r=0;r<n;r++)if(t(e[r]))return!0;return!1},cs=function(t,e){for(var n=e.length,r=0;r<n;r++)if(!t(e[r]))return!1;return!0};var fs=function(t){return function(){return{value:t}}};var fe=function(t){return function(){return t.value}},ss=function(t){return function(e){return function(){var n=t(e.value);return e.value=n.state,n.value}}},Ar=function(t){return function(e){return function(){e.value=t}}};var r_=At(A),xn=fs,o_=ss,Al=function(t){return o_(function(e){var n=t(e);return{state:n,value:n}})},Wl=function(t){return function(e){return r_(Al(t)(e))}};var se=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),de=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),dn=function(t){return t.tailRecM};var l_=function(t){var e=function(n){var r=!1,u;function a(o){if(o instanceof se){n=t(o.value0);return}if(o instanceof de)return r=!0,o.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 103, column 3 - line 103, column 25): "+[o.constructor.name])}for(;!r;)u=a(n);return u};return function(n){return e(t(n))}};var ds={tailRecM:function(t){var e=function(r){return r},n=l_(function(r){return e(t(r))});return function(r){return Cr(n(r))}},Monad0:function(){return yf}};function d_(t){return t}var _s=d_;function p_(t){return t.slice()}var gs=p_;var hs=function(t,e){return e.push(t)};var Ba=function(e){return function(n){return function(){return e(n)}}},Ul=function(e){return function(n){return function(r){return function(){return e(n,r)}}}};var Rs=Ba(_s);var y_=Ba(gs),ys=function(t){return function(e){return function(){var r=y_(e)();return t(r)(),Rs(r)()}}};var Hl=Ul(hs);var wo=function(t){return function(e,n,r,u,a){return t(e)(n)(r)(u)(a)}};var Ln=function(t){return function(e){return function(n){return t(e,n)}}},bo=function(t){return function(e){return function(n){return function(r){return t(e,n,r)}}}},ka=function(t){return function(e){return function(n){return function(r){return function(u){return t(e,n,r,u)}}}}},$l=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){return t(e,n,r,u,a)}}}}}};var ws=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){for(var o=[],l=a;;){var i=u(l);if(t(i))return o;var f=e(i);o.push(n(f)),l=r(f)}}}}}}};var bs=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){for(var o=[],l=a;;){var i=u(l);o.push(n(i));var f=r(i);if(t(f))return o;l=e(f)}}}}}}};var S_=Je();var ql={unfoldr1:bs(Dn)(S_)(fn)(cn)};var W_=Je(),pn=function(t){return t.unfoldr};var Bl={unfoldr:ws(Dn)(W_)(fn)(cn),Unfoldable10:function(){return ql}};var U_=q(Be);var xs=bo(ls);var Xe=function(){return xs(L.create)}();var Ls=function(){return $l(os)(s.create)(d.value)}();var Ot=function(t){return function(e){return ys(Hl(e))(t)()}},kl=bo(us),Eo=function(t){return function(e){return t<=0?{before:[],after:e}:{before:kl(0)(t)(e),after:kl(t)(Pt(e))(e)}}};var Jl=function(t){return[t]};var Ur=bo(as);var Gl=Ln(ts);var Ye=function(){return ka(ns)(s.create)(d.value)}();var Vl=function(t){return function(e){return function(n){var r=function(u){return Ls(t)(e(u))(n)};return Te(d.value)(r)(Ye(n)(t))}}};var jl=function(t){return Ln(es)(jt(t))};var Mo=function(){return ka(rs)(s.create)(d.value)}();var Xl=function(t){var e=Y(t);return function(n){return Mo(function(r){return e(r)(n)})}},Yl=function(t){var e=Xl(t);return function(n){return function(r){return Dn(e(n)(r))}}};var Zn=function(t){return function(e){return U_([t])(e)}};var Is=et(E(sa));var xo=Ln(is);var Va=Ln(cs);var H_=Vn(vt)(Ce),$_=$t(ee),q_=gr(Ju()(ma({reflectSymbol:function(){return"x"}})()(ma({reflectSymbol:function(){return"y"}})()(zu)(_a))(_a))),O_=Jn(Ct)(vt);var Ql=function(t){var e=t.Applicative0(),n=R(e),r=t.Bind1().Apply0().Functor0(),u=v(r),a=$_(e),o=Cn(r),l=St(o),i=gt(o),f=ne(e);return{position:function(c){return n(c.position)},translate:function(c){return function(p){return n({layers:p.layers,dragOffset:p.dragOffset,position:Ve(c)(p.position)})}},containsPoint:function(c){return function(p){return u(H_)(a(l(q_(c)(p.position)))(p.layers))}},draw:function(c){return function(p){return bt(c)(function(){return Tl(c)({translateX:p.position.x,translateY:p.position.y})(),O_(function(){var h=bt(c),w=i(c);return function(C){return h(w(C))}}())(En(p.layers))()})}},dragStart:function(c){return function(p){return n({layers:p.layers,position:p.position,dragOffset:new s(c)})}},drag:function(c){return function(p){return f(Ql(t))(p.dragOffset)(c)(p)}},dragEnd:function(c){return n({layers:c.layers,position:c.position,dragOffset:d.value})}}},Kl=function(t){return{layers:t,position:{x:0,y:0},dragOffset:d.value}};var Lo=t=>t.width,Io=t=>t.height;var tr=t=>e=>()=>t.letterSpacing=e;var Ns=function(t){return function(e){return function(n){return function(r){return Ml(t)(e)(n.x)(n.y)(r.width)(r.height)}}}};var Zl=function(t){return{width:Lo(t),height:Io(t)}};var z_=le(_r()(Rn({reflectSymbol:function(){return"scaleX"}})()(Rn({reflectSymbol:function(){return"scaleY"}})()(mr)(ke))(ke))),J_=$e(qe),G_=v(pt);var Ss=function(t){var e=R(t.Monad0().Applicative0());return{scale:function(n){return function(r){return e({image:r.image,position:r.position,composite:r.composite,dragOffset:r.dragOffset,scale:z_(n)(r.scale)})}}}},ja=function(t){var e=t.Monad0(),n=e.Applicative0(),r=R(n),u=E(e.Bind1()),a=qt(t),o=ne(n);return{position:function(l){return r(l.position)},translate:function(l){return function(i){return r({image:i.image,scale:i.scale,composite:i.composite,dragOffset:i.dragOffset,position:Ve(l)(i.position)})}},containsPoint:function(l){return function(i){return u(a(fe(i.image)))(function(f){if(f instanceof d)return r(!1);if(f instanceof s)return r(i.position.x<=l.x&&l.x<=i.position.x+Lo(f.value0)*i.scale.scaleX&&i.position.y<=l.y&&l.y<=i.position.y+Io(f.value0)*i.scale.scaleY);throw new Error("Failed pattern match at Template.Layer.Image (line 74, column 5 - line 80, column 90): "+[f.constructor.name])})}},dragStart:function(l){return function(i){return r({image:i.image,position:i.position,scale:i.scale,composite:i.composite,dragOffset:new s(l)})}},drag:function(l){return function(i){return o(ja(t))(i.dragOffset)(l)(i)}},dragEnd:function(l){return r({image:l.image,position:l.position,scale:l.scale,composite:l.composite,dragOffset:d.value})},draw:function(l){return function(i){return function(){var c=fe(i.image)();if(c instanceof d)return void 0;if(c instanceof s)return bt(l)(function(){return zf(l)(i.composite)(),Ns(l)(c.value0)(i.position)(Xf(i.scale)(Zl(c.value0)))()})();throw new Error("Failed pattern match at Template.Layer.Image (line 88, column 5 - line 94, column 54): "+[c.constructor.name])}}}}},Ps=function(t){return function(e){return{image:e.image,position:e.position,composite:e.composite,dragOffset:e.dragOffset,scale:t}}},ei=function(t){var e=qt(t);return function(n){return function(r){return function(u){return function(a){return e(function(){var l=xn(d.value)();return Il(n)(function(){var i=et(Wl)(l);return function(f){return i(tt(f))}}())(),{image:l,position:r,scale:u,composite:a,dragOffset:d.value}})}}}}},As=function(t){var e=qt(t);return function(n){return function(r){return function(u){return e(function(){var o=xn(d.value)();return{image:o,position:n,scale:r,composite:u,dragOffset:d.value}})}}}},Ws=function(t){var e=t.Monad0(),n=J_(e.Bind1()),r=qt(t),u=R(e.Applicative0());return function(a){return function(o){return n(r(Il(a)(function(){var l=et(Wl)(o.image);return function(i){return l(tt(i))}}())))(function(){return u(o)})}}},Us=function(t){return t.scale},Hs=function(t){var e=t.Monad0(),n=E(e.Bind1()),r=qt(t),u=R(e.Applicative0());return function(a){return n(r(fe(a.image)))(function(o){return u(G_(Zl)(o))})}};var er=function(t){return t.throwError};var Ae=function(t){return t.lift};var tg=v(pt);var Ya=function(t){return t},In=function(t){return t};var $r={lift:function(t){var e=Sf(t)(s.create);return function(n){return Ya(e(n))}}};var eg=function(t){var e=v(t);return{map:function(n){return function(r){return e(tg(n))(r)}}}},ng=function(t){return{Applicative0:function(){return So(t)},Bind1:function(){return nr(t)}}},nr=function(t){var e=E(t.Bind1()),n=R(t.Applicative0());return{bind:function(r){return function(u){return e(r)(function(a){if(a instanceof d)return n(d.value);if(a instanceof s){var o=u(a.value0);return o}throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 55, column 11 - line 57, column 42): "+[a.constructor.name])})}},Apply0:function(){return Js(t)}}},Js=function(t){var e=eg(t.Bind1().Apply0().Functor0());return{apply:Yn(ng(t)),Functor0:function(){return e}}},So=function(t){return{pure:function(){var e=R(t.Applicative0());return function(n){return Ya(e(s.create(n)))}}(),Apply0:function(){return Js(t)}}};var qr=function(t){var e=R(t.Applicative0());return function(n){return Ya(e(n))}};var rg=Ae($r);var Gs=function(t){var e=E(nr(t)),n=qr(t),r=rg(t);return function(u){return function(a){return function(o){return e(n(Ye(o)(u)))(function(l){return e(r(a(l)))(function(i){return n(Vl(u)(tt(i))(o))})})}}}};var ui=function(t){return Xe(Gl(0)(Pt(t)))(t)};var og=$t(ee),ag=Vn(vt)(Ce),ug=Jn(Ct)(vt),lg=Ae($r),ig=G(Q);var js=function(t){var e=t.Applicative0(),n=t.Bind1().Apply0().Functor0(),r=ae(n),u=og(e),a=Cn(n),o=mt(a),l=v(n),i=St(a),f=gt(a),c=E(nr(t)),p=lg(t),m=qr(t),h=_t(a),w=Gs(t),C=Et(a),W=R(So(t)),J=Jt(a),st=Mt(a);return{position:tt(R(e)({x:0,y:0})),translate:function($){return function(Z){return r(u(o($))(Z.layers))(function(Rt){return{dragIndex:Z.dragIndex,layers:Rt}})}},containsPoint:function($){return function(Z){return l(ag)(u(i($))(Z.layers))}},draw:function($){return function(Z){return ug(function(){var Rt=bt($),ct=f($);return function(on){return Rt(ct(on))}}())(En(Z.layers))}},dragStart:function($){return function(Z){return l(te(Z))(In(c(p(u(i({x:$.offsetX,y:$.offsetY}))(Z.layers)))(function(Rt){return c(m(Mo(ig)(Rt)))(function(ct){return c(m(Ye(Z.layers)(ct)))(function(on){return c(p(h(on)))(function(On){return c(w(ct)(C({offsetX:$.offsetX-On.x,offsetY:$.offsetY-On.y}))(Z.layers))(function(pr){return W({dragIndex:new s(ct),layers:pr})})})})})})))}},drag:function($){return function(Z){return l(te(Z))(In(c(m(Z.dragIndex))(function(Rt){return c(m(Ye(Z.layers)(Rt)))(function(ct){return c(p(h(ct)))(function(on){return c(w(Rt)(J({translateX:$.translateX-on.x,translateY:$.translateY-on.y}))(Z.layers))(function(On){return W({dragIndex:Z.dragIndex,layers:On})})})})})))}},dragEnd:function($){return l(te({layers:$.layers,dragIndex:d.value}))(In(c(m($.dragIndex))(function(Z){return c(w(Z)(st)($.layers))(function(Rt){return W({dragIndex:d.value,layers:Rt})})})))}}},Po=function(t){return{layers:t,dragIndex:d.value}};var Xs=function(t){return t},fg={mapLayerWrapper:function(t){return function(e){var n=v(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(Xs)(r(u))}}}}},sg=Pe(fg);var Ys=function(t){var e=R(t.Applicative0());return function(n){var r=_t(n),u=sg(n)(t),a=gt(n);return{position:function(o){return r(o)},translate:function(){var o=mt(n);return function(l){return u(o(l))}}(),containsPoint:function(o){return function(l){return e(!1)}},dragStart:function(){var o=Et(n);return function(l){return u(o(l))}}(),drag:function(){var o=Jt(n);return function(l){return u(o(l))}}(),dragEnd:u(Mt(n)),draw:function(o){return function(l){return a(o)(l)}}}}};var Qs=Xs;var li=function(t){var e=R(t),n=ne(t);return{position:function(r){return e({x:r.rect.x,y:r.rect.y})},translate:function(r){return function(u){return e({fillStyle:u.fillStyle,dragOffset:u.dragOffset,rect:{width:u.rect.width,height:u.rect.height,x:u.rect.x+r.translateX,y:u.rect.y+r.translateY}})}},containsPoint:function(r){return function(u){return e(u.rect.x<=r.x&&r.x<=u.rect.x+u.rect.width&&u.rect.y<=r.y&&r.y<=u.rect.y+u.rect.height)}},draw:function(r){return function(u){return function(){return Le(r)(u.fillStyle)(),Gf(r)(wl(r)(u.rect))()}}},dragStart:function(r){return function(u){return e({rect:u.rect,fillStyle:u.fillStyle,dragOffset:new s(r)})}},drag:function(r){return function(u){return n(li(t))(u.dragOffset)(r)(u)}},dragEnd:function(r){return e({rect:r.rect,fillStyle:r.fillStyle,dragOffset:d.value})}}},ii=function(t){return function(e){return{rect:t,fillStyle:e,dragOffset:d.value}}};var vg=$e(qe),ci=function(t){var e=t.Monad0(),n=e.Bind1(),r=E(n),u=qt(t),a=vg(n),o=R(e.Applicative0());return function(l){return function(i){return r(u(fe(i)))(function(f){return r(l(f))(function(c){return a(u(Ar(c)(i)))(function(){return o(c)})})})}}},Ks=function(t){var e=an(t.Monad0().Bind1().Apply0().Functor0()),n=ci(t);return function(r){return function(u){return e(void 0)(n(r)(u))}}};var _g=De(bn),gg=function(t){return t};var Ao=function(t){var e=t.Monad0().Bind1(),n=De(e),r=qt(t),u=an(e.Apply0().Functor0()),a=ci(t);return function(o){var l=_t(o),i=mt(o),f=St(o),c=Et(o),p=Jt(o),m=Mt(o),h=gt(o);return{position:function(w){return n(l)(r(fe(w)))},translate:function(w){return function(C){return u(C)(a(i(w))(C))}},containsPoint:function(w){return function(C){return n(f(w))(r(fe(C)))}},dragStart:function(w){return function(C){return u(C)(a(c(w))(C))}},drag:function(w){return function(C){return u(C)(a(p(w))(C))}},dragEnd:function(w){return u(w)(a(m)(w))},draw:function(w){return function(C){return _g(h(w))(fe(C))}}}}};var Zs=function(t){var e=Ks(t);return function(n){return function(r){return e(n)(r)}}};var hg=function(t){var e=qt(t);return function(n){return function(r){return e(Al(n)(r))}}},td=function(t){var e=an(t.Monad0().Bind1().Apply0().Functor0()),n=hg(t);return function(r){return function(u){return e(void 0)(n(r)(u))}}},Ka=function(t){var e=v(t.Monad0().Bind1().Apply0().Functor0()),n=qt(t);return function(r){return e(gg)(n(xn(r)))}};var Rg={mapLayerWrapper:function(t){return function(e){var n=ae(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(r(u.layer))(function(a){return{offset:u.offset,color:u.color,blur:u.blur,layer:a}})}}}}},yg=Pe(Rg),nd=function(t){var e=_t(t),n=yg(t),r=mt(t),u=St(t),a=Et(t),o=Jt(t),l=Mt(t),i=gt(t);return function(f){var c=n(f);return{position:function(p){return e(p.layer)},translate:function(p){return c(r(p))},containsPoint:function(p){return function(m){return u(p)(m.layer)}},dragStart:function(p){return c(a(p))},drag:function(p){return c(o(p))},dragEnd:c(l),draw:function(p){return function(m){return bt(p)(function(){return hl(p)(m.blur)(),Rl(p)(m.offset.offsetX)(),yl(p)(m.offset.offsetY)(),gl(p)(m.color)(),i(p)(m.layer)()})}}}}};var fi=function(t){return function(e){return{layer:e.layer,offset:e.offset,blur:e.blur,color:t}}},si=function(t){return function(e){return function(n){return function(r){return{layer:r,offset:t,color:e,blur:n}}}}};var Fg={mapLayerWrapper:function(t){return function(e){var n=ae(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(r(u.layer))(function(a){return{offsetY:u.offsetY,gridSizeY:u.gridSizeY,layer:a}})}}}}},wg=Pe(Fg),bg={mapLayerWrapper:function(t){return function(e){var n=ae(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(r(u.layer))(function(a){return{offsetX:u.offsetX,gridSizeX:u.gridSizeX,layer:a}})}}}}},Tg=Pe(bg);var di=function(t){return function(e){return function(n){return{layer:n,gridSizeY:e,offsetY:t}}}},rd=function(t){return function(e){return function(n){return{layer:n,gridSizeX:e,offsetX:t}}}};var Cg=function(t){var e=_t(t),n=Jt(t);return function(r){var u=E(r.Bind1());return function(a){return function(o){return function(l){return function(i){return u(e(i))(function(f){var c=a+o*Sr((f.y+l.translateY-a)/o);return n({translateX:l.translateX,translateY:c-f.y})(i)})}}}}}},od=function(t){var e=_t(t),n=wg(t),r=mt(t),u=St(t),a=Et(t),o=Cg(t),l=Mt(t),i=gt(t);return function(f){var c=n(f),p=o(f);return{position:function(m){return e(m.layer)},translate:function(m){return c(r(m))},containsPoint:function(m){return function(h){return u(m)(h.layer)}},dragStart:function(m){return c(a(m))},drag:function(m){return function(h){return c(p(h.offsetY)(h.gridSizeY)(m))(h)}},dragEnd:c(l),draw:function(m){return function(h){return i(m)(h.layer)}}}}},Eg=function(t){var e=_t(t),n=Jt(t);return function(r){var u=E(r.Bind1());return function(a){return function(o){return function(l){return function(i){return u(e(i))(function(f){var c=a+o*Sr((f.x+l.translateX-a)/o);return n({translateX:c-f.x,translateY:l.translateY})(i)})}}}}}},ad=function(t){var e=_t(t),n=Tg(t),r=mt(t),u=St(t),a=Et(t),o=Eg(t),l=Mt(t),i=gt(t);return function(f){var c=n(f),p=o(f);return{position:function(m){return e(m.layer)},translate:function(m){return c(r(m))},containsPoint:function(m){return function(h){return u(m)(h.layer)}},dragStart:function(m){return c(a(m))},drag:function(m){return function(h){return c(p(h.offsetX)(h.gridSizeX)(m))(h)}},dragEnd:c(l),draw:function(m){return function(h){return i(m)(h.layer)}}}}};var lt=function(t){return t};function ud(t){return t.split(/\r\n|[\n\v\f\r\u0085\u2028\u2029]/)}function ld(t){return t.split(/[\u000a-\u000d\u0085\u2028\u2029\u0009\u0020\u00a0\u1680\u2000-\u200a\u202f\u205f\u3000]+/)}var NF=typeof Array.from=="function",Sg=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",SF=typeof String.prototype.fromCodePoint=="function",Pg=typeof String.prototype.codePointAt=="function",id=function(t){return Pg?function(e){return e.codePointAt(0)}:t},cd=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){var o=a.length;if(u<0||u>=o)return n;if(Sg)for(var l=a[Symbol.iterator](),i=u;;--i){var f=l.next();if(f.done)return n;if(i===0)return e(r(f.value))}return t(u)(a)}}}}}};function Sn(t){return t.charCodeAt(0)}function fd(t){return String.fromCharCode(t)}var pd=yn(oo),vd=un(oo);var mn=function(t){return t.toEnum};var Pn=function(t){return t.fromEnum};var rr=function(t){return function(e){return function(n){return t(e(n)+1|0)}}},or=function(t){return function(e){return function(n){return t(e(n)-1|0)}}};var pi=function(t){return t>=Sn(pd)&&t<=Sn(vd)?new s(fd(t)):d.value},Og={succ:rr(pi)(Sn),pred:or(pi)(Sn),Ord0:function(){return ga}};var Uo=function(){return{cardinality:Sn(vd)-Sn(pd)|0,toEnum:pi,fromEnum:Sn,Bounded0:function(){return oo},Enum1:function(){return Og}}}();var vi=function(t){return t.join("")};var An=function(t){return t.length};var ar=function(t){return function(e){return e.substring(t)}};var Wn=function(t){return function(e){if(t>=0&&t<e.length)return e.charAt(t);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var jg=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}},Ho=Pn(Uo);var Xg=z(ge);var gd=function(t){return function(e){return(((t-55296|0)*1024|0)+(e-56320|0)|0)+65536|0}};var hd=function(t){return 56320<=t&&t<=57343},Rd=function(t){return 55296<=t&&t<=56319},Za=function(t){var e=An(t);if(e===0)return d.value;if(e===1)return new s({head:Ho(Wn(0)(t)),tail:""});var n=Ho(Wn(1)(t)),r=Ho(Wn(0)(t)),u=Rd(r)&&hd(n);return u?new s({head:gd(r)(n),tail:ar(2)(t)}):new s({head:r,tail:ar(1)(t)})};var Yg=function(t){var e=Ho(Wn(0)(t)),n=Rd(e)&&An(t)>1;if(n){var r=Ho(Wn(1)(t)),u=hd(r);return u?gd(e)(r):e}return e},_d=id(Yg);var _i={eq:function(t){return function(e){return t===e}}},gi={compare:function(t){return function(e){return Xg(t)(e)}},Eq0:function(){return _i}};var Qg=function(t){return function(e){var n=t,r=!1,u;function a(o,l){var i=Za(l);if(i instanceof s){var f=o===0;if(f)return r=!0,new s(i.value0.head);n=o-1|0,e=i.value0.tail;return}return r=!0,d.value}for(;!r;)u=a(n,e);return u}},yd=function(t){return function(e){return t<0?d.value:t===0&&e===""?d.value:t===0?new s(_d(e)):cd(Qg)(s.create)(d.value)(_d)(t)(e)}},Kg={bottom:0,top:1114111,Ord0:function(){return gi}},ur=function(){return{cardinality:1114112,fromEnum:function(t){return t},toEnum:function(t){if(t>=0&&t<=1114111)return new s(t);if(kt)return d.value;throw new Error("Failed pattern match at Data.String.CodePoints (line 63, column 1 - line 68, column 26): "+[t.constructor.name])},Bounded0:function(){return Kg},Enum1:function(){return Zg(0)}}}(),Zg=jg("enumCodePoint","Data.String.CodePoints",function(){return{succ:rr(mn(ur))(Pn(ur)),pred:or(mn(ur))(Pn(ur)),Ord0:function(){return gi}}});var eu=function(t){return ld(t)};var Br=function(t){return ud(t)};var nu=t=>e=>()=>t.measureText(e);var ru=$t(ee)(Ct),sh=Ft(vt),dh=v(Wt),Cd=v(A),ph=po(ro)(vt),wd=x(ha),vh=so(Ct)(vt);var ou=function(t){return function(e){return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,fontName:e.fontName,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:t}}};var Di=function(t){return function(e){return{text:e.text,position:e.position,maxWidth:e.maxWidth,fontName:e.fontName,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,fillStyle:t}}},$o=function(t){return function(e){return function(){var r=nu(t)(e)();return r.width}}},mh=function(t){return function(e){return function(n){var r=eu(n);return function(){var a=ru($o(t))(r)(),o=$o(t)(" ")(),l=function(c){return function(p){if(c.value1.value0.length===0)return new L(c.value0,new L([p.value0],p.value1));var m=c.value1.value1+o+p.value1>e;return m?new L(Ot(c.value0)(c.value1.value0),new L([p.value0],p.value1)):new L(c.value0,new L(Ot(c.value1.value0)(p.value0),c.value1.value1+o+p.value1))}},i=sh(l)(new L([],new L([],0)))(Xe(r)(a)),f=dh(jn(" "))(i.value0);return i.value1.value0.length===0?f:Ot(f)(jn(" ")(i.value1.value0))}}}},bd=function(t){return function(e){return function(n){return Cd(Mn)(ru(mh(t)(e))(Br(n)))}}},Fi=function(t){return function(e){return function(){var r=nu(t)(e)();return r.actualBoundingBoxAscent+r.actualBoundingBoxDescent}}};var Td=function(t){return function(e){return Cd(function(){var n=te(0);return function(r){return n(ph(r))}}())(ru(Fi(t))(e))}},au=function(t){var e=t.Monad0().Applicative0(),n=R(e),r=qt(t),u=ne(e);return{position:function(a){return n(a.position)},translate:function(a){return function(o){return n({text:o.text,maxWidth:o.maxWidth,fillStyle:o.fillStyle,fontName:o.fontName,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,letterSpacing:o.letterSpacing,dragOffset:o.dragOffset,context:o.context,position:Ve(a)(o.position)})}},containsPoint:function(a){return function(o){return r(bt(o.context)(function(){Le(o.context)(o.fillStyle)(),Er(o.context)(o.fontStyle+(" "+(o.fontWeight+(" "+(wd(o.fontSize)+("px "+o.fontName))))))(),Ir(o.context)(o.baseline)(),Nr(o.context)(o.align)(),tr(o.context)(o.letterSpacing)();var i=function(){if(o.maxWidth instanceof s)return bd(o.context)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return Br(o.text);throw new Error("Failed pattern match at Template.Layer.Text (line 75, column 14 - line 77, column 44): "+[o.maxWidth.constructor.name])}(),f=ru($o(o.context))(i)(),c=Td(o.context)(i)();return et(xo)(ui(f))(function(p){var m=function(){return o.baseline instanceof Ee?o.position.y+c*o.lineHeight*lt(p.value0):o.baseline instanceof Ie?o.position.y-c-lt((Pt(i)-p.value0|0)-1|0)*c*o.lineHeight:o.position.y+c*o.lineHeight*lt(p.value0)}();if(o.align instanceof xr||o.align instanceof ie)return o.position.x<=a.x&&a.x<=o.position.x+p.value1&&m<=a.y&&a.y<=m+c;if(o.align instanceof Lr||o.align instanceof Tn)return o.position.x-p.value1<=a.x&&a.x<=o.position.x&&m<=a.y&&a.y<=m+c;if(o.align instanceof Mr)return o.position.x-p.value1/2<=a.x&&a.x<=o.position.x+p.value1/2&&m<=a.y&&a.y<=m+c;throw new Error("Failed pattern match at Template.Layer.Text (line 89, column 7 - line 104, column 41): "+[o.align.constructor.name])})}))}},dragStart:function(a){return function(o){return n({text:o.text,position:o.position,maxWidth:o.maxWidth,fillStyle:o.fillStyle,fontName:o.fontName,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,letterSpacing:o.letterSpacing,context:o.context,dragOffset:new s(a)})}},drag:function(a){return function(o){return u(au(t))(o.dragOffset)(a)(o)}},dragEnd:function(a){return n({text:a.text,position:a.position,maxWidth:a.maxWidth,fillStyle:a.fillStyle,fontName:a.fontName,fontSize:a.fontSize,fontStyle:a.fontStyle,fontWeight:a.fontWeight,align:a.align,baseline:a.baseline,lineHeight:a.lineHeight,letterSpacing:a.letterSpacing,context:a.context,dragOffset:d.value})},draw:function(a){return function(o){return bt(a)(function(){Le(a)(o.fillStyle)(),Er(a)(o.fontStyle+(" "+(o.fontWeight+(" "+(wd(o.fontSize)+("px "+o.fontName))))))(),Ir(a)(o.baseline)(),Nr(a)(o.align)(),tr(a)(o.letterSpacing)();var i=function(){if(o.maxWidth instanceof s)return bd(a)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return Br(o.text);throw new Error("Failed pattern match at Template.Layer.Text (line 117, column 14 - line 119, column 44): "+[o.maxWidth.constructor.name])}(),f=Td(a)(i)();return vh(ui(i))(function(c){var p=function(){return o.baseline instanceof Ee?o.position.y+lt(c.value0)*f*o.lineHeight:o.baseline instanceof Ie?o.position.y-lt((Pt(i)-c.value0|0)-1|0)*f*o.lineHeight:o.position.y+lt(c.value0)*f*o.lineHeight}();return Do(a)(c.value1)(o.position.x)(p)})()})}}}};var Ed=function(t){return t};var Th=Ed;var bi=function(t){return t};var Nd=function(t){if(Pt(t)>0)return new s(Th(t));if(kt)return d.value;throw new Error("Failed pattern match at Data.Array.NonEmpty (line 161, column 1 - line 161, column 58): "+[t.constructor.name])};var zr=function(t){var e=null;return function(){return t===void 0||(e=t(),t=void 0),e}},Bo=function(t){return t()};var Sh=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}};var Ph=kn();var _n=function(){function t(e,n,r){this.value0=e,this.value1=n,this.value2=r}return t.create=function(e){return function(n){return function(r){return new t(e,n,r)}}},t}(),gn=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var Sd=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),Pd=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),Ei=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var Ad={defer:function(t){var e=zr(t);return function(n,r,u,a,o){var l=Bo(e);return l(n,r,u,a,o)}}};var lr={map:function(t){return function(e){return function(n,r,u,a,o){return r(function(l){return e(n,r,u,a,function(i,f){return r(function(c){return o(i,t(f))})})})}}}};var Un={alt:function(t){return function(e){return function(n,r,u,a,o){return r(function(l){return t(new _n(n.value0,n.value1,!1),r,u,function(i,f){return r(function(c){return i.value2?a(i,f):e(n,r,u,a,o)})},o)})}}},Functor0:function(){return lr}},Ah=function(t){return function(e,n,r,u,a){var o=t(e);return a(o.value1,o.value0)}};var Wh=function(t){var e=t.Monad0(),n=v(e.Bind1().Apply0().Functor0()),r=R(e.Applicative0()),u=dn(t);return function(a){return function(o){var l=function(i){var f=!1,c;function p(m){var h=m(void 0);if(h instanceof Sd){i=h.value0;return}if(h instanceof Pd)return f=!0,n(se.create)(h.value0);if(h instanceof Ei)return f=!0,r(new de(new L(h.value1,h.value0)));throw new Error("Failed pattern match at Parsing (line 160, column 13 - line 166, column 32): "+[h.constructor.name])}for(;!f;)c=p(i);return c};return u(l)(function(i){return o(a,Sd.create,Pd.create,function(f,c){return new Ei(f,new Tt(c))},function(f,c){return new Ei(f,new yt(c))})})}}},Wd=Ah(function(t){return new L(t.value1,t)});var Uh={index:0,line:1,column:1},Hh=function(t){var e=v(t.Monad0().Bind1().Apply0().Functor0()),n=Wh(t);return function(r){return function(u){var a=new _n(r,Uh,!1);return e(fn)(n(a)(u))}}},$h=Hh(ds),Ud=function(t){var e=$h(t);return function(n){return Ph(e(n))}};var lu=function(t){return function(e){return t.value2&&!e.value2?new _n(e.value0,e.value1,!0):e}},Hn={apply:function(t){return function(e){return function(n,r,u,a,o){return r(function(l){return t(n,r,u,a,function(i,f){return r(function(c){var p=lu(n)(i);return e(p,r,u,a,function(m,h){return r(function(w){return o(lu(p)(m),f(h))})})})})})}}},Functor0:function(){return lr}};var Jr={pure:function(t){return function(e,n,r,u,a){return a(e,t)}},Apply0:function(){return Hn}};var ir={bind:function(t){return function(e){return function(n,r,u,a,o){return r(function(l){return t(n,r,u,a,function(i,f){return r(function(c){var p=e(f);return p(lu(n)(i),r,u,a,o)})})})}}},Apply0:function(){return Hn}},qh=De(ir);var Hd={Applicative0:function(){return Jr},Bind1:function(){return ir}};var xi={throwError:function(t){return function(e,n,r,u,a){return u(e,t)}},Monad0:function(){return Hd}},Oh=er(xi),Bh=function(t){return function(e){return Oh(new gn(t,e))}},Gr=function(t){return qh(Bh(t))(Wd)};var iu={tailRecM:function(t){return function(e){return function(n,r,u,a,o){var l=Sh("loop","Parsing",function(){return function(f,c,p){var m=t(c);return m(f,r,u,a,function(h,w){var C=lu(f)(h);if(w instanceof se){var W=p===0;return W?r(function(J){return l(288)(C,w.value0,30)}):l(290)(C,w.value0,p-1|0)}if(w instanceof de)return o(C,w.value0);throw new Error("Failed pattern match at Parsing (line 284, column 19 - line 292, column 46): "+[w.constructor.name])})}}),i=l(279);return i(n,e,30)}}},Monad0:function(){return Hd}};var Qe=function(){function t(){}return t.value=new t,t}(),Ke=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var Vr={foldr:function(t){return function(e){var n=function(){var u=function(a){return function(o){var l=a,i=!1,f;function c(p,m){if(m instanceof Qe)return i=!0,p;if(m instanceof Ke){l=new Ke(m.value0,p),o=m.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[p.constructor.name,m.constructor.name])}for(;!i;)f=c(l,o);return f}};return u(Qe.value)}(),r=Ft(Vr)(et(t))(e);return function(u){return r(n(u))}}},foldl:function(t){var e=function(n){return function(r){var u=n,a=!1,o;function l(i,f){if(f instanceof Qe)return a=!0,i;if(f instanceof Ke){u=t(i)(f.value0),r=f.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[f.constructor.name])}for(;!a;)o=l(u,r);return o}};return e},foldMap:function(t){var e=q(t.Semigroup0()),n=Dt(t);return function(r){return Ft(Vr)(function(u){var a=e(u);return function(o){return a(r(o))}})(n)}}};var Jd=Lt(Un),h0=Bn(Ad);var R0=ve(Hn);var y0=Rc(Hn);var Gd=function(t){return function(e){return Jd(t)(h0(function(n){return Gr("Expected "+e(void 0))}))}},Li=function(t){return function(e){return Jd(t)(Gr("Expected "+e))}};var jr=function(t){return function(e,n,r,u,a){return t(e,n,r,function(o,l){return u(new _n(o.value0,o.value1,e.value2),l)},a)}};var Jo=function(t){return function(e){return function(n){return y0(R0(t)(n))(e)}}};var Ni=E(ir),D0=dn(iu),F0=Lt(Un),cu=R(Jr),w0=jl(Vr);var b0=function(t){return Ni(et(D0)(Qe.value)(function(e){return F0(Ni(t)(function(n){return cu(new se(new Ke(n,e)))}))(cu(new de(e)))}))(function(e){return cu(En(w0(e)))})},Si=function(t){return Ni(b0(t))(function(e){var n=Nd(e);if(n instanceof d)return Gr("Expected at least 1");if(n instanceof s)return cu(n.value0);throw new Error("Failed pattern match at Parsing.Combinators.Array (line 55, column 3 - line 57, column 25): "+[n.constructor.name])})};var Pi=Pn(ur),C0=lo(wa),E0=Je(),M0=mn(Uo);var x0=x(Ra);var Ai=function(t){return function(e){return function(n){var r=Pi(e);if(r===10)return{index:t.index+1|0,line:t.line+1|0,column:1};if(r===13){var u=yd(0)(n);return u instanceof s&&Pi(u.value0)===10?{index:t.index+1|0,line:t.line,column:t.column}:{index:t.index+1|0,line:t.line+1|0,column:1}}return r===9?{index:t.index+1|0,line:t.line,column:(t.column+8|0)-C0(t.column-1|0)(8)|0}:{index:t.index+1|0,line:t.line,column:t.column+1|0}}}},L0=function(t){return function(e){return function(n){var r=t,u=e,a=!1,o;function l(i,f,c){var p=Za(f);if(p instanceof d)return a=!0,i;if(p instanceof s){var m=function(){if(Tr(p.value0.tail))return Ai(i)(p.value0.head)(c);if(kt)return Ai(i)(p.value0.head)(p.value0.tail);throw new Error("Failed pattern match at Parsing.String (line 165, column 7 - line 167, column 52): ")}();r=m,u=p.value0.tail,n=c;return}throw new Error("Failed pattern match at Parsing.String (line 161, column 36 - line 168, column 38): "+[p.constructor.name])}for(;!a;)o=l(r,u,n);return o}}};var Wi=function(t){return wo(function(e){return function(n){return function(r){return function(u){return function(a){var o=Za(e.value0);if(o instanceof d)return u(e,new gn("Unexpected EOF",e.value1));if(o instanceof s){var l=Pi(o.value0.head),i=l<0||l>65535;if(i)return u(e,new gn("Expected Char",e.value1));var f=E0(M0(l)),c=t(f);return c?a(new _n(o.value0.tail,Ai(e.value1)(o.value0.head)(o.value0.tail),!0),f):u(e,new gn("Predicate unsatisfied",e.value1))}throw new Error("Failed pattern match at Parsing.String (line 114, column 7 - line 129, column 75): "+[o.constructor.name])}}}}})};var Ui=wo(function(t){return function(e){return function(n){return function(r){return function(u){var a=Tr(t.value0);return a?u(new _n(t.value0,t.value1,!0),void 0):r(t,new gn("Expected EOF",t.value1))}}}}}),jd=function(t){return wo(function(e){return function(n){return function(r){return function(u){return function(a){var o=t(e.value0);if(o instanceof Tt)return u(e,new gn(o.value0,e.value1));if(o instanceof yt)return a(new _n(o.value0.remainder,L0(e.value1)(o.value0.consumed)(o.value0.remainder),!Tr(o.value0.consumed)),o.value0.value);throw new Error("Failed pattern match at Parsing.String (line 286, column 7 - line 290, column 121): "+[o.constructor.name])}}}}})};var Hi=jd(function(t){return new yt({value:t,consumed:t,remainder:""})});var he=function(t){return Li(Wi(function(e){return e===t}))(x0(t))};var U0=x(Vu(Ra));var H0=Yl(pa);var Qd=function(t){return Gd(Wi(et(H0)(t)))(function(e){return"none of "+U0(t)})};function fu(t,e){var n={};for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r]);for(var u in t)({}).hasOwnProperty.call(t,u)&&(n[u]=t[u]);return n}var su=function(){return function(){return function(t){return function(e){return fu(t,e)}}}};var B0=x(ha),du=q(Be),Go=ae(Wt),op=Ft(vt),Oi=v(A),k0=po(ro)(vt),cr=$t(ee)(Ct),pu=al(vt)(ke),Ze=v(Wt),z0=R(Ct),J0=v(pt),Me=v(lr),tn=Lt(Un),_u=ve(Hn),G0=su()(),V0=xf(Ct)(ee),j0=G(Q),$i=so(Ct)(vt),ap=an(lr);var gu=function(){function t(){}return t.value=new t,t}(),up=function(){function t(){}return t.value=new t,t}(),hu=function(){function t(){}return t.value=new t,t}(),lp=function(){function t(){}return t.value=new t,t}();var ip=function(t){return t.text},X0=function(t){return function(e){return function(n){return{line:Ot(e.line)(n),width:e.width+t+n.width}}}},Bi=function(t){return function(e){return function(n){var r=function(){if(n.weight instanceof gu)return e.weight.normal;if(n.weight instanceof up)return e.weight.bold;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 300, column 14 - line 302, column 37): "+[n.weight.constructor.name])}(),u=function(){if(n.style instanceof hu)return e.style.normal;if(n.style instanceof lp)return e.style.italic;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 297, column 13 - line 299, column 39): "+[n.style.constructor.name])}();return Er(t)(u+(" "+(r+(" "+(B0(e.size)+("px "+e.name))))))}}},cp=function(t){return function(e){return{text:e.text,position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,font:{name:e.font.name,style:e.font.style,weight:e.font.weight,size:t}}}},ki=function(t){return function(e){return{text:e.text,position:e.position,maxWidth:e.maxWidth,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,fillStyle:t}}},Y0=function(t){return Tr(ip(t.fragment))},Q0=function(t){return Va(Y0)(t.word)},K0=function(t){return Va(Q0)(t.line)};var fp=function(t){return function(e){var n=function(u){return function(a){var o=Eo(1)(t(a.text));if(o.before.length===1&&o.before[0]===""&&o.after.length===0)return{splits:u.splits,split:u.split};if(o.before.length===1&&o.after.length===0)return{splits:u.splits,split:Ot(u.split)({style:a.style,weight:a.weight,text:o.before[0]})};if(o.before.length===1&&o.before[0]===""){var l=Eo(Pt(o.after)-1|0)(o.after);return l.after.length===1&&l.after[0]===""?{splits:du(Ot(u.splits)(u.split))(Go(l.before)(function(i){return[{style:a.style,weight:a.weight,text:i}]})),split:[]}:l.after.length===1?{splits:du(Ot(u.splits)(u.split))(Go(l.before)(function(i){return[{style:a.style,weight:a.weight,text:i}]})),split:[{style:a.style,weight:a.weight,text:l.after[0]}]}:{splits:u.splits,split:u.split}}if(o.before.length===1){var l=Eo(Pt(o.after)-1|0)(o.after);return l.after.length===1&&l.after[0]===""?{splits:du(Ot(u.splits)(Ot(u.split)({style:a.style,weight:a.weight,text:o.before[0]})))(Go(l.before)(function(f){return[{style:a.style,weight:a.weight,text:f}]})),split:[]}:l.after.length===1?{splits:du(Ot(u.splits)(Ot(u.split)({style:a.style,weight:a.weight,text:o.before[0]})))(Go(l.before)(function(f){return[{style:a.style,weight:a.weight,text:f}]})),split:[{style:a.style,weight:a.weight,text:l.after[0]}]}:{splits:u.splits,split:u.split}}return{splits:u.splits,split:u.split}}},r=op(n)({splits:[],split:[]})(e);return Ot(r.splits)(r.split)}},sp=fp(eu),zi=function(t){return{text:t,style:hu.value,weight:gu.value}};var Z0=function(t){return function(e){return{fragment:t,width:e}}},dp=function(t){return function(e){return function(n){return bt(t)(function(){return Bi(t)(e)(n)(),$o(t)(n.text)()})}}},Ji=function(t){return function(e){return dp(t)(e)({style:hu.value,weight:gu.value,text:" "})}},t2=function(t){return function(e){return function(n){return bt(t)(function(){return Bi(t)(e)(n)(),Fi(t)(n.text)()})}}},e2=function(t){return function(e){return function(n){return Oi(function(){var r=te(0);return function(u){return r(k0(u))}}())(cr(t2(t)(e))(n))}}},n2=function(t){return function(e){return function(n){return Oi(Z0(n))(dp(t)(e)(n))}}},pp=function(t){return function(e){return function(n){return function(){var u=cr(n2(t)(e))(n)(),a=pu(Ze(function(o){return o.width})(u));return{word:u,width:a}}}}},Zd=function(t){return function(e){return function(n){var r=sp(n);return function(){var a=cr(pp(t)(e))(r)(),o=Ji(t)(e)(),l=o*lt(Pt(a)-1|0)+pu(Ze(function(i){return i.width})(a));return{line:a,width:l}}}}},r2=function(t){return function(e){return function(n){return function(r){var u=sp(r);return function(){var o=cr(pp(t)(e))(u)(),l=Ji(t)(e)(),i=function(c){return function(p){if(c.value1.line.length===0)return new L(c.value0,{line:[p],width:p.width});var m=c.value1.width+l+p.width>n;return m?new L(Ot(c.value0)(c.value1),{line:[p],width:p.width}):new L(c.value0,X0(l)(c.value1)(p))}},f=op(i)(new L([],{line:[],width:0}))(o);return f.value1.line.length===0?f.value0:Ot(f.value0)(f.value1)}}}}},Gi=function(t){return function(e){return{text:e.text,position:e.position,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,maxWidth:J0(t)(e.maxWidth)}}},Vo=function(){var t=Me(bi);return function(e){return t(Si(e))}}(),jo=Me(function(t){return zi(vi(t))})(Vo(Qd(["_","*"]))),qi=fp(Br),tp=function(t){return function(e){return function(n){return function(r){return Oi(Mn)(cr(r2(t)(e)(n))(qi(r)))}}}},vu=function(t){return{text:t.text,weight:t.weight,style:lp.value}},ep=tn(jr(Jo(he("_"))(he("_"))(Me(vu)(jo))))(tn(jo)(_u(he("_"))(Me(function(t){return vu(zi(t))})(Hi)))),o2=function(t){return t.fragment},a2=function(t){return Ze(o2)(t.word)},u2=function(t){return Ze(a2)(t.line)},np=function(t){return function(e){return function(n){return function(r){return function(){var a=e2(t)(e)(Mn(Is(u2)(r)))();return Go(r)(function(o){return G0(o)({height:function(){var l=K0(o);return l?n*e.size:a}()})})}}}}},Ru=function(t){var e=t.Monad0().Applicative0(),n=R(e),r=qt(t),u=ne(e);return{position:function(a){return n(a.position)},translate:function(a){return function(o){return n({text:o.text,maxWidth:o.maxWidth,fillStyle:o.fillStyle,font:o.font,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,emptyLineHeight:o.emptyLineHeight,letterSpacing:o.letterSpacing,dragOffset:o.dragOffset,context:o.context,position:Ve(a)(o.position)})}},containsPoint:function(a){return function(o){return r(bt(o.context)(function(){Le(o.context)(o.fillStyle)(),Ir(o.context)(o.baseline)(),Nr(o.context)(o.align)(),tr(o.context)(o.letterSpacing)();var i=function(){if(o.maxWidth instanceof s)return tp(o.context)(o.font)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return cr(Zd(o.context)(o.font))(qi(o.text))();throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 204, column 15 - line 206, column 89): "+[o.maxWidth.constructor.name])}(),f=np(o.context)(o.font)(o.emptyLineHeight)(i)(),c=pu(Ze(function(h){return h.height})(f))+(o.lineHeight-1)*o.font.size*lt(Pt(f)-1|0),p=Zn(0)(Ur(function(h){return function(w){return h+w.height+(o.lineHeight-1)*o.font.size}})(0)(f)),m=V0(Xe(f)(p))(function(h){var w=function(){return o.baseline instanceof Ee?o.position.y+h.value1:o.baseline instanceof Ie?o.position.y+h.value1-c:o.position.y+h.value1}();return z0(function(){if(o.align instanceof xr||o.align instanceof ie)return o.position.x<=a.x&&a.x<=o.position.x+h.value0.width&&w<=a.y&&a.y<=w+h.value0.height;if(o.align instanceof Lr||o.align instanceof Tn)return o.position.x-h.value0.width<=a.x&&a.x<=o.position.x&&w<=a.y&&a.y<=w+h.value0.height;if(o.align instanceof Mr)return o.position.x-h.value0.width/2<=a.x&&a.x<=o.position.x+h.value0.width/2&&w<=a.y&&a.y<=w+h.value0.height;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 222, column 14 - line 242, column 33): "+[o.align.constructor.name])}())})();return xo(j0)(m)}))}},dragStart:function(a){return function(o){return n({text:o.text,position:o.position,maxWidth:o.maxWidth,fillStyle:o.fillStyle,font:o.font,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,emptyLineHeight:o.emptyLineHeight,letterSpacing:o.letterSpacing,context:o.context,dragOffset:new s(a)})}},drag:function(a){return function(o){return u(Ru(t))(o.dragOffset)(a)(o)}},dragEnd:function(a){return n({text:a.text,position:a.position,maxWidth:a.maxWidth,fillStyle:a.fillStyle,font:a.font,align:a.align,baseline:a.baseline,lineHeight:a.lineHeight,emptyLineHeight:a.emptyLineHeight,letterSpacing:a.letterSpacing,context:a.context,dragOffset:d.value})},draw:function(a){return function(o){return bt(a)(function(){Le(a)(o.fillStyle)(),Ir(a)(o.baseline)(),Nr(a)(ie.value)(),tr(a)(o.letterSpacing)();var i=function(){if(o.maxWidth instanceof s)return tp(a)(o.font)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return cr(Zd(a)(o.font))(qi(o.text))();throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 257, column 15 - line 259, column 83): "+[o.maxWidth.constructor.name])}(),f=np(a)(o.font)(o.emptyLineHeight)(i)(),c=pu(Ze(function(m){return m.height})(f))+(o.lineHeight-1)*o.font.size*lt(Pt(f)-1|0),p=Zn(0)(Ur(function(m){return function(h){return m+h.height+(o.lineHeight-1)*o.font.size}})(0)(f));return $i(Xe(f)(p))(function(m){var h=function(){return o.baseline instanceof Ee?o.position.y+m.value1:o.baseline instanceof Ie?o.position.y+m.value1-c+m.value0.height:o.position.y+m.value1}(),w=function(){if(o.align instanceof xr||o.align instanceof ie)return o.position.x;if(o.align instanceof Lr||o.align instanceof Tn)return o.position.x-m.value0.width;if(o.align instanceof Mr)return o.position.x-m.value0.width/2;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 278, column 16 - line 283, column 57): "+[o.align.constructor.name])}();return function(){var W=Ji(a)(o.font)(),J=Zn(0)(Ur(function(st){return function($){return st+W+$.width}})(0)(m.value0.line));return $i(Xe(m.value0.line)(J))(function(st){var $=Zn(0)(Ur(function(Z){return function(Rt){return Z+Rt.width}})(0)(st.value0.word));return $i(Xe(st.value0.word)($))(function(Z){return function(){return Bi(a)(o.font)(Z.value0.fragment)(),Do(a)(ip(Z.value0.fragment))(w+st.value1+Z.value1)(h)()}})})()}})()})}}}},mu=function(t){return{text:t.text,style:t.style,weight:up.value}},l2=tn(jr(Jo(he("*"))(he("*"))(Me(Ze(mu))(Vo(ep)))))(_u(he("*"))(tn(ap([])(Ui))(Me(Ze(mu))(Vo(ep))))),rp=tn(jr(Jo(he("*"))(he("*"))(Me(mu)(jo))))(tn(jo)(_u(he("*"))(Me(function(t){return mu(zi(t))})(Hi)))),i2=tn(jr(Jo(he("_"))(he("_"))(Me(Ze(vu))(Vo(rp)))))(_u(he("_"))(tn(ap([])(Ui))(Me(Ze(vu))(Vo(rp))))),c2=Me(function(t){return Mn(bi(t))})(Si(tn(i2)(tn(l2)(Me(Jl)(jo)))));var Xo=function(t){return function(e){var n=Ud(t)(c2);if(n instanceof yt)return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:n.value0};if(n instanceof Tt)return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:[{text:t,style:hu.value,weight:gu.value}]};throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 179, column 37 - line 181, column 106): "+[n.constructor.name])}};var mp=function(t){return t},_p=function(t){return t},gp=function(t){return t},f2={mapLayerWrapper:function(t){return function(e){var n=v(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(mp)(r(u))}}}}},s2=Pe(f2);var d2={mapLayerWrapper:function(t){return function(e){var n=v(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(_p)(r(u))}}}}},p2=Pe(d2);var v2={mapLayerWrapper:function(t){return function(e){var n=v(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(gp)(r(u))}}}}},m2=Pe(v2);var hp=function(t){return function(e){var n=_t(e),r=s2(e)(t),u=St(e),a=Et(e),o=Jt(e),l=gt(e);return{position:function(i){return n(i)},translate:function(){var i=mt(e);return function(f){return r(i(f))}}(),containsPoint:function(i){return function(f){return u(i)(f)}},dragStart:function(i){return r(a({offsetX:i.offsetX,offsetY:0}))},drag:function(i){return r(o({translateX:i.translateX,translateY:0}))},dragEnd:r(Mt(e)),draw:function(i){return function(f){return l(i)(f)}}}}},Rp=function(t){return function(e){var n=_t(e),r=p2(e)(t),u=St(e),a=Et(e),o=Jt(e),l=gt(e);return{position:function(i){return n(i)},translate:function(){var i=mt(e);return function(f){return r(i(f))}}(),containsPoint:function(i){return function(f){return u(i)(f)}},dragStart:function(i){return r(a({offsetX:0,offsetY:i.offsetY}))},drag:function(i){return r(o({translateX:0,translateY:i.translateY}))},dragEnd:r(Mt(e)),draw:function(i){return function(f){return l(i)(f)}}}}},yp=function(t){var e=R(t.Applicative0());return function(n){var r=_t(n),u=St(n),a=gt(n);return{position:function(o){return r(o)},translate:function(){var o=m2(n)(t),l=mt(n);return function(i){return o(l(i))}}(),containsPoint:function(o){return function(l){return u(o)(l)}},dragStart:tt(e),drag:tt(e),dragEnd:e,draw:function(o){return function(l){return a(o)(l)}}}}};var Dp=mp,Vi=_p,hn=gp;var fr=function(t){return function(e){return function(){return e[t]}}},g2=fr("URL"),h2=fr("documentURI"),R2=fr("origin"),y2=fr("compatMode"),D2=fr("characterSet"),F2=fr("contentType");var w2=fr("documentElement");function Yo(t){return function(e){return function(){return e.createElement(t)}}}function Fp(t,e,n){return t==null?e:n(t)}var at=function(t){return Fp(t,d.value,s.create)};function wp(t,e,n,r){if(typeof window<"u"){var u=window[n];if(u!=null&&r instanceof u)return e(r)}for(var a=r;a!=null;){var o=Object.getPrototypeOf(a),l=o.constructor.name;if(l===n)return e(r);if(l==="Object")return t;a=o}return t}var F=function(t){return function(e){return wp(d.value,s.create,t,e)}};var yu=function(t){return function(e){return e[t]}},L2=yu("namespaceURI"),I2=yu("prefix"),N2=yu("localName"),S2=yu("tagName");function sr(t){return function(e){return function(n){return function(){n.setAttribute(t,e)}}}}function ji(t){return function(){var e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}}var Du=function(t){return function(e){return function(){return e[t]}}},A2=Du("children"),W2=Du("firstElementChild"),U2=Du("lastElementChild"),H2=Du("childElementCount");var Tp=_,re=_;var Ue=function(t){return function(e){return function(){return e[t]}}};var k2=Ue("baseURI"),z2=Ue("ownerDocument"),J2=Ue("parentNode"),G2=Ue("parentElement");var V2=Ue("childNodes"),j2=Ue("firstChild"),X2=Ue("lastChild"),Y2=Ue("previousSibling"),Q2=Ue("nextSibling"),K2=Ue("nodeValue");var Z2=Ue("textContent");function Xi(t){return function(e){return function(){e.appendChild(t)}}}function Cp(t){return function(e){return function(){return e.getElementById(t)}}}var aR=v(A),en=function(t){var e=aR(at),n=Cp(t);return function(r){return e(n(r))}};function Gt(t){return function(){return function(e){return t(e)()}}}function Vt(t){return function(e){return function(n){return function(r){return function(){return r.addEventListener(t,e,n)}}}}}var Ep=_;function Mp(t){return function(e){return e.item(t)}}var vR=v(pt),mR=function(t){var e=Mp(t);return function(n){return at(e(n))}},xp=function(t){var e=pn(t);return function(n){return e(function(r){return vR(et(L.create)(r+1|0))(mR(r)(n))})(0)}};function Yi(t){return function(){return URL.createObjectURL(t)}}var Qi=function(){return window};function Lp(t){return t.body}var wR=v(A);var nn=_;var Ip=_,Fu=_;var Np=function(t){return wR(at)(function(){return Lp(t)})};function Sp(t,e,n){var r=Object.prototype.toString.call(n);return r.indexOf("[object HTML")===0&&r.indexOf("Element]")===r.length-8?e(n):t}function wu(t){return function(){return t.click()}}function Ki(t){return function(){return t.offsetWidth}}function Zi(t){return function(){return t.offsetHeight}}var Pp=_;var Ap=_;var bu=function(t){return Sp(d.value,s.create,t)};function Tu(t){return function(){return t.checked}}function Hp(t){return function(){return t.files}}function Xr(t){return function(){return t.value}}var ey=v(A);var Qo=F("HTMLInputElement");var tc=function(){var t=ey(at);return function(e){return t(Hp(e))}}();function Cu(t){return function(){return t.value}}var qp=F("HTMLSelectElement");function Eu(t){return function(){return t.value}}var Op=F("HTMLTextAreaElement");function ec(t){return function(){return t.document}}function Ko(t){return t.clientX}function Zo(t){return t.clientY}function ta(t){return t.touches}var Mu=F("TouchEvent");function Bp(t,e){return e.item(t)}var xu=function(t){return function(e){return at(Bp(t,e))}};function ea(t){return t.clientX}function na(t){return t.clientY}var Lu=F("MouseEvent");var Re=R(Ct),Iy=$e(qe),oa=Ao(Yt)(Cn(A)),Ny=gt(oa),Yr=_t(oa),kp=Et(oa),Nu=Jt(oa),zp=Mt(oa),nc=nr(wt),$n=E(nc),Iu=De(nc),ra=qr(wt),rn=Ae($r)(wt),rc=Iy(nc),Jp=De(bn),oc=R(So(wt)),Sy=Ka(Yt),Py=su()(),He=Zs(Yt),Ay=xp(Bl),Qr=function(t){return function(e){return function(n){return function(){var u=ji(Ap(e))(),a=Ki(e)(),o=Zi(e)(),l=_o(t)(),i=go(t)();return{x:(n.x-u.left)*l/a,y:(n.y-u.top)*i/o}}}}},ye=function(t){return function(){var n=Qn(t.canvas)(),r=Jf(t.canvas)();return bl(n)({x:0,y:0,width:r.width,height:r.height})(),bt(n)(Ny(n)(t.layer))()}},Wy=function(t){return Gt(function(e){var n=Mu(e);if(n instanceof d)return Re(void 0);if(n instanceof s){var r=xu(0)(ta(n.value0));if(r instanceof d)return ye(t);if(r instanceof s)return function(){var a=Yr(t.layer)(),o=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(Ko(r.value0)),y:lt(Zo(r.value0))})(),l={offsetX:o.x-a.x,offsetY:o.y-a.y};return kp(l)(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 199, column 22 - line 209, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 197, column 63 - line 209, column 22): "+[n.constructor.name])})},Uy=function(t){return Gt(function(e){var n=Mu(e);if(n instanceof d)return Re(void 0);if(n instanceof s){var r=xu(0)(ta(n.value0));if(r instanceof d)return ye(t);if(r instanceof s)return function(){var a=Yr(t.layer)(),o=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(Ko(r.value0)),y:lt(Zo(r.value0))})(),l={translateX:o.x-a.x,translateY:o.y-a.y};return Nu(l)(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 227, column 22 - line 237, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 225, column 62 - line 237, column 22): "+[n.constructor.name])})},Hy=function(t){return Gt(function(e){var n=Mu(e);if(n instanceof d)return Re(void 0);if(n instanceof s){var r=xu(0)(ta(n.value0));if(r instanceof d)return ye(t);if(r instanceof s)return function(){var a=Yr(t.layer)(),o=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(Ko(r.value0)),y:lt(Zo(r.value0))})(),l={translateX:o.x-a.x,translateY:o.y-a.y};return Nu(l)(t.layer)(),zp(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 256, column 22 - line 267, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 254, column 61 - line 267, column 22): "+[n.constructor.name])})},ac=function(t){return function(e){return In($n(Iu(ra)(rn(Sl(t))))(function(n){return rc(rn(Nl(n)(e)))(function(){return $n(rn(Jp(ec)(Qi)))(function(r){return $n(Iu(ra)(rn(en(t)(nn(r)))))(function(u){return $n(ra(bu(u)))(function(a){return oc({canvas:n,canvasElement:u,canvasHtmlElement:a,document:r})})})})})}))}},Gp=function(t){var e=Nt(t);return function(n){return function(r){return function(){var a=Sy(e(r))();return Py(n)({layer:a})}}}},$y=function(t){return Gt(function(e){var n=Lu(e);if(n instanceof d)return Re(void 0);if(n instanceof s)return function(){var u=Yr(t.layer)(),a=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(ea(n.value0)),y:lt(na(n.value0))})(),o={translateX:a.x-u.x,translateY:a.y-u.y};return Nu(o)(t.layer)(),zp(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 240, column 60 - line 251, column 20): "+[n.constructor.name])})},qy=function(t){return Gt(function(e){var n=Lu(e);if(n instanceof d)return Re(void 0);if(n instanceof s)return function(){var u=Yr(t.layer)(),a=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(ea(n.value0)),y:lt(na(n.value0))})(),o={translateX:a.x-u.x,translateY:a.y-u.y};return Nu(o)(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 212, column 62 - line 222, column 20): "+[n.constructor.name])})},Oy=function(t){return Gt(function(e){var n=Lu(e);if(n instanceof d)return Re(void 0);if(n instanceof s)return function(){var u=Yr(t.layer)(),a=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(ea(n.value0)),y:lt(na(n.value0))})(),o={offsetX:a.x-u.x,offsetY:a.y-u.y};return kp(o)(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 184, column 62 - line 194, column 20): "+[n.constructor.name])})},By=function(t){return Gt(function(e){return ye(t)})},uc=function(t){return function(e){return function(n){return function(r){return In(function(){var u=nn(r.document);return $n(Iu(ra)(rn(en(t)(u))))(function(a){return $n(rn(Gt(function(o){return function(){var i=Yo("canvas")(Fu(r.document))();sr("id")("hidden-clip-canvas")(i)();var f=Np(r.document)();if(f instanceof s){Xi(Tp(i))(Pp(f.value0))();var c=Sl("hidden-clip-canvas")();if(c instanceof s){Nl(c.value0)({width:n.width,height:n.height})();var p=Qn(c.value0)(),m=r.canvas;xl(p)(m)(n.x)(n.y)(n.width)(n.height)(0)(0)(n.width)(n.height)();var h=Aa(c.value0)(),w=Yo("a")(Fu(r.document))();sr("href")(h)(w)(),sr("download")(e)(w)();var C=bu(w);if(C instanceof s)return wu(C.value0)();throw new Error("Failed pattern match at Template.Main (line 178, column 9 - line 178, column 53): "+[C.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 167, column 5 - line 167, column 64): "+[c.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 164, column 5 - line 164, column 53): "+[f.constructor.name])}})))(function(o){return rc(rn(Vt("click")(o)(!1)(re(a))))(function(){return oc(a)})})})}())}}}},Vp=function(t){return function(e){return function(n){return In(function(){var r=nn(n.document);return $n(Iu(ra)(rn(en(t)(r))))(function(u){return $n(rn(Gt(function(a){return function(){var l=Aa(n.canvas)(),i=Yo("a")(Fu(n.document))();sr("href")(l)(i)(),sr("download")(e)(i)();var f=bu(i);if(f instanceof s)return wu(f.value0)();throw new Error("Failed pattern match at Template.Main (line 149, column 9 - line 149, column 53): "+[f.constructor.name])}})))(function(a){return rc(rn(Vt("click")(a)(!1)(re(u))))(function(){return oc(u)})})})}())}}},ky=function(t){return function(e){return function(n){return function(r){return function(){var a=en(e)(nn(t.document))();if(a instanceof s){var o=Op(a.value0);if(o instanceof s){var l=Eu(o.value0)();He(r(l))(n)();var i=Gt(function(f){return function(){var p=Eu(o.value0)();return He(r(p))(n)()}})();return Vt("input")(i)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 303, column 7 - line 303, column 55): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 302, column 3 - line 302, column 79): "+[a.constructor.name])}}}}},aa=function(t){return function(e){return function(n){return function(r){return ky(t)(e)(n)(function(u){return function(a){return function(o){return Re(a(o))}}(r(u))})}}}},Kr=function(t){return function(e){return function(n){return function(r){return function(){var a=en(e)(nn(t.document))();if(a instanceof s){var o=qp(a.value0);if(o instanceof s){var l=Cu(o.value0)();He(r(l))(n)();var i=Gt(function(f){return function(){var p=Cu(o.value0)();return He(r(p))(n)()}})();return Vt("input")(i)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 335, column 7 - line 335, column 54): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 334, column 3 - line 334, column 79): "+[a.constructor.name])}}}}},ua=function(t){return function(e){return function(n){return function(r){return Kr(t)(e)(n)(function(u){return function(a){return function(o){return Re(a(o))}}(r(u))})}}}},jp=function(t){return function(e){return function(n){return function(r){return function(){var a=en(e)(nn(t.document))();if(a instanceof s){var o=Qo(a.value0);if(o instanceof s){var l=Xr(o.value0)();(function(){var f=Ha(l);if(f instanceof s)return He(r(f.value0))(n)();if(f instanceof d)return void 0;throw new Error("Failed pattern match at Template.Main (line 354, column 3 - line 356, column 25): "+[f.constructor.name])})();var i=Gt(function(f){return function(){var p=Xr(o.value0)(),m=Ha(p);if(m instanceof s)return He(r(m.value0))(n)();if(m instanceof d)return void 0;throw new Error("Failed pattern match at Template.Main (line 360, column 5 - line 362, column 27): "+[m.constructor.name])}})();return Vt("input")(i)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 351, column 7 - line 351, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 350, column 3 - line 350, column 79): "+[a.constructor.name])}}}}},zy=function(t){return function(e){return function(n){return function(r){return jp(t)(e)(n)(function(u){return function(a){return function(o){return Re(a(o))}}(r(u))})}}}};var Xp=function(t){var e=Yf(t);return function(n){return function(r){return function(u){return function(){var o=xn(1)();return jp(n)(r)(u)(function(l){return function(i){return function(){var c=fe(o)();return Ar(l)(o)(),e(l/c)(i)()}}})()}}}}},Su=function(t){return function(e){return function(n){return zy(t)(e)(n)(cp)}}},Jy=function(t){return function(e){return function(n){return function(r){return function(){var a=en(e)(nn(t.document))();if(a instanceof s){var o=Qo(a.value0);if(o instanceof s){var l=Xr(o.value0)();He(r(l))(n)();var i=Gt(function(f){return function(){var p=Xr(o.value0)();return He(r(p))(n)()}})();return Vt("input")(i)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 287, column 7 - line 287, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 286, column 3 - line 286, column 79): "+[a.constructor.name])}}}}},Pu=function(t){return function(e){return function(n){return function(r){return Jy(t)(e)(n)(function(u){return function(a){return function(o){return Re(a(o))}}(r(u))})}}}},Gy=function(t){return function(e){return function(n){return function(r){return function(){var a=en(e)(nn(t.document))();if(a instanceof s){var o=Qo(a.value0);if(o instanceof s){var l=function(c){if(c instanceof d)return Re(void 0);if(c instanceof s){var p=Ye(Ay(c.value0))(0);if(p instanceof d)return Re(void 0);if(p instanceof s)return He(r(p.value0))(n);throw new Error("Failed pattern match at Template.Main (line 390, column 24 - line 392, column 54): "+[p.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 388, column 26 - line 392, column 54): "+[c.constructor.name])},i=tc(o.value0)();l(i)();var f=Gt(function(c){return Jp(l)(tc(o.value0))})();return Vt("change")(f)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 385, column 7 - line 385, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 384, column 3 - line 384, column 79): "+[a.constructor.name])}}}}};var Vy=function(t){return function(e){return function(n){return function(r){return function(){var a=en(e)(nn(t.document))();if(a instanceof s){var o=Qo(a.value0);if(o instanceof s){var l=Tu(o.value0)();He(r(l))(n)();var i=Gt(function(f){return function(){var p=Tu(o.value0)();return He(r(p))(n)()}})();return Vt("input")(i)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 319, column 7 - line 319, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 318, column 3 - line 318, column 79): "+[a.constructor.name])}}}}},lc=function(t){return function(e){return function(n){return function(r){return Vy(t)(e)(n)(function(u){return function(a){return function(o){return Re(a(o))}}(r(u))})}}}},jy=function(t){return function(e){return function(n){return function(r){return Gy(t)(e)(n)(function(u){return r(Ep(u))})}}}};var ic=function(t){return function(e){return function(n){return function(r){return jy(t)(e)(n)(function(u){return function(a){return function(){var l=Yi(u)();return r(l)(a)()}}})}}}},cc=function(t){return function(){var n=Oy(t)(),r=qy(t)(),u=$y(t)(),a=Wy(t)(),o=Uy(t)(),l=Hy(t)(),i=By(t)();return Vt("mousedown")(n)(!1)(re(t.canvasElement))(),Vt("mousemove")(r)(!1)(re(t.canvasElement))(),Vt("mouseup")(u)(!1)(re(t.canvasElement))(),Vt("touchstart")(a)(!1)(re(t.canvasElement))(),Vt("touchmove")(o)(!1)(re(t.canvasElement))(),Vt("touchend")(l)(!1)(re(t.canvasElement))(),Vt("input")(i)(!1)(Ip(t.document))()}};var Yy=$e(qe),Qy=Vn(vt)(Ce),Qp=$t(ee),sc=At(A),Ky=Qp(Ct),Kp=le(_r()(Rn({reflectSymbol:function(){return"height"}})()(Rn({reflectSymbol:function(){return"width"}})()(mr)(ke))(ke))),dr=De(bn),Qt=Ka(Yt),Zp=As(Yt),Bt=Ws(Yt),tv=Xp(Ss(Yt)),Zr=ei(Yt),Wu=Ao(Yt),ev=Nt(Wu(Ru(Yt))),nv=Nt(Wu(au(Yt))),dc=yp(wt),rv=ja(Yt),ov=Wu(rv),av=dc(ov),Au=Nt(av),uv=Nt(Rp(wt)(od(Ql(wt))(wt))),lv=js(wt),iv=Nt(Wu(nd(lv)(wt))),Zy=Nt(Ys(wt)(av)),cv=Nt(ov),fv=Nt(dc(li(Ct))),sv=Gp(lv),tD=Nt(dc(rv));var dv=function(t){var e=ja(t),n=_t(e),r=t.Monad0(),u=r.Bind1(),a=E(u),o=v(u.Apply0().Functor0()),l=Hs(t),i=mt(e),f=r.Applicative0(),c=R(f),p=St(e),m=gt(e),h=Et(e),w=ne(f),C=Mt(e);return{position:function(W){return n(W.guillotine)},translate:function(W){return function(J){return a(o(function(st){return function($){return $+W.translateX}(function($){return $.x}(st))})(n(J.guillotine)))(function(st){return a(l(J.guillotine))(function($){var Z=Us(J.guillotine).scaleY,Rt=function(){return $ instanceof s&&$.value0.width!==0?Ps({scaleX:(J.xMax-st)/$.value0.width,scaleY:Z})(J.guillotine):J.guillotine}();return a(i(W)(Rt))(function(ct){return c({xMax:J.xMax,guillotine:ct})})})})}},containsPoint:function(W){return function(J){return p(W)(J.guillotine)}},draw:function(W){return function(J){return m(W)(J.guillotine)}},dragStart:function(W){return function(J){return a(h(W)(J.guillotine))(function(st){return c({xMax:J.xMax,guillotine:st})})}},drag:function(W){return function(J){return w(dv(t))(J.guillotine.dragOffset)(W)(J)}},dragEnd:function(W){return a(C(W.guillotine))(function(J){return c({xMax:W.xMax,guillotine:J})})}}},pv=function(t){var e=t.Monad0(),n=Pl(e),r=_t(n),u=e.Bind1(),a=E(u),o=mt(n),l=dv(t),i=mt(l),f=Ao(t),c=f(au(t)),p=mt(c),m=f(Ru(t)),h=mt(m),w=Yy(u),C=td(t),W=e.Applicative0(),J=R(W),st=u.Apply0().Functor0(),$=v(st),Z=Qp(W),Rt=Cn(st),ct=St(Rt),on=Nt(n),On=Nt(l),pr=Nt(m),mc=Nt(c),mv=gt(Rt),_v=Et(n),gv=ne(W),hv=Mt(n);return{position:function(ht){return r(ht.overlayBackground)},translate:function(ht){return function(ut){return a(o(ht)(ut.overlayBackground))(function(Uu){return a(i(ht)(ut.guillotine))(function(Rv){return a(p(ht)(ut.author))(function(yv){return a(h(ht)(ut.title))(function(_c){return w(C(Gi(function(Hu){return Hu-ht.translateX}))(_c))(function(){return w(C(Gi(function(Hu){return Hu-ht.translateX}))(ut.bodyText))(function(){return J({overlayBackground:Uu,guillotine:Rv,author:yv,bodyText:ut.bodyText,title:_c})})})})})})})}},containsPoint:function(ht){return function(ut){return $(Qy)(Z(ct(ht))([on(ut.overlayBackground),On(ut.guillotine),pr(ut.bodyText),mc(ut.author),pr(ut.title)]))}},draw:function(ht){return function(ut){return sc(Ky(mv(ht))([on(ut.overlayBackground),On(ut.guillotine),pr(ut.bodyText),mc(ut.author),pr(ut.title)]))}},dragStart:function(ht){return function(ut){return a(_v(ht)(ut.overlayBackground))(function(Uu){return J({guillotine:ut.guillotine,bodyText:ut.bodyText,author:ut.author,title:ut.title,overlayBackground:Uu})})}},drag:function(ht){return function(ut){return gv(pv(t))(ut.overlayBackground.dragOffset)(ht)(ut)}},dragEnd:function(ht){return a(hv(ht.overlayBackground))(function(ut){return J({guillotine:ht.guillotine,bodyText:ht.bodyText,author:ht.author,title:ht.title,overlayBackground:ut})})}}},eD=Nt(hp(wt)(ad(pv(Yt))(wt))),I=2;var nD={width:1080,height:1920},pc=Kp({width:I,height:I})(nD),fc=function(){return pc.height}(),Yp=function(){return pc.width}();var rD=function(t){var e=t.Monad0(),n=E(e.Bind1()),r=ei(t),u=R(e.Applicative0());return function(a){return function(o){return function(l){return function(i){return n(r(a)(o)(l)(Ne.value))(function(f){return u({guillotine:f,xMax:i})})}}}}},oD=rD(Yt),aD=function(){return{width:1080,height:1080*5/4}}(),vc=function(){return Kp({width:2*I,height:I})(aD)}(),qn=function(){return vc.height}(),xt=function(){return vc.width}(),uD=sc(function(){var e=ac("canvas-story")(pc)();if(e instanceof s){var n=Qn(e.value0.canvas)(),r=dr(Qt)(Zp({x:0,y:120*I})({scaleX:1,scaleY:1})(Ne.value))();ic(e.value0)("image")(r)(Bt)(),tv(e.value0)("image-size")(r)();var u=dr(Qt)(Zr("./img/guillotinewit2x.png")({x:60*I,y:180*I})({scaleX:960/780,scaleY:1})(Ne.value))(),a=dr(Qt)(Zr("./img/jacobinlogowit80x200.png")({x:xt/2-100*I,y:fc-610*I})({scaleX:1,scaleY:1})(Ne.value))(),o=dr(Qt)(Zr("./img/story-overlay.svg")({x:0,y:0})({scaleX:2,scaleY:2})(Ne.value))(),l={x:60*I,y:fc-2*60*I},i=Qt({text:[],lineHeight:.9,position:l,maxWidth:new s(Yp-2*60*I),fillStyle:"#fff",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:100*I},align:ie.value,baseline:Ie.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();aa(e.value0)("title-left")(i)(Xo)(),Su(e.value0)("title-size-story")(i)();var f=Qt({text:"AUTEUR",lineHeight:.95,position:l,fillStyle:"#fff",fontName:"Oswald",fontStyle:"normal",fontWeight:"500",fontSize:I*50,align:ie.value,baseline:Ee.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();Pu(e.value0)("author")(f)(ou)(),ua(e.value0)("color")(i)(ki)(),ua(e.value0)("color")(f)(Di)(),Kr(e.value0)("color")(a)(function(C){if(C==="#fff")return Bt("./img/jacobinlogowit80x200.png");if(C==="#f00")return Bt("./img/jacobinlogo80x200.png");if(C==="#000")return Bt("./img/jacobinlogozwart80x200.png");if(C==="#fff")return Bt("./img/jacobinlogowit80x200.png");throw new Error("Failed pattern match at Jacobin.TitleSlide (line 417, column 56 - line 421, column 68): "+[C.constructor.name])})(),Kr(e.value0)("color")(u)(function(C){return Bt(C==="#fff"?"./img/guillotinewit2x.png":C==="#f00"?"./img/guillotine2x.png":C==="#000"?"./img/guillotinezwart2x.png":"./img/guillotinewit2x.png")})();var c=di(l.y)(50*I)(Kl([ev(i),nv(f)])),p=Qt(si({offsetX:0,offsetY:0})("#555")(15)(Po([Au(hn(a)),uv(Vi(c)),Au(hn(u))])))();lc(e.value0)("shadow")(p)(function(C){return fi(function(){return C?"#555":"#0000"}())})();var m=Po([iv(p),Zy(Qs(hn(o))),cv(r),fv(hn(ii({x:0,y:0,width:Yp,height:fc})("#f00")))]),h=sv(e.value0)(m)();ye(h)(),cc(h)();var w=Vp("download-story")("jacobin-story.png")(h)();if(w instanceof s)return void 0;throw new Error("Failed pattern match at Jacobin.TitleSlide (line 456, column 3 - line 456, column 75): "+[w.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 349, column 3 - line 349, column 83): "+[e.constructor.name])}),lD=sc(function(){var e=ac("canvas-title-slide")(vc)();if(e instanceof s){var n=Qn(e.value0.canvas)(),r=dr(Qt)(Zp({x:0,y:0})({scaleX:1,scaleY:1})(Ne.value))();ic(e.value0)("image")(r)(Bt)(),tv(e.value0)("image-size")(r)();var u=oD("./img/guillotine2x.png")({x:xt/2+285*I,y:60*I})({scaleX:(xt-180*I-(xt/2+285*I))/1560,scaleY:1})(xt-180*I)(),a=dr(Qt)(Zr("./img/guillotinewit2x.png")({x:60*I,y:60*I})({scaleX:1,scaleY:1})(Ne.value))(),o=Zr("./img/jacobinlogo80x200.png")({x:xt-100*I,y:qn-160*I})({scaleX:1,scaleY:1})(Ne.value)(),l=dr(Qt)(Zr("./img/jacobinlogowit80x200.png")({x:xt/2-100*I,y:qn-160*I})({scaleX:1,scaleY:1})(Ne.value))(),i=Qt({text:[],lineHeight:1.1,position:{x:xt-I*60,y:I*150},fillStyle:"#f00",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"500",bold:"700"},size:90*I},align:Tn.value,baseline:Ee.value,letterSpacing:"-3px",emptyLineHeight:.25,dragOffset:d.value,maxWidth:new s(xt/2-2*60*I),context:n})();aa(e.value0)("bodytext")(i)(Xo)(),Su(e.value0)("bodytext-size")(i)();var f={x:60*I,y:250*I},c=Qt({text:[],lineHeight:.9,position:f,maxWidth:new s(xt/2-2*60*I),fillStyle:"#fff",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:100*I},align:ie.value,baseline:Ie.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();aa(e.value0)("title-left")(c)(Xo)(),Su(e.value0)("title-size")(c)();var p=Qt({text:"AUTEUR",lineHeight:.95,position:f,fillStyle:"#fff",fontName:"Oswald",fontStyle:"normal",fontWeight:"500",fontSize:I*50,align:ie.value,baseline:Ee.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();Pu(e.value0)("author")(p)(ou)();var m=di(f.y)(50*I)(Kl([ev(c),nv(p)])),h=Qt({text:"AUTEUR",lineHeight:.95,position:{x:xt/2+128*I,y:qn-160*I},fillStyle:"#f00",fontName:"Oswald",fontStyle:"normal",fontWeight:"400",fontSize:2*50,align:ie.value,baseline:Ie.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();Pu(e.value0)("author")(h)(function(ct){return ou(La(ct))})();var w=Qt({text:[],lineHeight:.9,position:{x:xt/2+128*I,y:qn-160*I},maxWidth:new s(xt/2-(128+2*60+20)*I),fillStyle:"#f00",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:50*I},align:ie.value,baseline:Ee.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();aa(e.value0)("title-right")(w)(Xo)(),ua(e.value0)("color")(c)(ki)(),ua(e.value0)("color")(p)(Di)(),Kr(e.value0)("color")(l)(function(ct){if(ct==="#fff")return Bt("./img/jacobinlogowit80x200.png");if(ct==="#f00")return Bt("./img/jacobinlogo80x200.png");if(ct==="#000")return Bt("./img/jacobinlogozwart80x200.png");if(ct==="#fff")return Bt("./img/jacobinlogowit80x200.png");throw new Error("Failed pattern match at Jacobin.TitleSlide (line 293, column 61 - line 297, column 68): "+[ct.constructor.name])})(),Kr(e.value0)("color")(a)(function(ct){return Bt(ct==="#fff"?"./img/guillotinewit2x.png":ct==="#f00"?"./img/guillotine2x.png":ct==="#000"?"./img/guillotinezwart2x.png":"./img/guillotinewit2x.png")})();var C=Zf({x:xt/2+60*I,y:0})({width:xt,height:qn})(82.5)("#fff"),W=rd(xt/2)(60*I)({overlayBackground:C,guillotine:u,bodyText:i,author:h,title:w}),J=Qt(si({offsetX:0,offsetY:0})("#555")(15)(Po([Au(hn(l)),uv(Vi(m)),Au(hn(a))])))();lc(e.value0)("shadow")(J)(function(ct){return fi(function(){return ct?"#555":"#0000"}())})();var st=Po([tD(hn(o)),eD(Dp(W)),iv(J),cv(r),fv(hn(ii({x:0,y:0,width:xt,height:qn})("#f00")))]),$=sv(e.value0)(st)();ye($)(),cc($)();var Z=uc("download-left")("jacobin-titel-links.png")({x:0,y:0,width:xt/2,height:qn})($)();if(Z instanceof s){var Rt=uc("download-right")("jacobin-titel-rechts.png")({x:xt/2,y:0,width:xt/2,height:qn})($)();if(Rt instanceof s)return void 0;throw new Error("Failed pattern match at Jacobin.TitleSlide (line 344, column 3 - line 344, column 173): "+[Rt.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 343, column 3 - line 343, column 155): "+[Z.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 154, column 3 - line 154, column 84): "+[e.constructor.name])}),vv=ve(Pa)(lD)(uD);vv();})();
