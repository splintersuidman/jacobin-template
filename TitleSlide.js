/* Generated by Spago v0.93.44 */
(()=>{var ic=function(t){return function(e){for(var n=t.length,r=e.length,u=new Array(n*r),a=0,o=0;o<n;o++)for(var i=t[o],l=0;l<r;l++)u[a++]=i(e[l]);return u}};var oa={compose:function(t){return function(e){return function(n){return t(e(n))}}}};var G=function(t){return t.identity},Q={identity:function(t){return t},Semigroupoid0:function(){return oa}};var qt=!0;var et=function(t){return function(e){return function(n){return t(n)(e)}}},tt=function(t){return function(e){return t}};var cc=function(t){return function(e){for(var n=e.length,r=new Array(n),u=0;u<n;u++)r[u]=t(e[u]);return r}};var B=function(){function t(){}return t.value=new t,t}();var v=function(t){return t.map},fe=function(t){var e=v(t);return function(n){return function(r){return e(r)(n)}}},It=function(t){return v(t)(tt(void 0))};var tn=function(t){var e=v(t);return function(n){return e(tt(n))}};var Nt={map:cc};var dv=G(Q);var ua={apply:ic,Functor0:function(){return Nt}},st=function(t){return t.apply},fc=function(t){var e=st(t),n=v(t.Functor0());return function(r){return function(u){return e(n(tt)(r))(u)}}},se=function(t){var e=st(t),n=v(t.Functor0());return function(r){return function(u){return e(n(tt(dv))(r))(u)}}};var y=function(t){return t.pure};var Yr=function(t){var e=st(t.Apply0()),n=y(t);return function(r){return function(u){return e(n(r))(u)}}};var dc=typeof Array.prototype.flatMap=="function"?function(t){return function(e){return t.flatMap(e)}}:function(t){return function(e){for(var n=[],r=t.length,u=0;u<r;u++)for(var a=e(t[u]),o=a.length,i=0;i<o;i++)n.push(a[i]);return n}};var Ae=function(t){return t.discard};var ia={bind:dc,Apply0:function(){return ua}},C=function(t){return t.bind},he=function(t){return et(C(t))};var We={discard:function(t){return C(t)}};var pc=function(t){return function(e){return function(n){for(var r=e,u=n.length,a=u-1;a>=0;a--)r=t(n[a])(r);return r}}},vc=function(t){return function(e){return function(n){for(var r=e,u=n.length,a=0;a<u;a++)r=t(r)(n[a]);return r}}};var mc=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var ne=function(t){return t.reflectSymbol};var ye=function(t){return function(e){return e[t]}},de=function(t){return function(e){return function(n){var r={};for(var u in n)({}).hasOwnProperty.call(n,u)&&(r[u]=n[u]);return r[t]=e,r}}};var He={append:mc};var q=function(t){return t.append};var Et=function(t){return t.alt};var gc="\uFFFF",hc="\0",Dv=Number.POSITIVE_INFINITY,Fv=Number.NEGATIVE_INFINITY;var Wu=function(t){return function(e){return function(n){return function(r){return function(u){return r<u?t:r===u?e:n}}}}};var Rc=Wu,yc=Wu;var Dc=Wu;var Uu=function(t){return function(e){return t===e}};var Fc=Uu,wc=Uu,bc=Uu;var Tc={eq:wc},ca={eq:Fc},fa={eq:bc};var Y=function(t){return t.eq};var k=function(){function t(){}return t.value=new t,t}(),U=function(){function t(){}return t.value=new t,t}(),rt=function(){function t(){}return t.value=new t,t}();var dr={eq:function(t){return function(e){return t instanceof k&&e instanceof k||t instanceof U&&e instanceof U||t instanceof rt&&e instanceof rt}}};var Cc=function(t){return function(e){return t-e|0}},Ec=function(t){return function(e){return t-e}};var Mc=function(t){return function(e){return t+e|0}},xc=function(t){return function(e){return t*e|0}},Lc=function(t){return function(e){return t+e}},Ic=function(t){return function(e){return t*e}};var Nc=function(t){return t.zeroRecord},De=function(t){return t.zero};var pr={addRecord:function(t){return function(e){return function(n){return{}}}},mulRecord:function(t){return function(e){return function(n){return{}}}},oneRecord:function(t){return function(e){return{}}},zeroRecord:function(t){return function(e){return{}}}};var $e={add:Lc,zero:0,mul:Ic,one:1},sa={add:Mc,zero:0,mul:xc,one:1},Sc=function(t){return t.oneRecord},qe=function(t){return t.one},Pc=function(t){return t.mulRecord},re=function(t){return t.mul},Ac=function(t){return t.addRecord},vr=function(){return function(t){return{add:Ac(t)(B.value),mul:Pc(t)(B.value),one:Sc(t)(B.value)(B.value),zero:Nc(t)(B.value)(B.value)}}},pe=function(t){return t.add};var gn=function(t){var e=ne(t);return function(){return function(n){var r=Ac(n),u=Pc(n),a=Sc(n),o=Nc(n);return function(i){var l=pe(i),f=re(i),c=qe(i),p=De(i);return{addRecord:function(m){return function(h){return function(w){var L=r(B.value)(h)(w),W=e(B.value),J=de(W),ft=ye(W);return J(l(ft(h))(ft(w)))(L)}}},mulRecord:function(m){return function(h){return function(w){var L=u(B.value)(h)(w),W=e(B.value),J=de(W),ft=ye(W);return J(f(ft(h))(ft(w)))(L)}}},oneRecord:function(m){return function(h){var w=a(B.value)(B.value),L=e(B.value),W=de(L);return W(c)(w)}},zeroRecord:function(m){return function(h){var w=o(B.value)(B.value),L=e(B.value),W=de(L);return W(p)(w)}}}}}}};var Mv=vr(),Wc=function(t){return t.subRecord},mr=function(t){return t.sub};var Hu={subRecord:function(t){return function(e){return function(n){return{}}}},SemiringRecord0:function(){return pr}},da=function(t){var e=ne(t),n=gn(t)();return function(){return function(r){var u=Wc(r),a=n(r.SemiringRecord0());return function(o){var i=mr(o),l=a(o.Semiring0());return{subRecord:function(f){return function(c){return function(p){var m=u(B.value)(c)(p),h=e(B.value),w=de(h),L=ye(h);return w(i(L(c))(L(p)))(m)}}},SemiringRecord0:function(){return l}}}}}},$u=function(){return function(t){var e=Mv(t.SemiringRecord0());return{sub:Wc(t)(B.value),Semiring0:function(){return e}}}};var pa={sub:Ec,Semiring0:function(){return $e}},Uc={sub:Cc,Semiring0:function(){return sa}};var Zr=function(){return{compare:yc(k.value)(rt.value)(U.value),Eq0:function(){return Tc}}}(),ve=function(){return{compare:Rc(k.value)(rt.value)(U.value),Eq0:function(){return ca}}}(),va=function(){return{compare:Dc(k.value)(rt.value)(U.value),Eq0:function(){return fa}}}();var z=function(t){return t.compare};var en=function(t){return t.top};var to={top:gc,bottom:hc,Ord0:function(){return va}};var hn=function(t){return t.bottom};var qc=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"},Oc=function(t){var e=t.charCodeAt(0);if(e<32||e===127){switch(t){case"\x07":return"'\\a'";case"\b":return"'\\b'";case"\f":return"'\\f'";case`
`:return"'\\n'";case"\r":return"'\\r'";case"	":return"'\\t'";case"\v":return"'\\v'"}return"'\\"+e.toString(10)+"'"}return t==="'"||t==="\\"?"'\\"+t+"'":"'"+t+"'"};var Bc=function(t){return function(e){for(var n=[],r=0,u=e.length;r<u;r++)n[r]=t(e[r]);return"["+n.join(",")+"]"}};var ma={show:qc};var _a={show:Oc};var E=function(t){return t.show},Ou=function(t){return{show:Bc(E(t))}};var Hv=G(Q),d=function(){function t(){}return t.value=new t,t}(),s=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}();var Fe=function(t){return function(e){return function(n){if(n instanceof d)return t;if(n instanceof s)return e(n.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[t.constructor.name,e.constructor.name,n.constructor.name])}}},Rn=Fe(!0)(tt(!1));var dt={map:function(t){return function(e){return e instanceof s?new s(t(e.value0)):d.value}}};var Qt=function(t){return Fe(t)(Hv)},Oe=function(){return function(t){if(t instanceof s)return t.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[t.constructor.name])}};var wt=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),_t=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}();var On=function(t){return t.defer};var Jc=function(t){return function(e){return t&&e}},Gc=function(t){return function(e){return t||e}},Vc=function(t){return!t};var Ra=function(t){return t.not};var no=function(t){return t.ff};var hr=function(t){return t.disj},we={ff:!1,tt:!0,implies:function(t){return function(e){return hr(we)(Ra(we)(t))(e)}},conj:Jc,disj:Gc,not:Vc};var jc=function(t){return Math.min(Math.abs(t),2147483647)},Xc=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},Yc=function(t){return function(e){if(e===0)return 0;var n=Math.abs(e);return(t%n+n)%n}};var Qc={Ring0:function(){return Uc}};var ro=function(t){return t.mod};var ya={degree:jc,div:Xc,mod:Yc,CommutativeRing0:function(){return Qc}};var gt=function(t){return t.mempty};var M=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var rn=function(t){return t.value1};var on=function(t){return t.value0};var ba=function(t){return t};var t1=function(t){var e=hr(t);return{append:function(n){return function(r){return e(n)(r)}}}};var Xu=function(t){var e=t1(t);return{mempty:no(t),Semigroup0:function(){return e}}};var _=function(t){return t};var Yu=function(){return _};var nf=Yu();var Bn=function(){return nf};var Qu=function(){return function(){return function(){return function(){return function(t){return nf}}}}};var a1=G(Q),u1=Y(dr);var l1=Qu()()()(),kt=function(t){return t.foldr};var zn=function(t){var e=se(t.Apply0()),n=y(t);return function(r){var u=kt(r);return function(a){return u(function(o){return e(a(o))})(n(void 0))}}},lo=function(t){var e=zn(t);return function(n){return et(e(n))}};var ht=function(t){return t.foldl};var of=function(t){var e=ht(t);return function(n){var r=function(u){return function(a){if(u instanceof d)return new s(a);if(u instanceof s)return new s(function(){var o=u1(n(u.value0)(a))(U.value);return o?u.value0:a}());throw new Error("Failed pattern match at Data.Foldable (line 441, column 3 - line 441, column 27): "+[u.constructor.name,a.constructor.name])}};return e(r)(d.value)}},io=function(t){var e=z(t);return function(n){return of(n)(e)}};var Zu=function(t){var e=ht(t);return function(n){return e(pe(n))(De(n))}};var af=function(t){var e=kt(t);return function(n){var r=q(n.Semigroup0()),u=gt(n);return function(a){return e(function(o){return function(i){return r(a(o))(i)}})(u)}}},pt={foldr:pc,foldl:vc,foldMap:function(t){return af(pt)(t)}};var Be=function(t){return t.foldMap};var Jn=function(t){var e=Be(t);return function(n){return l1(ba)(e(Xu(n)))}};var Gn=function(t){var e=Jn(t);return function(n){return e(n)(a1)}};var Ea=function(t){return t.toUpperCase()};var Vn=function(t){return function(e){return e.join(t)}};var wr=function(t){return t===""};var uf=function(){function t(u){return[u]}function e(u){return function(a){return[u,a]}}function n(u){return function(a){return function(o){return[u,a,o]}}}function r(u){return function(a){return u.concat(a)}}return function(u){return function(a){return function(o){return function(i){return function(l){function f(c,p){switch(p-c){case 0:return o([]);case 1:return a(t)(i(l[c]));case 2:return u(a(e)(i(l[c])))(i(l[c+1]));case 3:return u(u(a(n)(i(l[c])))(i(l[c+1])))(i(l[c+2]));default:var m=c+Math.floor((p-c)/4)*2;return u(a(r)(f(c,m)))(f(m,p))}}return f(0,l.length)}}}}}}();var br=function(t){return t};var nl={map:function(t){return function(e){return t(e)}}};var ff={apply:function(t){return function(e){return t(e)}},Functor0:function(){return nl}},s1={bind:function(t){return function(e){return e(t)}},Apply0:function(){return ff}},d1={pure:br,Apply0:function(){return ff}},sf={Applicative0:function(){return d1},Bind1:function(){return s1}};var G1=G(Q),At=function(t){return t.traverse};var V1=function(t){var e=At(t);return function(n){return e(n)(G1)}},Kt={traverse:function(t){var e=t.Apply0();return uf(st(e))(v(e.Functor0()))(y(t))},sequence:function(t){return V1(Kt)(t)},Functor0:function(){return Nt},Foldable1:function(){return pt}};var yf=function(t){return function(e){var n=At(e)(t);return function(r){return function(u){return n(u)(r)}}}};var Df=function(t){return function(){return t}},Ff=function(t){return function(e){return function(){return e(t())()}}};var bf=function(t){var e=C(t.Bind1()),n=y(t.Applicative0());return function(r){return function(u){return e(u)(function(a){return n(r(a))})}}},Xn=function(t){var e=C(t.Bind1()),n=y(t.Applicative0());return function(r){return function(u){return e(r)(function(a){return e(u)(function(o){return n(a(o))})})}}};var Tf=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}},bt={Applicative0:function(){return Tt},Bind1:function(){return Fn}},Fn={bind:Ff,Apply0:function(){return il(0)}},Tt={pure:Df,Apply0:function(){return il(0)}},Cf=Tf("functorEffect","Effect",function(){return{map:Yr(Tt)}}),il=Tf("applyEffect","Effect",function(){return{apply:Xn(bt),Functor0:function(){return Cf(0)}}}),A=Cf(20),Ia=il(23);var Jt={liftEffect:G(Q),Monad0:function(){return bt}},Wt=function(t){return t.liftEffect};function Ef(t){return function(e){return function(n){return function(){var r=new Image;r.src=t,r.addEventListener("load",function(){n(r)()},!1),r.addEventListener("error",function(){e()},!1)}}}}function Mf(t,e,n){return function(){var r=document.getElementById(t);return r&&r instanceof HTMLCanvasElement?e(r):n}}function Yn(t){return function(){return t.getContext("2d")}}function so(t){return function(){return t.width}}function po(t){return function(){return t.height}}function cl(t){return function(e){return function(){t.width=e}}}function fl(t){return function(e){return function(){t.height=e}}}function Na(t){return function(){return t.toDataURL()}}function Me(t){return function(e){return function(){t.fillStyle=e}}}function sl(t){return function(e){return function(){t.shadowColor=e}}}function dl(t){return function(e){return function(){t.shadowBlur=e}}}function pl(t){return function(e){return function(){t.shadowOffsetX=e}}}function vl(t){return function(e){return function(){t.shadowOffsetY=e}}}function xf(t){return function(e){return function(){t.globalCompositeOperation=e}}}function vo(t){return function(){t.beginPath()}}function mo(t){return function(){t.fill()}}function _o(t){return function(e){return function(n){return function(){t.lineTo(e,n)}}}}function ml(t){return function(e){return function(n){return function(){t.moveTo(e,n)}}}}function _l(t){return function(){t.closePath()}}function gl(t){return function(e){return function(){t.rect(e.x,e.y,e.width,e.height)}}}function hl(t){return function(e){return function(){t.clearRect(e.x,e.y,e.width,e.height)}}}function Rl(t){return function(e){return function(){t.translate(e.translateX,e.translateY)}}}function Lf(t){return function(e){return function(){t.textAlign=e}}}function If(t){return function(e){return function(){t.textBaseline=e}}}function Tr(t){return function(e){return function(){t.font=e}}}function go(t){return function(e){return function(n){return function(r){return function(){t.fillText(e,n,r)}}}}}function yl(t){return function(){t.save()}}function Dl(t){return function(){t.restore()}}function Fl(t){return function(e){return function(n){return function(r){return function(u){return function(a){return function(){t.drawImage(e,n,r,u,a)}}}}}}}function wl(t){return function(e){return function(n){return function(r){return function(u){return function(a){return function(o){return function(i){return function(l){return function(f){return function(){t.drawImage(e,n,r,u,a,o,i,l,f)}}}}}}}}}}}var rm=se(Ia),be=function(){function t(){}return t.value=new t,t}(),om=function(){function t(){}return t.value=new t,t}(),am=function(){function t(){}return t.value=new t,t}(),um=function(){function t(){}return t.value=new t,t}(),lm=function(){function t(){}return t.value=new t,t}(),xe=function(){function t(){}return t.value=new t,t}(),oe=function(){function t(){}return t.value=new t,t}(),wn=function(){function t(){}return t.value=new t,t}(),Cr=function(){function t(){}return t.value=new t,t}(),Er=function(){function t(){}return t.value=new t,t}(),Mr=function(){function t(){}return t.value=new t,t}();var ke=function(){function t(){}return t.value=new t,t}(),im=function(){function t(){}return t.value=new t,t}(),cm=function(){function t(){}return t.value=new t,t}(),fm=function(){function t(){}return t.value=new t,t}(),sm=function(){function t(){}return t.value=new t,t}(),dm=function(){function t(){}return t.value=new t,t}(),pm=function(){function t(){}return t.value=new t,t}(),vm=function(){function t(){}return t.value=new t,t}(),mm=function(){function t(){}return t.value=new t,t}(),_m=function(){function t(){}return t.value=new t,t}(),gm=function(){function t(){}return t.value=new t,t}(),hm=function(){function t(){}return t.value=new t,t}(),Rm=function(){function t(){}return t.value=new t,t}(),ym=function(){function t(){}return t.value=new t,t}(),Dm=function(){function t(){}return t.value=new t,t}(),Fm=function(){function t(){}return t.value=new t,t}(),wm=function(){function t(){}return t.value=new t,t}(),bm=function(){function t(){}return t.value=new t,t}(),Tm=function(){function t(){}return t.value=new t,t}(),Cm=function(){function t(){}return t.value=new t,t}(),Em=function(){function t(){}return t.value=new t,t}(),Mm=function(){function t(){}return t.value=new t,t}(),xm=function(){function t(){}return t.value=new t,t}(),Lm=function(){function t(){}return t.value=new t,t}(),Im=function(){function t(){}return t.value=new t,t}(),Nm=function(){function t(){}return t.value=new t,t}(),Rt=function(t){return function(e){return function(){yl(t)();var r=e();return Dl(t)(),r}}},Tl=function(t){return function(e){return Ef(t)(e(d.value))(function(n){return e(s.create(n))})}};var xr=function(t){return function(e){var n=function(r){if(r instanceof be)return"top";if(r instanceof om)return"hanging";if(r instanceof am)return"middle";if(r instanceof um)return"alphabetic";if(r instanceof lm)return"ideographic";if(r instanceof xe)return"bottom";throw new Error("Failed pattern match at Graphics.Canvas (line 577, column 5 - line 577, column 33): "+[r.constructor.name])};return If(t)(n(e))}},Lr=function(t){return function(e){var n=function(r){if(r instanceof oe)return"left";if(r instanceof wn)return"right";if(r instanceof Cr)return"center";if(r instanceof Er)return"start";if(r instanceof Mr)return"end";throw new Error("Failed pattern match at Graphics.Canvas (line 531, column 5 - line 531, column 32): "+[r.constructor.name])};return Lf(t)(n(e))}};var Af=function(t){return function(e){var n=function(r){if(r instanceof ke)return"source-over";if(r instanceof im)return"source-in";if(r instanceof cm)return"source-out";if(r instanceof fm)return"source-atop";if(r instanceof sm)return"destination-over";if(r instanceof dm)return"destination-in";if(r instanceof pm)return"destination-out";if(r instanceof vm)return"destination-atop";if(r instanceof mm)return"lighter";if(r instanceof _m)return"copy";if(r instanceof gm)return"xor";if(r instanceof hm)return"multiply";if(r instanceof Rm)return"screen";if(r instanceof ym)return"overlay";if(r instanceof Dm)return"darken";if(r instanceof Fm)return"lighten";if(r instanceof wm)return"color-dodge";if(r instanceof bm)return"color-burn";if(r instanceof Tm)return"hard-light";if(r instanceof Cm)return"soft-light";if(r instanceof Em)return"difference";if(r instanceof Mm)return"exclusion";if(r instanceof xm)return"hue";if(r instanceof Lm)return"saturation";if(r instanceof Im)return"color";if(r instanceof Nm)return"luminosity";throw new Error("Failed pattern match at Graphics.Canvas (line 326, column 5 - line 326, column 45): "+[r.constructor.name])};return xf(t)(n(e))}},Cl=function(t){return function(e){return rm(fl(t)(e.height))(cl(t)(e.width))}},El=function(t){return Mf(t,s.create,d.value)},Wf=function(t){return function(){var n=so(t)(),r=po(t)();return{width:n,height:r}}},Uf=function(t){return function(e){return function(){vo(t)();var r=e();return mo(t)(),r}}};var Sa=isFinite;function Hf(t,e,n,r){var u=parseFloat(t);return e(u)?n(u):r}var Ir=Math.round;var Pa=Math.tan;var $f=3.141592653589793;var Aa=function(t){return Hf(t,Sa,s.create,d.value)};var Wa=function(t){return function(e){return e(function(n){return t(n)})}},ze=function(t){return function(e){return{x:e.x+t.translateX,y:e.y+t.translateY}}};var yt=function(t){return t.translate},qf=function(t){return function(e){return{width:e.width*t.scaleX,height:e.height*t.scaleY}}},Ml=function(t){return t.scale},Of=function(t){var e=Ml(t);return function(n){return e({scaleX:n,scaleY:n})}},Dt=function(t){return t.position},Bt=function(t){return function(e){return function(n){return n(t)(e)}}},$m=function(t){var e=v(t);return function(n){return Wa(function(r){var u=e(Bt(r)),a=n(r);return function(o){return u(a(o))}})}};var un=function(t){return t.mapLayerWrapper},Ft=function(t){return t.draw},Bf=function(t){var e=yt(t);return function(n){return function(r){return function(u){var a={translateX:r.translateX-n.offsetX,translateY:r.translateY-n.offsetY};return e(a)(u)}}}},Zt=function(t){var e=y(t);return function(n){var r=Bf(n);return function(u){return function(a){return function(o){if(u instanceof d)return e(o);if(u instanceof s)return r(u.value0)(a)(o);throw new Error("Failed pattern match at Template.Layer (line 61, column 1 - line 61, column 115): "+[u.constructor.name,a.constructor.name,o.constructor.name])}}}}},Ut=function(t){return t.dragStart},Ht=function(t){return t.dragEnd},te=function(t){return t.drag},xt=function(t){return t.containsPoint},bn=function(t){var e=$m(t);return{position:Wa(function(n){return Dt(n)}),translate:function(n){return e(function(r){return yt(r)(n)})},containsPoint:function(n){return Wa(function(r){return xt(r)(n)})},draw:function(n){return Wa(function(r){return Ft(r)(n)})},dragStart:function(n){return e(function(r){return Ut(r)(n)})},drag:function(n){return e(function(r){return te(r)(n)})},dragEnd:e(function(n){return Ht(n)})}};var zf=function(t){return function(e){return function(n){return function(r){return{position:t,dimensions:e,angle:n,fillStyle:r,dragOffset:d.value}}}}},kf=function(t){return t*$f/180},xl=function(t){var e=t.Applicative0(),n=y(e),r=Zt(e);return{position:function(u){return n(u.position)},translate:function(u){return function(a){return n({dimensions:a.dimensions,angle:a.angle,fillStyle:a.fillStyle,dragOffset:a.dragOffset,position:ze(u)(a.position)})}},containsPoint:function(u){return function(a){var o=(a.dimensions.height-u.y)/Pa(kf(a.angle));return n(a.position.x+o<=u.x&&u.x<=a.position.x+a.dimensions.width&&a.position.y<=u.y&&u.y<=a.position.y+a.dimensions.height)}},draw:function(u){return function(a){return Rt(u)(function(){return Me(u)(a.fillStyle)(),vo(u)(),ml(u)(a.position.x)(a.position.y+a.dimensions.height)(),_o(u)(a.position.x+a.dimensions.width)(a.position.y+a.dimensions.height)(),_o(u)(a.position.x+a.dimensions.width)(a.position.y)(),_o(u)(a.position.x+a.dimensions.height/Pa(kf(a.angle)))(a.position.y)(),_l(u)(),mo(u)()})}},dragStart:function(u){return function(a){return n({position:a.position,dimensions:a.dimensions,angle:a.angle,fillStyle:a.fillStyle,dragOffset:new s(u)})}},drag:function(u){return function(a){return r(xl(t))(a.dragOffset)(u)(a)}},dragEnd:function(u){return n({position:u.position,dimensions:u.dimensions,angle:u.angle,fillStyle:u.fillStyle,dragOffset:d.value})}}};var Jf=function(t,e){for(var n=t>e?-1:1,r=new Array(n*(e-t)+1),u=t,a=0;u!==e;)r[a++]=u,u+=n;return r[a]=u,r},Om=function(t,e){if(t<1)return[];var n=new Array(t);return n.fill(e)},Bm=function(t,e){for(var n=[],r=0,u=0;u<t;u++)n[r++]=e;return n},km=typeof Array.prototype.fill=="function"?Om:Bm,Gf=function(){function t(u,a){this.head=u,this.tail=a}var e={};function n(u){return function(a){return new t(u,a)}}function r(u){for(var a=[],o=0,i=u;i!==e;)a[o++]=i.head,i=i.tail;return a}return function(u,a){return r(u(n)(e)(a))}}(),Lt=function(t){return t.length};var Vf=function(t,e,n,r){return r<0||r>=n.length?e:t(n[r])};var jf=function(t,e,n,r){for(var u=0,a=r.length;u<a;u++)if(n(r[u]))return t(u);return e};var Xf=function(t,e,n,r,u){if(n<0||n>=u.length)return e;var a=u.slice();return a[n]=r,t(a)},Tn=function(t){return t.slice().reverse()},Cn=function(t){if(t.length<=1e4)return Array.prototype.concat.apply([],t);for(var e=[],n=0,r=t.length;n<r;n++)for(var u=t[n],a=0,o=u.length;a<o;a++)e.push(u[a]);return e};var Yf=function(t,e,n){for(var r=n.length,u=e,a=new Array(r),o=0;o<r;o++)u=t(u)(n[o]),a[o]=u;return a};var Qf=function(t,e,n){return n.slice(t,e)},Kf=function(t,e,n){for(var r=e.length<n.length?e.length:n.length,u=new Array(r),a=0;a<r;a++)u[a]=t(e[a])(n[a]);return u},Zf=function(t,e){for(var n=e.length,r=0;r<n;r++)if(t(e[r]))return!0;return!1},ts=function(t,e){for(var n=e.length,r=0;r<n;r++)if(!t(e[r]))return!1;return!0};var es=function(t){return function(){return{value:t}}};var ae=function(t){return function(){return t.value}},ns=function(t){return function(e){return function(){var n=t(e.value);return e.value=n.state,n.value}}},Sr=function(t){return function(e){return function(){e.value=t}}};var Gm=It(A),En=es,Vm=ns,Ll=function(t){return Vm(function(e){var n=t(e);return{state:n,value:n}})},Il=function(t){return function(e){return Gm(Ll(t)(e))}};var ue=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),le=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),ln=function(t){return t.tailRecM};var Ym=function(t){var e=function(n){var r=!1,u;function a(o){if(o instanceof ue){n=t(o.value0);return}if(o instanceof le)return r=!0,o.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 103, column 3 - line 103, column 25): "+[o.constructor.name])}for(;!r;)u=a(n);return u};return function(n){return e(t(n))}};var rs={tailRecM:function(t){var e=function(r){return r},n=Ym(function(r){return e(t(r))});return function(r){return br(n(r))}},Monad0:function(){return sf}};function e_(t){return t}var ls=e_;function n_(t){return t.slice()}var is=n_;var cs=function(t,e){return e.push(t)};var Ha=function(e){return function(n){return function(){return e(n)}}},Nl=function(e){return function(n){return function(r){return function(){return e(n,r)}}}};var fs=Ha(ls);var c_=Ha(is),ss=function(t){return function(e){return function(){var r=c_(e)();return t(r)(),fs(r)()}}};var Sl=Nl(cs);var Ro=function(t){return function(e,n,r,u,a){return t(e)(n)(r)(u)(a)}};var Mn=function(t){return function(e){return function(n){return t(e,n)}}},yo=function(t){return function(e){return function(n){return function(r){return t(e,n,r)}}}},$a=function(t){return function(e){return function(n){return function(r){return function(u){return t(e,n,r,u)}}}}},Pl=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){return t(e,n,r,u,a)}}}}}};var vs=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){for(var o=[],i=a;;){var l=u(i);if(t(l))return o;var f=e(l);o.push(n(f)),i=r(f)}}}}}}};var ms=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){for(var o=[],i=a;;){var l=u(i);o.push(n(l));var f=r(l);if(t(f))return o;i=e(f)}}}}}}};var F_=Oe();var Al={unfoldr1:ms(Rn)(F_)(on)(rn)};var T_=Oe(),cn=function(t){return t.unfoldr};var Ul={unfoldr:vs(Rn)(T_)(on)(rn),Unfoldable10:function(){return Al}};var C_=q(He);var ys=yo(Kf);var Ge=function(){return ys(M.create)}();var Ds=function(){return Pl(Xf)(s.create)(d.value)}();var $t=function(t){return function(e){return ss(Sl(e))(t)()}},Hl=yo(Qf),wo=function(t){return function(e){return t<=0?{before:[],after:e}:{before:Hl(0)(t)(e),after:Hl(t)(Lt(e))(e)}}};var ql=function(t){return[t]};var Ar=yo(Yf);var Ol=Mn(Jf);var Ve=function(){return $a(Vf)(s.create)(d.value)}();var Bl=function(t){return function(e){return function(n){var r=function(u){return Ds(t)(e(u))(n)};return Fe(d.value)(r)(Ve(n)(t))}}};var kl=function(t){return Mn(Gf)(kt(t))};var bo=function(){return $a(jf)(s.create)(d.value)}();var zl=function(t){var e=Y(t);return function(n){return bo(function(r){return e(r)(n)})}},Jl=function(t){var e=zl(t);return function(n){return function(r){return Rn(e(n)(r))}}};var Kn=function(t){return function(e){return C_([t])(e)}};var Fs=et(C(ia));var To=Mn(Zf);var ka=Mn(ts);var E_=Gn(pt)(we),M_=At(Kt),x_=mr($u()(da({reflectSymbol:function(){return"x"}})()(da({reflectSymbol:function(){return"y"}})()(Hu)(pa))(pa))),L_=zn(Tt)(pt);var Gl=function(t){var e=t.Applicative0(),n=y(e),r=t.Bind1().Apply0().Functor0(),u=v(r),a=M_(e),o=bn(r),i=xt(o),l=Ft(o),f=Zt(e);return{position:function(c){return n(c.position)},translate:function(c){return function(p){return n({layers:p.layers,dragOffset:p.dragOffset,position:ze(c)(p.position)})}},containsPoint:function(c){return function(p){return u(E_)(a(i(x_(c)(p.position)))(p.layers))}},draw:function(c){return function(p){return Rt(c)(function(){return Rl(c)({translateX:p.position.x,translateY:p.position.y})(),L_(function(){var h=Rt(c),w=l(c);return function(L){return h(w(L))}}())(Tn(p.layers))()})}},dragStart:function(c){return function(p){return n({layers:p.layers,position:p.position,dragOffset:new s(c)})}},drag:function(c){return function(p){return f(Gl(t))(p.dragOffset)(c)(p)}},dragEnd:function(c){return n({layers:c.layers,position:c.position,dragOffset:d.value})}}},Vl=function(t){return{layers:t,position:{x:0,y:0},dragOffset:d.value}};var Co=t=>t.width,Eo=t=>t.height;var Zn=t=>e=>()=>t.letterSpacing=e;var ws=function(t){return function(e){return function(n){return function(r){return Fl(t)(e)(n.x)(n.y)(r.width)(r.height)}}}};var jl=function(t){return{width:Co(t),height:Eo(t)}};var S_=re(vr()(gn({reflectSymbol:function(){return"scaleX"}})()(gn({reflectSymbol:function(){return"scaleY"}})()(pr)($e))($e))),P_=Ae(We),A_=v(dt);var bs=function(t){var e=y(t.Monad0().Applicative0());return{scale:function(n){return function(r){return e({image:r.image,position:r.position,composite:r.composite,dragOffset:r.dragOffset,scale:S_(n)(r.scale)})}}}},za=function(t){var e=t.Monad0(),n=e.Applicative0(),r=y(n),u=C(e.Bind1()),a=Wt(t),o=Zt(n);return{position:function(i){return r(i.position)},translate:function(i){return function(l){return r({image:l.image,scale:l.scale,composite:l.composite,dragOffset:l.dragOffset,position:ze(i)(l.position)})}},containsPoint:function(i){return function(l){return u(a(ae(l.image)))(function(f){if(f instanceof d)return r(!1);if(f instanceof s)return r(l.position.x<=i.x&&i.x<=l.position.x+Co(f.value0)*l.scale.scaleX&&l.position.y<=i.y&&i.y<=l.position.y+Eo(f.value0)*l.scale.scaleY);throw new Error("Failed pattern match at Template.Layer.Image (line 74, column 5 - line 80, column 90): "+[f.constructor.name])})}},dragStart:function(i){return function(l){return r({image:l.image,position:l.position,scale:l.scale,composite:l.composite,dragOffset:new s(i)})}},drag:function(i){return function(l){return o(za(t))(l.dragOffset)(i)(l)}},dragEnd:function(i){return r({image:i.image,position:i.position,scale:i.scale,composite:i.composite,dragOffset:d.value})},draw:function(i){return function(l){return function(){var c=ae(l.image)();if(c instanceof d)return void 0;if(c instanceof s)return Rt(i)(function(){return Af(i)(l.composite)(),ws(i)(c.value0)(l.position)(qf(l.scale)(jl(c.value0)))()})();throw new Error("Failed pattern match at Template.Layer.Image (line 88, column 5 - line 94, column 54): "+[c.constructor.name])}}}}},Ts=function(t){return function(e){return{image:e.image,position:e.position,composite:e.composite,dragOffset:e.dragOffset,scale:t}}},Yl=function(t){var e=Wt(t);return function(n){return function(r){return function(u){return function(a){return e(function(){var i=En(d.value)();return Tl(n)(function(){var l=et(Il)(i);return function(f){return l(tt(f))}}())(),{image:i,position:r,scale:u,composite:a,dragOffset:d.value}})}}}}},Cs=function(t){var e=Wt(t);return function(n){return function(r){return function(u){return e(function(){var o=En(d.value)();return{image:o,position:n,scale:r,composite:u,dragOffset:d.value}})}}}},Es=function(t){var e=t.Monad0(),n=P_(e.Bind1()),r=Wt(t),u=y(e.Applicative0());return function(a){return function(o){return n(r(Tl(a)(function(){var i=et(Il)(o.image);return function(l){return i(tt(l))}}())))(function(){return u(o)})}}},Ms=function(t){return t.scale},xs=function(t){var e=t.Monad0(),n=C(e.Bind1()),r=Wt(t),u=y(e.Applicative0());return function(a){return n(r(ae(a.image)))(function(o){return u(A_(jl)(o))})}};var tr=function(t){return t.throwError};var Ie=function(t){return t.lift};var k_=v(dt);var Ga=function(t){return t},xn=function(t){return t};var Ur={lift:function(t){var e=bf(t)(s.create);return function(n){return Ga(e(n))}}};var z_=function(t){var e=v(t);return{map:function(n){return function(r){return e(k_(n))(r)}}}},J_=function(t){return{Applicative0:function(){return xo(t)},Bind1:function(){return er(t)}}},er=function(t){var e=C(t.Bind1()),n=y(t.Applicative0());return{bind:function(r){return function(u){return e(r)(function(a){if(a instanceof d)return n(d.value);if(a instanceof s){var o=u(a.value0);return o}throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 55, column 11 - line 57, column 42): "+[a.constructor.name])})}},Apply0:function(){return Ws(t)}}},Ws=function(t){var e=z_(t.Bind1().Apply0().Functor0());return{apply:Xn(J_(t)),Functor0:function(){return e}}},xo=function(t){return{pure:function(){var e=y(t.Applicative0());return function(n){return Ga(e(s.create(n)))}}(),Apply0:function(){return Ws(t)}}};var Hr=function(t){var e=y(t.Applicative0());return function(n){return Ga(e(n))}};var G_=Ie(Ur);var Us=function(t){var e=C(er(t)),n=Hr(t),r=G_(t);return function(u){return function(a){return function(o){return e(n(Ve(o)(u)))(function(i){return e(r(a(i)))(function(l){return n(Bl(u)(tt(l))(o))})})}}}};var ei=function(t){return Ge(Ol(0)(Lt(t)))(t)};var V_=At(Kt),j_=Gn(pt)(we),X_=zn(Tt)(pt),Y_=Ie(Ur),Q_=G(Q);var $s=function(t){var e=t.Applicative0(),n=t.Bind1().Apply0().Functor0(),r=fe(n),u=V_(e),a=bn(n),o=yt(a),i=v(n),l=xt(a),f=Ft(a),c=C(er(t)),p=Y_(t),m=Hr(t),h=Dt(a),w=Us(t),L=Ut(a),W=y(xo(t)),J=te(a),ft=Ht(a);return{position:tt(y(e)({x:0,y:0})),translate:function($){return function(Z){return r(u(o($))(Z.layers))(function(mt){return{dragIndex:Z.dragIndex,layers:mt}})}},containsPoint:function($){return function(Z){return i(j_)(u(l($))(Z.layers))}},draw:function($){return function(Z){return X_(function(){var mt=Rt($),jt=f($);return function(Ze){return mt(jt(Ze))}}())(Tn(Z.layers))}},dragStart:function($){return function(Z){return i(Qt(Z))(xn(c(p(u(l({x:$.offsetX,y:$.offsetY}))(Z.layers)))(function(mt){return c(m(bo(Q_)(mt)))(function(jt){return c(m(Ve(Z.layers)(jt)))(function(Ze){return c(p(h(Ze)))(function(qn){return c(w(jt)(L({offsetX:$.offsetX-qn.x,offsetY:$.offsetY-qn.y}))(Z.layers))(function(sr){return W({dragIndex:new s(jt),layers:sr})})})})})})))}},drag:function($){return function(Z){return i(Qt(Z))(xn(c(m(Z.dragIndex))(function(mt){return c(m(Ve(Z.layers)(mt)))(function(jt){return c(p(h(jt)))(function(Ze){return c(w(mt)(J({translateX:$.translateX-Ze.x,translateY:$.translateY-Ze.y}))(Z.layers))(function(qn){return W({dragIndex:Z.dragIndex,layers:qn})})})})})))}},dragEnd:function($){return i(Qt({layers:$.layers,dragIndex:d.value}))(xn(c(m($.dragIndex))(function(Z){return c(w(Z)(ft)($.layers))(function(mt){return W({dragIndex:d.value,layers:mt})})})))}}},Lo=function(t){return{layers:t,dragIndex:d.value}};var ni=function(t){var e=y(t),n=Zt(t);return{position:function(r){return e({x:r.rect.x,y:r.rect.y})},translate:function(r){return function(u){return e({fillStyle:u.fillStyle,dragOffset:u.dragOffset,rect:{width:u.rect.width,height:u.rect.height,x:u.rect.x+r.translateX,y:u.rect.y+r.translateY}})}},containsPoint:function(r){return function(u){return e(u.rect.x<=r.x&&r.x<=u.rect.x+u.rect.width&&u.rect.y<=r.y&&r.y<=u.rect.y+u.rect.height)}},draw:function(r){return function(u){return function(){return Me(r)(u.fillStyle)(),Uf(r)(gl(r)(u.rect))()}}},dragStart:function(r){return function(u){return e({rect:u.rect,fillStyle:u.fillStyle,dragOffset:new s(r)})}},drag:function(r){return function(u){return n(ni(t))(u.dragOffset)(r)(u)}},dragEnd:function(r){return e({rect:r.rect,fillStyle:r.fillStyle,dragOffset:d.value})}}},ri=function(t){return function(e){return{rect:t,fillStyle:e,dragOffset:d.value}}};var tg=Ae(We),oi=function(t){var e=t.Monad0(),n=e.Bind1(),r=C(n),u=Wt(t),a=tg(n),o=y(e.Applicative0());return function(i){return function(l){return r(u(ae(l)))(function(f){return r(i(f))(function(c){return a(u(Sr(c)(l)))(function(){return o(c)})})})}}},qs=function(t){var e=tn(t.Monad0().Bind1().Apply0().Functor0()),n=oi(t);return function(r){return function(u){return e(void 0)(n(r)(u))}}};var ng=he(Fn),rg=function(t){return t};var Io=function(t){var e=t.Monad0().Bind1(),n=he(e),r=Wt(t),u=tn(e.Apply0().Functor0()),a=oi(t);return function(o){var i=Dt(o),l=yt(o),f=xt(o),c=Ut(o),p=te(o),m=Ht(o),h=Ft(o);return{position:function(w){return n(i)(r(ae(w)))},translate:function(w){return function(L){return u(L)(a(l(w))(L))}},containsPoint:function(w){return function(L){return n(f(w))(r(ae(L)))}},dragStart:function(w){return function(L){return u(L)(a(c(w))(L))}},drag:function(w){return function(L){return u(L)(a(p(w))(L))}},dragEnd:function(w){return u(w)(a(m)(w))},draw:function(w){return function(L){return ng(h(w))(ae(L))}}}}};var Os=function(t){var e=qs(t);return function(n){return function(r){return e(n)(r)}}};var og=function(t){var e=Wt(t);return function(n){return function(r){return e(Ll(n)(r))}}},Bs=function(t){var e=tn(t.Monad0().Bind1().Apply0().Functor0()),n=og(t);return function(r){return function(u){return e(void 0)(n(r)(u))}}},ja=function(t){var e=v(t.Monad0().Bind1().Apply0().Functor0()),n=Wt(t);return function(r){return e(rg)(n(En(r)))}};var ag={mapLayerWrapper:function(t){return function(e){var n=fe(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(r(u.layer))(function(a){return{offset:u.offset,color:u.color,blur:u.blur,layer:a}})}}}}},ug=un(ag),zs=function(t){var e=Dt(t),n=ug(t),r=yt(t),u=xt(t),a=Ut(t),o=te(t),i=Ht(t),l=Ft(t);return function(f){var c=n(f);return{position:function(p){return e(p.layer)},translate:function(p){return c(r(p))},containsPoint:function(p){return function(m){return u(p)(m.layer)}},dragStart:function(p){return c(a(p))},drag:function(p){return c(o(p))},dragEnd:c(i),draw:function(p){return function(m){return Rt(p)(function(){return dl(p)(m.blur)(),pl(p)(m.offset.offsetX)(),vl(p)(m.offset.offsetY)(),sl(p)(m.color)(),l(p)(m.layer)()})}}}}};var ai=function(t){return function(e){return{layer:e.layer,offset:e.offset,blur:e.blur,color:t}}},ui=function(t){return function(e){return function(n){return function(r){return{layer:r,offset:t,color:e,blur:n}}}}};var ig={mapLayerWrapper:function(t){return function(e){var n=fe(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(r(u.layer))(function(a){return{offsetY:u.offsetY,gridSizeY:u.gridSizeY,layer:a}})}}}}},cg=un(ig),fg={mapLayerWrapper:function(t){return function(e){var n=fe(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(r(u.layer))(function(a){return{offsetX:u.offsetX,gridSizeX:u.gridSizeX,layer:a}})}}}}},sg=un(fg);var li=function(t){return function(e){return function(n){return{layer:n,gridSizeY:e,offsetY:t}}}},Js=function(t){return function(e){return function(n){return{layer:n,gridSizeX:e,offsetX:t}}}};var dg=function(t){var e=Dt(t),n=te(t);return function(r){var u=C(r.Bind1());return function(a){return function(o){return function(i){return function(l){return u(e(l))(function(f){var c=a+o*Ir((f.y+i.translateY-a)/o);return n({translateX:i.translateX,translateY:c-f.y})(l)})}}}}}},Gs=function(t){var e=Dt(t),n=cg(t),r=yt(t),u=xt(t),a=Ut(t),o=dg(t),i=Ht(t),l=Ft(t);return function(f){var c=n(f),p=o(f);return{position:function(m){return e(m.layer)},translate:function(m){return c(r(m))},containsPoint:function(m){return function(h){return u(m)(h.layer)}},dragStart:function(m){return c(a(m))},drag:function(m){return function(h){return c(p(h.offsetY)(h.gridSizeY)(m))(h)}},dragEnd:c(i),draw:function(m){return function(h){return l(m)(h.layer)}}}}},pg=function(t){var e=Dt(t),n=te(t);return function(r){var u=C(r.Bind1());return function(a){return function(o){return function(i){return function(l){return u(e(l))(function(f){var c=a+o*Ir((f.x+i.translateX-a)/o);return n({translateX:c-f.x,translateY:i.translateY})(l)})}}}}}},Vs=function(t){var e=Dt(t),n=sg(t),r=yt(t),u=xt(t),a=Ut(t),o=pg(t),i=Ht(t),l=Ft(t);return function(f){var c=n(f),p=o(f);return{position:function(m){return e(m.layer)},translate:function(m){return c(r(m))},containsPoint:function(m){return function(h){return u(m)(h.layer)}},dragStart:function(m){return c(a(m))},drag:function(m){return function(h){return c(p(h.offsetX)(h.gridSizeX)(m))(h)}},dragEnd:c(i),draw:function(m){return function(h){return l(m)(h.layer)}}}}};var lt=function(t){return t};function js(t){return t.split(/\r\n|[\n\v\f\r\u0085\u2028\u2029]/)}function Xs(t){return t.split(/[\u000a-\u000d\u0085\u2028\u2029\u0009\u0020\u00a0\u1680\u2000-\u200a\u202f\u205f\u3000]+/)}var mF=typeof Array.from=="function",Rg=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",_F=typeof String.prototype.fromCodePoint=="function",yg=typeof String.prototype.codePointAt=="function",Ys=function(t){return yg?function(e){return e.codePointAt(0)}:t},Qs=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){var o=a.length;if(u<0||u>=o)return n;if(Rg)for(var i=a[Symbol.iterator](),l=u;;--l){var f=i.next();if(f.done)return n;if(l===0)return e(r(f.value))}return t(u)(a)}}}}}};function In(t){return t.charCodeAt(0)}function Ks(t){return String.fromCharCode(t)}var ed=hn(to),nd=en(to);var sn=function(t){return t.toEnum};var Nn=function(t){return t.fromEnum};var nr=function(t){return function(e){return function(n){return t(e(n)+1|0)}}},rr=function(t){return function(e){return function(n){return t(e(n)-1|0)}}};var ii=function(t){return t>=In(ed)&&t<=In(nd)?new s(Ks(t)):d.value},Eg={succ:nr(ii)(In),pred:rr(ii)(In),Ord0:function(){return va}};var So=function(){return{cardinality:In(nd)-In(ed)|0,toEnum:ii,fromEnum:In,Bounded0:function(){return to},Enum1:function(){return Eg}}}();var ci=function(t){return t.join("")};var Sn=function(t){return t.length};var or=function(t){return function(e){return e.substring(t)}};var Pn=function(t){return function(e){if(t>=0&&t<e.length)return e.charAt(t);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var Pg=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}},Po=Nn(So);var Ag=z(ve);var ad=function(t){return function(e){return(((t-55296|0)*1024|0)+(e-56320|0)|0)+65536|0}};var ud=function(t){return 56320<=t&&t<=57343},ld=function(t){return 55296<=t&&t<=56319},Xa=function(t){var e=Sn(t);if(e===0)return d.value;if(e===1)return new s({head:Po(Pn(0)(t)),tail:""});var n=Po(Pn(1)(t)),r=Po(Pn(0)(t)),u=ld(r)&&ud(n);return u?new s({head:ad(r)(n),tail:or(2)(t)}):new s({head:r,tail:or(1)(t)})};var Wg=function(t){var e=Po(Pn(0)(t)),n=ld(e)&&Sn(t)>1;if(n){var r=Po(Pn(1)(t)),u=ud(r);return u?ad(e)(r):e}return e},od=Ys(Wg);var si={eq:function(t){return function(e){return t===e}}},di={compare:function(t){return function(e){return Ag(t)(e)}},Eq0:function(){return si}};var Ug=function(t){return function(e){var n=t,r=!1,u;function a(o,i){var l=Xa(i);if(l instanceof s){var f=o===0;if(f)return r=!0,new s(l.value0.head);n=o-1|0,e=l.value0.tail;return}return r=!0,d.value}for(;!r;)u=a(n,e);return u}},id=function(t){return function(e){return t<0?d.value:t===0&&e===""?d.value:t===0?new s(od(e)):Qs(Ug)(s.create)(d.value)(od)(t)(e)}},Hg={bottom:0,top:1114111,Ord0:function(){return di}},ar=function(){return{cardinality:1114112,fromEnum:function(t){return t},toEnum:function(t){if(t>=0&&t<=1114111)return new s(t);if(qt)return d.value;throw new Error("Failed pattern match at Data.String.CodePoints (line 63, column 1 - line 68, column 26): "+[t.constructor.name])},Bounded0:function(){return Hg},Enum1:function(){return $g(0)}}}(),$g=Pg("enumCodePoint","Data.String.CodePoints",function(){return{succ:nr(sn(ar))(Nn(ar)),pred:rr(sn(ar))(Nn(ar)),Ord0:function(){return di}}});var Qa=function(t){return Xs(t)};var qr=function(t){return js(t)};var Ka=t=>e=>()=>t.measureText(e);var Za=At(Kt)(Tt),Qg=ht(pt),Kg=v(Nt),vd=v(A),Zg=io(Zr)(pt),sd=E(ma),th=lo(Tt)(pt);var tu=function(t){return function(e){return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,fontName:e.fontName,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:t}}};var Ao=function(t){return function(e){return function(){var r=Ka(t)(e)();return r.width}}},eh=function(t){return function(e){return function(n){var r=Qa(n);return function(){var a=Za(Ao(t))(r)(),o=Ao(t)(" ")(),i=function(c){return function(p){if(c.value1.value0.length===0)return new M(c.value0,new M([p.value0],p.value1));var m=c.value1.value1+o+p.value1>e;return m?new M($t(c.value0)(c.value1.value0),new M([p.value0],p.value1)):new M(c.value0,new M($t(c.value1.value0)(p.value0),c.value1.value1+o+p.value1))}},l=Qg(i)(new M([],new M([],0)))(Ge(r)(a)),f=Kg(Vn(" "))(l.value0);return l.value1.value0.length===0?f:$t(f)(Vn(" ")(l.value1.value0))}}}},dd=function(t){return function(e){return function(n){return vd(Cn)(Za(eh(t)(e))(qr(n)))}}},_i=function(t){return function(e){return function(){var r=Ka(t)(e)();return r.actualBoundingBoxAscent+r.actualBoundingBoxDescent}}};var pd=function(t){return function(e){return vd(function(){var n=Qt(0);return function(r){return n(Zg(r))}}())(Za(_i(t))(e))}},eu=function(t){var e=t.Monad0().Applicative0(),n=y(e),r=Wt(t),u=Zt(e);return{position:function(a){return n(a.position)},translate:function(a){return function(o){return n({text:o.text,maxWidth:o.maxWidth,fillStyle:o.fillStyle,fontName:o.fontName,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,letterSpacing:o.letterSpacing,dragOffset:o.dragOffset,context:o.context,position:ze(a)(o.position)})}},containsPoint:function(a){return function(o){return r(Rt(o.context)(function(){Me(o.context)(o.fillStyle)(),Tr(o.context)(o.fontStyle+(" "+(o.fontWeight+(" "+(sd(o.fontSize)+("px "+o.fontName))))))(),xr(o.context)(o.baseline)(),Lr(o.context)(o.align)(),Zn(o.context)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return dd(o.context)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return qr(o.text);throw new Error("Failed pattern match at Template.Layer.Text (line 70, column 14 - line 72, column 44): "+[o.maxWidth.constructor.name])}(),f=Za(Ao(o.context))(l)(),c=pd(o.context)(l)();return et(To)(ei(f))(function(p){var m=function(){return o.baseline instanceof be?o.position.y+c*o.lineHeight*lt(p.value0):o.baseline instanceof xe?o.position.y-c-lt((Lt(l)-p.value0|0)-1|0)*c*o.lineHeight:o.position.y+c*o.lineHeight*lt(p.value0)}();if(o.align instanceof Er||o.align instanceof oe)return o.position.x<=a.x&&a.x<=o.position.x+p.value1&&m<=a.y&&a.y<=m+c;if(o.align instanceof Mr||o.align instanceof wn)return o.position.x-p.value1<=a.x&&a.x<=o.position.x&&m<=a.y&&a.y<=m+c;if(o.align instanceof Cr)return o.position.x-p.value1/2<=a.x&&a.x<=o.position.x+p.value1/2&&m<=a.y&&a.y<=m+c;throw new Error("Failed pattern match at Template.Layer.Text (line 84, column 7 - line 99, column 41): "+[o.align.constructor.name])})}))}},dragStart:function(a){return function(o){return n({text:o.text,position:o.position,maxWidth:o.maxWidth,fillStyle:o.fillStyle,fontName:o.fontName,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,letterSpacing:o.letterSpacing,context:o.context,dragOffset:new s(a)})}},drag:function(a){return function(o){return u(eu(t))(o.dragOffset)(a)(o)}},dragEnd:function(a){return n({text:a.text,position:a.position,maxWidth:a.maxWidth,fillStyle:a.fillStyle,fontName:a.fontName,fontSize:a.fontSize,fontStyle:a.fontStyle,fontWeight:a.fontWeight,align:a.align,baseline:a.baseline,lineHeight:a.lineHeight,letterSpacing:a.letterSpacing,context:a.context,dragOffset:d.value})},draw:function(a){return function(o){return Rt(a)(function(){Me(a)(o.fillStyle)(),Tr(a)(o.fontStyle+(" "+(o.fontWeight+(" "+(sd(o.fontSize)+("px "+o.fontName))))))(),xr(a)(o.baseline)(),Lr(a)(o.align)(),Zn(a)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return dd(a)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return qr(o.text);throw new Error("Failed pattern match at Template.Layer.Text (line 112, column 14 - line 114, column 44): "+[o.maxWidth.constructor.name])}(),f=pd(a)(l)();return th(ei(l))(function(c){var p=function(){return o.baseline instanceof be?o.position.y+lt(c.value0)*f*o.lineHeight:o.baseline instanceof xe?o.position.y-lt((Lt(l)-c.value0|0)-1|0)*f*o.lineHeight:o.position.y+lt(c.value0)*f*o.lineHeight}();return go(a)(c.value1)(o.position.x)(p)})()})}}}};var md=function(t){return t};var sh=md;var hi=function(t){return t};var yd=function(t){if(Lt(t)>0)return new s(sh(t));if(qt)return d.value;throw new Error("Failed pattern match at Data.Array.NonEmpty (line 161, column 1 - line 161, column 58): "+[t.constructor.name])};var Br=function(t){var e=null;return function(){return t===void 0||(e=t(),t=void 0),e}},Ho=function(t){return t()};var Rh=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}};var yh=Bn();var dn=function(){function t(e,n,r){this.value0=e,this.value1=n,this.value2=r}return t.create=function(e){return function(n){return function(r){return new t(e,n,r)}}},t}(),pn=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var Dd=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),Fd=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),Di=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var wd={defer:function(t){var e=Br(t);return function(n,r,u,a,o){var i=Ho(e);return i(n,r,u,a,o)}}};var ur={map:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return e(n,r,u,a,function(l,f){return r(function(c){return o(l,t(f))})})})}}}};var An={alt:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return t(new dn(n.value0,n.value1,!1),r,u,function(l,f){return r(function(c){return l.value2?a(l,f):e(n,r,u,a,o)})},o)})}}},Functor0:function(){return ur}},Dh=function(t){return function(e,n,r,u,a){var o=t(e);return a(o.value1,o.value0)}};var Fh=function(t){var e=t.Monad0(),n=v(e.Bind1().Apply0().Functor0()),r=y(e.Applicative0()),u=ln(t);return function(a){return function(o){var i=function(l){var f=!1,c;function p(m){var h=m(void 0);if(h instanceof Dd){l=h.value0;return}if(h instanceof Fd)return f=!0,n(ue.create)(h.value0);if(h instanceof Di)return f=!0,r(new le(new M(h.value1,h.value0)));throw new Error("Failed pattern match at Parsing (line 160, column 13 - line 166, column 32): "+[h.constructor.name])}for(;!f;)c=p(l);return c};return u(i)(function(l){return o(a,Dd.create,Fd.create,function(f,c){return new Di(f,new wt(c))},function(f,c){return new Di(f,new _t(c))})})}}},bd=Dh(function(t){return new M(t.value1,t)});var wh={index:0,line:1,column:1},bh=function(t){var e=v(t.Monad0().Bind1().Apply0().Functor0()),n=Fh(t);return function(r){return function(u){var a=new dn(r,wh,!1);return e(on)(n(a)(u))}}},Th=bh(rs),Td=function(t){var e=Th(t);return function(n){return yh(e(n))}};var ru=function(t){return function(e){return t.value2&&!e.value2?new dn(e.value0,e.value1,!0):e}},Wn={apply:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return t(n,r,u,a,function(l,f){return r(function(c){var p=ru(n)(l);return e(p,r,u,a,function(m,h){return r(function(w){return o(ru(p)(m),f(h))})})})})})}}},Functor0:function(){return ur}};var kr={pure:function(t){return function(e,n,r,u,a){return a(e,t)}},Apply0:function(){return Wn}};var lr={bind:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return t(n,r,u,a,function(l,f){return r(function(c){var p=e(f);return p(ru(n)(l),r,u,a,o)})})})}}},Apply0:function(){return Wn}},Ch=he(lr);var Cd={Applicative0:function(){return kr},Bind1:function(){return lr}};var wi={throwError:function(t){return function(e,n,r,u,a){return u(e,t)}},Monad0:function(){return Cd}},Eh=tr(wi),Mh=function(t){return function(e){return Eh(new pn(t,e))}},zr=function(t){return Ch(Mh(t))(bd)};var ou={tailRecM:function(t){return function(e){return function(n,r,u,a,o){var i=Rh("loop","Parsing",function(){return function(f,c,p){var m=t(c);return m(f,r,u,a,function(h,w){var L=ru(f)(h);if(w instanceof ue){var W=p===0;return W?r(function(J){return i(288)(L,w.value0,30)}):i(290)(L,w.value0,p-1|0)}if(w instanceof le)return o(L,w.value0);throw new Error("Failed pattern match at Parsing (line 284, column 19 - line 292, column 46): "+[w.constructor.name])})}}),l=i(279);return l(n,e,30)}}},Monad0:function(){return Cd}};var je=function(){function t(){}return t.value=new t,t}(),Xe=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var Jr={foldr:function(t){return function(e){var n=function(){var u=function(a){return function(o){var i=a,l=!1,f;function c(p,m){if(m instanceof je)return l=!0,p;if(m instanceof Xe){i=new Xe(m.value0,p),o=m.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[p.constructor.name,m.constructor.name])}for(;!l;)f=c(i,o);return f}};return u(je.value)}(),r=ht(Jr)(et(t))(e);return function(u){return r(n(u))}}},foldl:function(t){var e=function(n){return function(r){var u=n,a=!1,o;function i(l,f){if(f instanceof je)return a=!0,l;if(f instanceof Xe){u=t(l)(f.value0),r=f.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[f.constructor.name])}for(;!a;)o=i(u,r);return o}};return e},foldMap:function(t){var e=q(t.Semigroup0()),n=gt(t);return function(r){return ht(Jr)(function(u){var a=e(u);return function(o){return a(r(o))}})(n)}}};var Sd=Et(An),o0=On(wd);var a0=se(Wn);var u0=fc(Wn);var Pd=function(t){return function(e){return Sd(t)(o0(function(n){return zr("Expected "+e(void 0))}))}},bi=function(t){return function(e){return Sd(t)(zr("Expected "+e))}};var Gr=function(t){return function(e,n,r,u,a){return t(e,n,r,function(o,i){return u(new dn(o.value0,o.value1,e.value2),i)},a)}};var Oo=function(t){return function(e){return function(n){return u0(a0(t)(n))(e)}}};var Ci=C(lr),l0=ln(ou),i0=Et(An),au=y(kr),c0=kl(Jr);var f0=function(t){return Ci(et(l0)(je.value)(function(e){return i0(Ci(t)(function(n){return au(new ue(new Xe(n,e)))}))(au(new le(e)))}))(function(e){return au(Tn(c0(e)))})},Ei=function(t){return Ci(f0(t))(function(e){var n=yd(e);if(n instanceof d)return zr("Expected at least 1");if(n instanceof s)return au(n.value0);throw new Error("Failed pattern match at Parsing.Combinators.Array (line 55, column 3 - line 57, column 25): "+[n.constructor.name])})};var Mi=Nn(ar),d0=ro(ya),p0=Oe(),v0=sn(So);var m0=E(_a);var xi=function(t){return function(e){return function(n){var r=Mi(e);if(r===10)return{index:t.index+1|0,line:t.line+1|0,column:1};if(r===13){var u=id(0)(n);return u instanceof s&&Mi(u.value0)===10?{index:t.index+1|0,line:t.line,column:t.column}:{index:t.index+1|0,line:t.line+1|0,column:1}}return r===9?{index:t.index+1|0,line:t.line,column:(t.column+8|0)-d0(t.column-1|0)(8)|0}:{index:t.index+1|0,line:t.line,column:t.column+1|0}}}},_0=function(t){return function(e){return function(n){var r=t,u=e,a=!1,o;function i(l,f,c){var p=Xa(f);if(p instanceof d)return a=!0,l;if(p instanceof s){var m=function(){if(wr(p.value0.tail))return xi(l)(p.value0.head)(c);if(qt)return xi(l)(p.value0.head)(p.value0.tail);throw new Error("Failed pattern match at Parsing.String (line 165, column 7 - line 167, column 52): ")}();r=m,u=p.value0.tail,n=c;return}throw new Error("Failed pattern match at Parsing.String (line 161, column 36 - line 168, column 38): "+[p.constructor.name])}for(;!a;)o=i(r,u,n);return o}}};var Li=function(t){return Ro(function(e){return function(n){return function(r){return function(u){return function(a){var o=Xa(e.value0);if(o instanceof d)return u(e,new pn("Unexpected EOF",e.value1));if(o instanceof s){var i=Mi(o.value0.head),l=i<0||i>65535;if(l)return u(e,new pn("Expected Char",e.value1));var f=p0(v0(i)),c=t(f);return c?a(new dn(o.value0.tail,xi(e.value1)(o.value0.head)(o.value0.tail),!0),f):u(e,new pn("Predicate unsatisfied",e.value1))}throw new Error("Failed pattern match at Parsing.String (line 114, column 7 - line 129, column 75): "+[o.constructor.name])}}}}})};var Ii=Ro(function(t){return function(e){return function(n){return function(r){return function(u){var a=wr(t.value0);return a?u(new dn(t.value0,t.value1,!0),void 0):r(t,new pn("Expected EOF",t.value1))}}}}}),Wd=function(t){return Ro(function(e){return function(n){return function(r){return function(u){return function(a){var o=t(e.value0);if(o instanceof wt)return u(e,new pn(o.value0,e.value1));if(o instanceof _t)return a(new dn(o.value0.remainder,_0(e.value1)(o.value0.consumed)(o.value0.remainder),!wr(o.value0.consumed)),o.value0.value);throw new Error("Failed pattern match at Parsing.String (line 286, column 7 - line 290, column 121): "+[o.constructor.name])}}}}})};var Ni=Wd(function(t){return new _t({value:t,consumed:t,remainder:""})});var _e=function(t){return bi(Li(function(e){return e===t}))(m0(t))};var w0=E(Ou(_a));var b0=Jl(fa);var $d=function(t){return Pd(Li(et(b0)(t)))(function(e){return"none of "+w0(t)})};function uu(t,e){var n={};for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r]);for(var u in t)({}).hasOwnProperty.call(t,u)&&(n[u]=t[u]);return n}var lu=function(){return function(){return function(t){return function(e){return uu(t,e)}}}};var M0=E(ma),iu=q(He),Bo=fe(Nt),Gd=ht(pt),Ai=v(A),x0=io(Zr)(pt),ir=At(Kt)(Tt),cu=Zu(pt)($e),Ye=v(Nt),L0=y(Tt),I0=v(dt),Te=v(ur),Qe=Et(An),du=se(Wn),N0=lu()(),S0=yf(Tt)(Kt),P0=G(Q),Si=lo(Tt)(pt),Vd=tn(ur);var pu=function(){function t(){}return t.value=new t,t}(),jd=function(){function t(){}return t.value=new t,t}(),vu=function(){function t(){}return t.value=new t,t}(),Xd=function(){function t(){}return t.value=new t,t}();var Yd=function(t){return t.text},A0=function(t){return function(e){return function(n){return{line:$t(e.line)(n),width:e.width+t+n.width}}}},Wi=function(t){return function(e){return function(n){var r=function(){if(n.weight instanceof pu)return e.weight.normal;if(n.weight instanceof jd)return e.weight.bold;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 295, column 14 - line 297, column 37): "+[n.weight.constructor.name])}(),u=function(){if(n.style instanceof vu)return e.style.normal;if(n.style instanceof Xd)return e.style.italic;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 292, column 13 - line 294, column 39): "+[n.style.constructor.name])}();return Tr(t)(u+(" "+(r+(" "+(M0(e.size)+("px "+e.name))))))}}},Qd=function(t){return function(e){return{text:e.text,position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,font:{name:e.font.name,style:e.font.style,weight:e.font.weight,size:t}}}},W0=function(t){return wr(Yd(t.fragment))},U0=function(t){return ka(W0)(t.word)},H0=function(t){return ka(U0)(t.line)};var Kd=function(t){return function(e){var n=function(u){return function(a){var o=wo(1)(t(a.text));if(o.before.length===1&&o.before[0]===""&&o.after.length===0)return{splits:u.splits,split:u.split};if(o.before.length===1&&o.after.length===0)return{splits:u.splits,split:$t(u.split)({style:a.style,weight:a.weight,text:o.before[0]})};if(o.before.length===1&&o.before[0]===""){var i=wo(Lt(o.after)-1|0)(o.after);return i.after.length===1&&i.after[0]===""?{splits:iu($t(u.splits)(u.split))(Bo(i.before)(function(l){return[{style:a.style,weight:a.weight,text:l}]})),split:[]}:i.after.length===1?{splits:iu($t(u.splits)(u.split))(Bo(i.before)(function(l){return[{style:a.style,weight:a.weight,text:l}]})),split:[{style:a.style,weight:a.weight,text:i.after[0]}]}:{splits:u.splits,split:u.split}}if(o.before.length===1){var i=wo(Lt(o.after)-1|0)(o.after);return i.after.length===1&&i.after[0]===""?{splits:iu($t(u.splits)($t(u.split)({style:a.style,weight:a.weight,text:o.before[0]})))(Bo(i.before)(function(f){return[{style:a.style,weight:a.weight,text:f}]})),split:[]}:i.after.length===1?{splits:iu($t(u.splits)($t(u.split)({style:a.style,weight:a.weight,text:o.before[0]})))(Bo(i.before)(function(f){return[{style:a.style,weight:a.weight,text:f}]})),split:[{style:a.style,weight:a.weight,text:i.after[0]}]}:{splits:u.splits,split:u.split}}return{splits:u.splits,split:u.split}}},r=Gd(n)({splits:[],split:[]})(e);return $t(r.splits)(r.split)}},Zd=Kd(Qa),Ui=function(t){return{text:t,style:vu.value,weight:pu.value}};var $0=function(t){return function(e){return{fragment:t,width:e}}},tp=function(t){return function(e){return function(n){return Rt(t)(function(){return Wi(t)(e)(n)(),Ao(t)(n.text)()})}}},Hi=function(t){return function(e){return tp(t)(e)({style:vu.value,weight:pu.value,text:" "})}},q0=function(t){return function(e){return function(n){return Rt(t)(function(){return Wi(t)(e)(n)(),_i(t)(n.text)()})}}},O0=function(t){return function(e){return function(n){return Ai(function(){var r=Qt(0);return function(u){return r(x0(u))}}())(ir(q0(t)(e))(n))}}},B0=function(t){return function(e){return function(n){return Ai($0(n))(tp(t)(e)(n))}}},ep=function(t){return function(e){return function(n){return function(){var u=ir(B0(t)(e))(n)(),a=cu(Ye(function(o){return o.width})(u));return{word:u,width:a}}}}},Od=function(t){return function(e){return function(n){var r=Zd(n);return function(){var a=ir(ep(t)(e))(r)(),o=Hi(t)(e)(),i=o*lt(Lt(a)-1|0)+cu(Ye(function(l){return l.width})(a));return{line:a,width:i}}}}},k0=function(t){return function(e){return function(n){return function(r){var u=Zd(r);return function(){var o=ir(ep(t)(e))(u)(),i=Hi(t)(e)(),l=function(c){return function(p){if(c.value1.line.length===0)return new M(c.value0,{line:[p],width:p.width});var m=c.value1.width+i+p.width>n;return m?new M($t(c.value0)(c.value1),{line:[p],width:p.width}):new M(c.value0,A0(i)(c.value1)(p))}},f=Gd(l)(new M([],{line:[],width:0}))(o);return f.value1.line.length===0?f.value0:$t(f.value0)(f.value1)}}}}},$i=function(t){return function(e){return{text:e.text,position:e.position,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,maxWidth:I0(t)(e.maxWidth)}}},ko=function(){var t=Te(hi);return function(e){return t(Ei(e))}}(),zo=Te(function(t){return Ui(ci(t))})(ko($d(["_","*"]))),Pi=Kd(qr),Bd=function(t){return function(e){return function(n){return function(r){return Ai(Cn)(ir(k0(t)(e)(n))(Pi(r)))}}}},fu=function(t){return{text:t.text,weight:t.weight,style:Xd.value}},kd=Qe(Gr(Oo(_e("_"))(_e("_"))(Te(fu)(zo))))(Qe(zo)(du(_e("_"))(Te(function(t){return fu(Ui(t))})(Ni)))),z0=function(t){return t.fragment},J0=function(t){return Ye(z0)(t.word)},G0=function(t){return Ye(J0)(t.line)},zd=function(t){return function(e){return function(n){return function(r){return function(){var a=O0(t)(e)(Cn(Fs(G0)(r)))();return Bo(r)(function(o){return N0(o)({height:function(){var i=H0(o);return i?n*e.size:a}()})})}}}}},mu=function(t){var e=t.Monad0().Applicative0(),n=y(e),r=Wt(t),u=Zt(e);return{position:function(a){return n(a.position)},translate:function(a){return function(o){return n({text:o.text,maxWidth:o.maxWidth,fillStyle:o.fillStyle,font:o.font,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,emptyLineHeight:o.emptyLineHeight,letterSpacing:o.letterSpacing,dragOffset:o.dragOffset,context:o.context,position:ze(a)(o.position)})}},containsPoint:function(a){return function(o){return r(Rt(o.context)(function(){Me(o.context)(o.fillStyle)(),xr(o.context)(o.baseline)(),Lr(o.context)(o.align)(),Zn(o.context)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return Bd(o.context)(o.font)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return ir(Od(o.context)(o.font))(Pi(o.text))();throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 199, column 15 - line 201, column 89): "+[o.maxWidth.constructor.name])}(),f=zd(o.context)(o.font)(o.emptyLineHeight)(l)(),c=cu(Ye(function(h){return h.height})(f))+(o.lineHeight-1)*o.font.size*lt(Lt(f)-1|0),p=Kn(0)(Ar(function(h){return function(w){return h+w.height+(o.lineHeight-1)*o.font.size}})(0)(f)),m=S0(Ge(f)(p))(function(h){var w=function(){return o.baseline instanceof be?o.position.y+h.value1:o.baseline instanceof xe?o.position.y+h.value1-c:o.position.y+h.value1}();return L0(function(){if(o.align instanceof Er||o.align instanceof oe)return o.position.x<=a.x&&a.x<=o.position.x+h.value0.width&&w<=a.y&&a.y<=w+h.value0.height;if(o.align instanceof Mr||o.align instanceof wn)return o.position.x-h.value0.width<=a.x&&a.x<=o.position.x&&w<=a.y&&a.y<=w+h.value0.height;if(o.align instanceof Cr)return o.position.x-h.value0.width/2<=a.x&&a.x<=o.position.x+h.value0.width/2&&w<=a.y&&a.y<=w+h.value0.height;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 217, column 14 - line 237, column 33): "+[o.align.constructor.name])}())})();return To(P0)(m)}))}},dragStart:function(a){return function(o){return n({text:o.text,position:o.position,maxWidth:o.maxWidth,fillStyle:o.fillStyle,font:o.font,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,emptyLineHeight:o.emptyLineHeight,letterSpacing:o.letterSpacing,context:o.context,dragOffset:new s(a)})}},drag:function(a){return function(o){return u(mu(t))(o.dragOffset)(a)(o)}},dragEnd:function(a){return n({text:a.text,position:a.position,maxWidth:a.maxWidth,fillStyle:a.fillStyle,font:a.font,align:a.align,baseline:a.baseline,lineHeight:a.lineHeight,emptyLineHeight:a.emptyLineHeight,letterSpacing:a.letterSpacing,context:a.context,dragOffset:d.value})},draw:function(a){return function(o){return Rt(a)(function(){Me(a)(o.fillStyle)(),xr(a)(o.baseline)(),Lr(a)(oe.value)(),Zn(a)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return Bd(a)(o.font)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return ir(Od(a)(o.font))(Pi(o.text))();throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 252, column 15 - line 254, column 83): "+[o.maxWidth.constructor.name])}(),f=zd(a)(o.font)(o.emptyLineHeight)(l)(),c=cu(Ye(function(m){return m.height})(f))+(o.lineHeight-1)*o.font.size*lt(Lt(f)-1|0),p=Kn(0)(Ar(function(m){return function(h){return m+h.height+(o.lineHeight-1)*o.font.size}})(0)(f));return Si(Ge(f)(p))(function(m){var h=function(){return o.baseline instanceof be?o.position.y+m.value1:o.baseline instanceof xe?o.position.y+m.value1-c+m.value0.height:o.position.y+m.value1}(),w=function(){if(o.align instanceof Er||o.align instanceof oe)return o.position.x;if(o.align instanceof Mr||o.align instanceof wn)return o.position.x-m.value0.width;if(o.align instanceof Cr)return o.position.x-m.value0.width/2;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 273, column 16 - line 278, column 57): "+[o.align.constructor.name])}();return function(){var W=Hi(a)(o.font)(),J=Kn(0)(Ar(function(ft){return function($){return ft+W+$.width}})(0)(m.value0.line));return Si(Ge(m.value0.line)(J))(function(ft){var $=Kn(0)(Ar(function(Z){return function(mt){return Z+mt.width}})(0)(ft.value0.word));return Si(Ge(ft.value0.word)($))(function(Z){return function(){return Wi(a)(o.font)(Z.value0.fragment)(),go(a)(Yd(Z.value0.fragment))(w+ft.value1+Z.value1)(h)()}})})()}})()})}}}},su=function(t){return{text:t.text,style:t.style,weight:jd.value}},V0=Qe(Gr(Oo(_e("*"))(_e("*"))(Te(Ye(su))(ko(kd)))))(du(_e("*"))(Qe(Vd([])(Ii))(Te(Ye(su))(ko(kd))))),Jd=Qe(Gr(Oo(_e("*"))(_e("*"))(Te(su)(zo))))(Qe(zo)(du(_e("*"))(Te(function(t){return su(Ui(t))})(Ni)))),j0=Qe(Gr(Oo(_e("_"))(_e("_"))(Te(Ye(fu))(ko(Jd)))))(du(_e("_"))(Qe(Vd([])(Ii))(Te(Ye(fu))(ko(Jd))))),X0=Te(function(t){return Cn(hi(t))})(Ei(Qe(j0)(Qe(V0)(Te(ql)(zo)))));var Jo=function(t){return function(e){var n=Td(t)(X0);if(n instanceof _t)return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:n.value0};if(n instanceof wt)return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:[{text:t,style:vu.value,weight:pu.value}]};throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 177, column 37 - line 179, column 106): "+[n.constructor.name])}};var rp=function(t){return t},op=function(t){return t},ap=function(t){return t},Y0={mapLayerWrapper:function(t){return function(e){var n=v(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(rp)(r(u))}}}}},Q0=un(Y0);var K0={mapLayerWrapper:function(t){return function(e){var n=v(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(op)(r(u))}}}}},Z0=un(K0);var tR={mapLayerWrapper:function(t){return function(e){var n=v(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(ap)(r(u))}}}}},eR=un(tR);var up=function(t){return function(e){var n=Dt(e),r=Q0(e)(t),u=xt(e),a=Ut(e),o=te(e),i=Ft(e);return{position:function(l){return n(l)},translate:function(){var l=yt(e);return function(f){return r(l(f))}}(),containsPoint:function(l){return function(f){return u(l)(f)}},dragStart:function(l){return r(a({offsetX:l.offsetX,offsetY:0}))},drag:function(l){return r(o({translateX:l.translateX,translateY:0}))},dragEnd:r(Ht(e)),draw:function(l){return function(f){return i(l)(f)}}}}},lp=function(t){return function(e){var n=Dt(e),r=Z0(e)(t),u=xt(e),a=Ut(e),o=te(e),i=Ft(e);return{position:function(l){return n(l)},translate:function(){var l=yt(e);return function(f){return r(l(f))}}(),containsPoint:function(l){return function(f){return u(l)(f)}},dragStart:function(l){return r(a({offsetX:0,offsetY:l.offsetY}))},drag:function(l){return r(o({translateX:0,translateY:l.translateY}))},dragEnd:r(Ht(e)),draw:function(l){return function(f){return i(l)(f)}}}}},ip=function(t){var e=y(t.Applicative0());return function(n){var r=Dt(n),u=xt(n),a=Ft(n);return{position:function(o){return r(o)},translate:function(){var o=eR(n)(t),i=yt(n);return function(l){return o(i(l))}}(),containsPoint:function(o){return function(i){return u(o)(i)}},dragStart:tt(e),drag:tt(e),dragEnd:e,draw:function(o){return function(i){return a(o)(i)}}}}};var cp=rp,qi=op,Un=ap;var cr=function(t){return function(e){return function(){return e[t]}}},rR=cr("URL"),oR=cr("documentURI"),aR=cr("origin"),uR=cr("compatMode"),lR=cr("characterSet"),iR=cr("contentType");var cR=cr("documentElement");function Go(t){return function(e){return function(){return e.createElement(t)}}}function fp(t,e,n){return t==null?e:n(t)}var at=function(t){return fp(t,d.value,s.create)};function sp(t,e,n,r){if(typeof window<"u"){var u=window[n];if(u!=null&&r instanceof u)return e(r)}for(var a=r;a!=null;){var o=Object.getPrototypeOf(a),i=o.constructor.name;if(i===n)return e(r);if(i==="Object")return t;a=o}return t}var F=function(t){return function(e){return sp(d.value,s.create,t,e)}};var _u=function(t){return function(e){return e[t]}},_R=_u("namespaceURI"),gR=_u("prefix"),hR=_u("localName"),RR=_u("tagName");function fr(t){return function(e){return function(n){return function(){n.setAttribute(t,e)}}}}function Oi(t){return function(){var e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}}var gu=function(t){return function(e){return function(){return e[t]}}},DR=gu("children"),FR=gu("firstElementChild"),wR=gu("lastElementChild"),bR=gu("childElementCount");var pp=_,ce=_;var Se=function(t){return function(e){return function(){return e[t]}}};var xR=Se("baseURI"),LR=Se("ownerDocument"),IR=Se("parentNode"),NR=Se("parentElement");var SR=Se("childNodes"),PR=Se("firstChild"),AR=Se("lastChild"),WR=Se("previousSibling"),UR=Se("nextSibling"),HR=Se("nodeValue");var $R=Se("textContent");function Bi(t){return function(e){return function(){e.appendChild(t)}}}function vp(t){return function(e){return function(){return e.getElementById(t)}}}var JR=v(A),vn=function(t){var e=JR(at),n=vp(t);return function(r){return e(n(r))}};function Gt(t){return function(){return function(e){return t(e)()}}}function Vt(t){return function(e){return function(n){return function(r){return function(){return r.addEventListener(t,e,n)}}}}}var mp=_;function _p(t){return function(e){return e.item(t)}}var t2=v(dt),e2=function(t){var e=_p(t);return function(n){return at(e(n))}},gp=function(t){var e=cn(t);return function(n){return e(function(r){return t2(et(M.create)(r+1|0))(e2(r)(n))})(0)}};function ki(t){return function(){return URL.createObjectURL(t)}}var zi=function(){return window};function hp(t){return t.body}var c2=v(A);var mn=_;var Rp=_,hu=_;var yp=function(t){return c2(at)(function(){return hp(t)})};function Dp(t,e,n){var r=Object.prototype.toString.call(n);return r.indexOf("[object HTML")===0&&r.indexOf("Element]")===r.length-8?e(n):t}function Ru(t){return function(){return t.click()}}function Ji(t){return function(){return t.offsetWidth}}function Gi(t){return function(){return t.offsetHeight}}var Fp=_;var wp=_;var yu=function(t){return Dp(d.value,s.create,t)};function Du(t){return function(){return t.checked}}function Cp(t){return function(){return t.files}}function Vr(t){return function(){return t.value}}var O2=v(A);var Vo=F("HTMLInputElement");var Vi=function(){var t=O2(at);return function(e){return t(Cp(e))}}();function Fu(t){return function(){return t.value}}var Mp=F("HTMLTextAreaElement");function ji(t){return function(){return t.document}}function jo(t){return t.clientX}function Xo(t){return t.clientY}function Yo(t){return t.touches}var wu=F("TouchEvent");function xp(t,e){return e.item(t)}var bu=function(t){return function(e){return at(xp(t,e))}};function Qo(t){return t.clientX}function Ko(t){return t.clientY}var Tu=F("MouseEvent");var Ce=y(Tt),_y=Ae(We),ta=Io(Jt)(bn(A)),gy=Ft(ta),jr=Dt(ta),Lp=Ut(ta),Eu=te(ta),Ip=Ht(ta),Xi=er(bt),Hn=C(Xi),Cu=he(Xi),Zo=Hr(bt),Ke=Ie(Ur)(bt),Yi=_y(Xi),Np=he(Fn),Qi=y(xo(bt)),hy=ja(Jt),Ry=lu()(),_n=Os(Jt),yy=gp(Ul),Xr=function(t){return function(e){return function(n){return function(){var u=Oi(wp(e))(),a=Ji(e)(),o=Gi(e)(),i=so(t)(),l=po(t)();return{x:(n.x-u.left)*i/a,y:(n.y-u.top)*l/o}}}}},ge=function(t){return function(){var n=Yn(t.canvas)(),r=Wf(t.canvas)();return hl(n)({x:0,y:0,width:r.width,height:r.height})(),Rt(n)(gy(n)(t.layer))()}},Dy=function(t){return Gt(function(e){var n=wu(e);if(n instanceof d)return Ce(void 0);if(n instanceof s){var r=bu(0)(Yo(n.value0));if(r instanceof d)return ge(t);if(r instanceof s)return function(){var a=jr(t.layer)(),o=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(jo(r.value0)),y:lt(Xo(r.value0))})(),i={offsetX:o.x-a.x,offsetY:o.y-a.y};return Lp(i)(t.layer)(),ge(t)()};throw new Error("Failed pattern match at Template.Main (line 196, column 22 - line 206, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 194, column 63 - line 206, column 22): "+[n.constructor.name])})},Fy=function(t){return Gt(function(e){var n=wu(e);if(n instanceof d)return Ce(void 0);if(n instanceof s){var r=bu(0)(Yo(n.value0));if(r instanceof d)return ge(t);if(r instanceof s)return function(){var a=jr(t.layer)(),o=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(jo(r.value0)),y:lt(Xo(r.value0))})(),i={translateX:o.x-a.x,translateY:o.y-a.y};return Eu(i)(t.layer)(),ge(t)()};throw new Error("Failed pattern match at Template.Main (line 224, column 22 - line 234, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 222, column 62 - line 234, column 22): "+[n.constructor.name])})},wy=function(t){return Gt(function(e){var n=wu(e);if(n instanceof d)return Ce(void 0);if(n instanceof s){var r=bu(0)(Yo(n.value0));if(r instanceof d)return ge(t);if(r instanceof s)return function(){var a=jr(t.layer)(),o=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(jo(r.value0)),y:lt(Xo(r.value0))})(),i={translateX:o.x-a.x,translateY:o.y-a.y};return Eu(i)(t.layer)(),Ip(t.layer)(),ge(t)()};throw new Error("Failed pattern match at Template.Main (line 253, column 22 - line 264, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 251, column 61 - line 264, column 22): "+[n.constructor.name])})},Ki=function(t){return function(e){return xn(Hn(Cu(Zo)(Ke(El(t))))(function(n){return Yi(Ke(Cl(n)(e)))(function(){return Hn(Ke(Np(ji)(zi)))(function(r){return Hn(Cu(Zo)(Ke(vn(t)(mn(r)))))(function(u){return Hn(Zo(yu(u)))(function(a){return Qi({canvas:n,canvasElement:u,canvasHtmlElement:a,document:r})})})})})}))}},Sp=function(t){var e=Bt(t);return function(n){return function(r){return function(){var a=hy(e(r))();return Ry(n)({layer:a})}}}},by=function(t){return Gt(function(e){var n=Tu(e);if(n instanceof d)return Ce(void 0);if(n instanceof s)return function(){var u=jr(t.layer)(),a=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(Qo(n.value0)),y:lt(Ko(n.value0))})(),o={translateX:a.x-u.x,translateY:a.y-u.y};return Eu(o)(t.layer)(),Ip(t.layer)(),ge(t)()};throw new Error("Failed pattern match at Template.Main (line 237, column 60 - line 248, column 20): "+[n.constructor.name])})},Ty=function(t){return Gt(function(e){var n=Tu(e);if(n instanceof d)return Ce(void 0);if(n instanceof s)return function(){var u=jr(t.layer)(),a=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(Qo(n.value0)),y:lt(Ko(n.value0))})(),o={translateX:a.x-u.x,translateY:a.y-u.y};return Eu(o)(t.layer)(),ge(t)()};throw new Error("Failed pattern match at Template.Main (line 209, column 62 - line 219, column 20): "+[n.constructor.name])})},Cy=function(t){return Gt(function(e){var n=Tu(e);if(n instanceof d)return Ce(void 0);if(n instanceof s)return function(){var u=jr(t.layer)(),a=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(Qo(n.value0)),y:lt(Ko(n.value0))})(),o={offsetX:a.x-u.x,offsetY:a.y-u.y};return Lp(o)(t.layer)(),ge(t)()};throw new Error("Failed pattern match at Template.Main (line 181, column 62 - line 191, column 20): "+[n.constructor.name])})},Ey=function(t){return Gt(function(e){return ge(t)})},Zi=function(t){return function(e){return function(n){return function(r){return xn(function(){var u=mn(r.document);return Hn(Cu(Zo)(Ke(vn(t)(u))))(function(a){return Hn(Ke(Gt(function(o){return function(){var l=Go("canvas")(hu(r.document))();fr("id")("hidden-clip-canvas")(l)();var f=yp(r.document)();if(f instanceof s){Bi(pp(l))(Fp(f.value0))();var c=El("hidden-clip-canvas")();if(c instanceof s){Cl(c.value0)({width:n.width,height:n.height})();var p=Yn(c.value0)(),m=r.canvas;wl(p)(m)(n.x)(n.y)(n.width)(n.height)(0)(0)(n.width)(n.height)();var h=Na(c.value0)(),w=Go("a")(hu(r.document))();fr("href")(h)(w)(),fr("download")(e)(w)();var L=yu(w);if(L instanceof s)return Ru(L.value0)();throw new Error("Failed pattern match at Template.Main (line 175, column 9 - line 175, column 53): "+[L.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 164, column 5 - line 164, column 64): "+[c.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 161, column 5 - line 161, column 53): "+[f.constructor.name])}})))(function(o){return Yi(Ke(Vt("click")(o)(!1)(ce(a))))(function(){return Qi(a)})})})}())}}}},Pp=function(t){return function(e){return function(n){return xn(function(){var r=mn(n.document);return Hn(Cu(Zo)(Ke(vn(t)(r))))(function(u){return Hn(Ke(Gt(function(a){return function(){var i=Na(n.canvas)(),l=Go("a")(hu(n.document))();fr("href")(i)(l)(),fr("download")(e)(l)();var f=yu(l);if(f instanceof s)return Ru(f.value0)();throw new Error("Failed pattern match at Template.Main (line 146, column 9 - line 146, column 53): "+[f.constructor.name])}})))(function(a){return Yi(Ke(Vt("click")(a)(!1)(ce(u))))(function(){return Qi(u)})})})}())}}},My=function(t){return function(e){return function(n){return function(r){return function(){var a=vn(e)(mn(t.document))();if(a instanceof s){var o=Mp(a.value0);if(o instanceof s){var i=Fu(o.value0)();_n(r(i))(n)();var l=Gt(function(f){return function(){var p=Fu(o.value0)();return _n(r(p))(n)()}})();return Vt("input")(l)(!1)(ce(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 300, column 7 - line 300, column 55): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 299, column 3 - line 299, column 79): "+[a.constructor.name])}}}}},ea=function(t){return function(e){return function(n){return function(r){return My(t)(e)(n)(function(u){return function(a){return function(o){return Ce(a(o))}}(r(u))})}}}},Ap=function(t){return function(e){return function(n){return function(r){return function(){var a=vn(e)(mn(t.document))();if(a instanceof s){var o=Vo(a.value0);if(o instanceof s){var i=Vr(o.value0)();(function(){var f=Aa(i);if(f instanceof s)return _n(r(f.value0))(n)();if(f instanceof d)return void 0;throw new Error("Failed pattern match at Template.Main (line 335, column 3 - line 337, column 25): "+[f.constructor.name])})();var l=Gt(function(f){return function(){var p=Vr(o.value0)(),m=Aa(p);if(m instanceof s)return _n(r(m.value0))(n)();if(m instanceof d)return void 0;throw new Error("Failed pattern match at Template.Main (line 341, column 5 - line 343, column 27): "+[m.constructor.name])}})();return Vt("input")(l)(!1)(ce(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 332, column 7 - line 332, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 331, column 3 - line 331, column 79): "+[a.constructor.name])}}}}},xy=function(t){return function(e){return function(n){return function(r){return Ap(t)(e)(n)(function(u){return function(a){return function(o){return Ce(a(o))}}(r(u))})}}}};var Wp=function(t){var e=Of(t);return function(n){return function(r){return function(u){return function(){var o=En(1)();return Ap(n)(r)(u)(function(i){return function(l){return function(){var c=ae(o)();return Sr(i)(o)(),e(i/c)(l)()}}})()}}}}},Mu=function(t){return function(e){return function(n){return xy(t)(e)(n)(Qd)}}},Ly=function(t){return function(e){return function(n){return function(r){return function(){var a=vn(e)(mn(t.document))();if(a instanceof s){var o=Vo(a.value0);if(o instanceof s){var i=Vr(o.value0)();_n(r(i))(n)();var l=Gt(function(f){return function(){var p=Vr(o.value0)();return _n(r(p))(n)()}})();return Vt("input")(l)(!1)(ce(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 284, column 7 - line 284, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 283, column 3 - line 283, column 79): "+[a.constructor.name])}}}}},xu=function(t){return function(e){return function(n){return function(r){return Ly(t)(e)(n)(function(u){return function(a){return function(o){return Ce(a(o))}}(r(u))})}}}},Iy=function(t){return function(e){return function(n){return function(r){return function(){var a=vn(e)(mn(t.document))();if(a instanceof s){var o=Vo(a.value0);if(o instanceof s){var i=function(c){if(c instanceof d)return Ce(void 0);if(c instanceof s){var p=Ve(yy(c.value0))(0);if(p instanceof d)return Ce(void 0);if(p instanceof s)return _n(r(p.value0))(n);throw new Error("Failed pattern match at Template.Main (line 371, column 24 - line 373, column 54): "+[p.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 369, column 26 - line 373, column 54): "+[c.constructor.name])},l=Vi(o.value0)();i(l)();var f=Gt(function(c){return Np(i)(Vi(o.value0))})();return Vt("change")(f)(!1)(ce(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 366, column 7 - line 366, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 365, column 3 - line 365, column 79): "+[a.constructor.name])}}}}};var Ny=function(t){return function(e){return function(n){return function(r){return function(){var a=vn(e)(mn(t.document))();if(a instanceof s){var o=Vo(a.value0);if(o instanceof s){var i=Du(o.value0)();_n(r(i))(n)();var l=Gt(function(f){return function(){var p=Du(o.value0)();return _n(r(p))(n)()}})();return Vt("input")(l)(!1)(ce(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 316, column 7 - line 316, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 315, column 3 - line 315, column 79): "+[a.constructor.name])}}}}},tc=function(t){return function(e){return function(n){return function(r){return Ny(t)(e)(n)(function(u){return function(a){return function(o){return Ce(a(o))}}(r(u))})}}}},Sy=function(t){return function(e){return function(n){return function(r){return Iy(t)(e)(n)(function(u){return r(mp(u))})}}}};var ec=function(t){return function(e){return function(n){return function(r){return Sy(t)(e)(n)(function(u){return function(a){return function(){var i=ki(u)();return r(i)(a)()}}})}}}},nc=function(t){return function(){var n=Cy(t)(),r=Ty(t)(),u=by(t)(),a=Dy(t)(),o=Fy(t)(),i=wy(t)(),l=Ey(t)();return Vt("mousedown")(n)(!1)(ce(t.canvasElement))(),Vt("mousemove")(r)(!1)(ce(t.canvasElement))(),Vt("mouseup")(u)(!1)(ce(t.canvasElement))(),Vt("touchstart")(a)(!1)(ce(t.canvasElement))(),Vt("touchmove")(o)(!1)(ce(t.canvasElement))(),Vt("touchend")(i)(!1)(ce(t.canvasElement))(),Vt("input")(l)(!1)(Rp(t.document))()}};var Ay=Ae(We),Wy=Gn(pt)(we),$p=At(Kt),rc=It(A),Uy=$p(Tt),qp=re(vr()(gn({reflectSymbol:function(){return"height"}})()(gn({reflectSymbol:function(){return"width"}})()(pr)($e))($e))),Op=he(Fn),Pe=ja(Jt),Bp=Cs(Jt),kp=Es(Jt),zp=Wp(bs(Jt)),na=Yl(Jt),Lu=Io(Jt),Jp=Bt(Lu(mu(Jt))),Gp=Bt(Lu(eu(Jt))),Vp=ip(bt),jp=za(Jt),ra=Bt(Vp(jp)),Xp=Bt(lp(bt)(Gs(Gl(bt))(bt))),Yp=$s(bt),Qp=Bt(Lu(zs(Yp)(bt))),Kp=Bt(Lu(jp)),Zp=Bt(Vp(ni(Tt))),tv=Sp(Yp);var ev=function(t){var e=za(t),n=Dt(e),r=t.Monad0(),u=r.Bind1(),a=C(u),o=v(u.Apply0().Functor0()),i=xs(t),l=yt(e),f=r.Applicative0(),c=y(f),p=xt(e),m=Ft(e),h=Ut(e),w=Zt(f),L=Ht(e);return{position:function(W){return n(W.guillotine)},translate:function(W){return function(J){return a(o(function(ft){return function($){return $+W.translateX}(function($){return $.x}(ft))})(n(J.guillotine)))(function(ft){return a(i(J.guillotine))(function($){var Z=Ms(J.guillotine).scaleY,mt=function(){return $ instanceof s&&$.value0.width!==0?Ts({scaleX:(J.xMax-ft)/$.value0.width,scaleY:Z})(J.guillotine):J.guillotine}();return a(l(W)(mt))(function(jt){return c({xMax:J.xMax,guillotine:jt})})})})}},containsPoint:function(W){return function(J){return p(W)(J.guillotine)}},draw:function(W){return function(J){return m(W)(J.guillotine)}},dragStart:function(W){return function(J){return a(h(W)(J.guillotine))(function(ft){return c({xMax:J.xMax,guillotine:ft})})}},drag:function(W){return function(J){return w(ev(t))(J.guillotine.dragOffset)(W)(J)}},dragEnd:function(W){return a(L(W.guillotine))(function(J){return c({xMax:W.xMax,guillotine:J})})}}},nv=function(t){var e=t.Monad0(),n=xl(e),r=Dt(n),u=e.Bind1(),a=C(u),o=yt(n),i=ev(t),l=yt(i),f=Io(t),c=f(eu(t)),p=yt(c),m=f(mu(t)),h=yt(m),w=Ay(u),L=Bs(t),W=e.Applicative0(),J=y(W),ft=u.Apply0().Functor0(),$=v(ft),Z=$p(W),mt=bn(ft),jt=xt(mt),Ze=Bt(n),qn=Bt(i),sr=Bt(m),uc=Bt(c),ov=Ft(mt),av=Ut(n),uv=Zt(W),lv=Ht(n);return{position:function(vt){return r(vt.overlayBackground)},translate:function(vt){return function(ut){return a(o(vt)(ut.overlayBackground))(function(Iu){return a(l(vt)(ut.guillotine))(function(iv){return a(p(vt)(ut.author))(function(cv){return a(h(vt)(ut.title))(function(lc){return w(L($i(function(Nu){return Nu-vt.translateX}))(lc))(function(){return w(L($i(function(Nu){return Nu-vt.translateX}))(ut.bodyText))(function(){return J({overlayBackground:Iu,guillotine:iv,author:cv,bodyText:ut.bodyText,title:lc})})})})})})})}},containsPoint:function(vt){return function(ut){return $(Wy)(Z(jt(vt))([Ze(ut.overlayBackground),qn(ut.guillotine),sr(ut.bodyText),uc(ut.author),sr(ut.title)]))}},draw:function(vt){return function(ut){return rc(Uy(ov(vt))([Ze(ut.overlayBackground),qn(ut.guillotine),sr(ut.bodyText),uc(ut.author),sr(ut.title)]))}},dragStart:function(vt){return function(ut){return a(av(vt)(ut.overlayBackground))(function(Iu){return J({guillotine:ut.guillotine,bodyText:ut.bodyText,author:ut.author,title:ut.title,overlayBackground:Iu})})}},drag:function(vt){return function(ut){return uv(nv(t))(ut.overlayBackground.dragOffset)(vt)(ut)}},dragEnd:function(vt){return a(lv(vt.overlayBackground))(function(ut){return J({guillotine:vt.guillotine,bodyText:vt.bodyText,author:vt.author,title:vt.title,overlayBackground:ut})})}}},Hy=Bt(up(bt)(Vs(nv(Jt))(bt))),N=2;var $y={width:1080,height:1920},oc=qp({width:N,height:N})($y),Up=function(){return oc.height}(),Hp=function(){return oc.width}(),qy=function(t){var e=t.Monad0(),n=C(e.Bind1()),r=Yl(t),u=y(e.Applicative0());return function(a){return function(o){return function(i){return function(l){return n(r(a)(o)(i)(ke.value))(function(f){return u({guillotine:f,xMax:l})})}}}}},Oy=qy(Jt),By=function(){return{width:1080,height:1080*5/4}}(),ac=function(){return qp({width:2*N,height:N})(By)}(),$n=function(){return ac.height}(),Ct=function(){return ac.width}(),ky=rc(function(){var e=Ki("canvas-story")(oc)();if(e instanceof s){var n=Yn(e.value0.canvas)(),r=Op(Pe)(Bp({x:0,y:0})({scaleX:1,scaleY:1})(ke.value))();ec(e.value0)("image")(r)(kp)(),zp(e.value0)("image-size-story")(r)();var u=na("./img/guillotinewit2x.png")({x:60*N,y:60*N})({scaleX:1,scaleY:1})(ke.value)(),a=na("./img/jacobinlogowit80x200.png")({x:Ct/2-100*N,y:Up-160*N})({scaleX:1,scaleY:1})(ke.value)(),o={x:60*N,y:250*N},i=Pe({text:[],lineHeight:.9,position:o,maxWidth:new s(Hp-2*60*N),fillStyle:"#fff",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:100*N},align:oe.value,baseline:xe.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();ea(e.value0)("title-left")(i)(Jo)(),Mu(e.value0)("title-size-story")(i)();var l=Pe({text:"AUTEUR",lineHeight:.95,position:o,fillStyle:"#fff",fontName:"Oswald",fontStyle:"normal",fontWeight:"500",fontSize:N*50,align:oe.value,baseline:be.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();xu(e.value0)("author")(l)(tu)();var f=li(o.y)(50*N)(Vl([Jp(i),Gp(l)])),c=Pe(ui({offsetX:0,offsetY:0})("#555")(15)(Lo([ra(Un(a)),Xp(qi(f)),ra(Un(u))])))();tc(e.value0)("shadow")(c)(function(w){return ai(function(){return w?"#555":"#0000"}())})();var p=Lo([Qp(c),Kp(r),Zp(Un(ri({x:0,y:0,width:Hp,height:Up})("#f00")))]),m=tv(e.value0)(p)();ge(m)(),nc(m)();var h=Pp("download-story")("jacobin-story.png")(m)();if(h instanceof s)return void 0;throw new Error("Failed pattern match at Jacobin.TitleSlide (line 419, column 3 - line 419, column 75): "+[h.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 332, column 3 - line 332, column 83): "+[e.constructor.name])}),zy=rc(function(){var e=Ki("canvas-title-slide")(ac)();if(e instanceof s){var n=Yn(e.value0.canvas)(),r=Op(Pe)(Bp({x:0,y:0})({scaleX:1,scaleY:1})(ke.value))();ec(e.value0)("image")(r)(kp)(),zp(e.value0)("image-size")(r)();var u=Oy("./img/guillotine2x.png")({x:Ct/2+285*N,y:60*N})({scaleX:(Ct-180*N-(Ct/2+285*N))/1560,scaleY:1})(Ct-180*N)(),a=na("./img/guillotinewit2x.png")({x:60*N,y:60*N})({scaleX:1,scaleY:1})(ke.value)(),o=na("./img/jacobinlogo80x200.png")({x:Ct-100*N,y:$n-160*N})({scaleX:1,scaleY:1})(ke.value)(),i=na("./img/jacobinlogowit80x200.png")({x:Ct/2-100*N,y:$n-160*N})({scaleX:1,scaleY:1})(ke.value)(),l=Pe({text:[],lineHeight:1.1,position:{x:Ct-N*60,y:N*150},fillStyle:"#f00",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"500",bold:"700"},size:90*N},align:wn.value,baseline:be.value,letterSpacing:"-3px",emptyLineHeight:.25,dragOffset:d.value,maxWidth:new s(Ct/2-2*60*N),context:n})();ea(e.value0)("bodytext")(l)(Jo)(),Mu(e.value0)("bodytext-size")(l)();var f={x:60*N,y:250*N},c=Pe({text:[],lineHeight:.9,position:f,maxWidth:new s(Ct/2-2*60*N),fillStyle:"#fff",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:100*N},align:oe.value,baseline:xe.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();ea(e.value0)("title-left")(c)(Jo)(),Mu(e.value0)("title-size")(c)();var p=Pe({text:"AUTEUR",lineHeight:.95,position:f,fillStyle:"#fff",fontName:"Oswald",fontStyle:"normal",fontWeight:"500",fontSize:N*50,align:oe.value,baseline:be.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();xu(e.value0)("author")(p)(tu)();var m=li(f.y)(50*N)(Vl([Jp(c),Gp(p)])),h=Pe({text:"AUTEUR",lineHeight:.95,position:{x:Ct/2+128*N,y:$n-160*N},fillStyle:"#f00",fontName:"Oswald",fontStyle:"normal",fontWeight:"400",fontSize:2*50,align:oe.value,baseline:xe.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();xu(e.value0)("author")(h)(function(jt){return tu(Ea(jt))})();var w=Pe({text:[],lineHeight:.9,position:{x:Ct/2+128*N,y:$n-160*N},maxWidth:new s(Ct/2-(128+2*60+20)*N),fillStyle:"#f00",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:50*N},align:oe.value,baseline:be.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();ea(e.value0)("title-right")(w)(Jo)();var L=zf({x:Ct/2+60*N,y:0})({width:Ct,height:$n})(82.5)("#fff"),W=Js(Ct/2)(60*N)({overlayBackground:L,guillotine:u,bodyText:l,author:h,title:w}),J=Pe(ui({offsetX:0,offsetY:0})("#555")(15)(Lo([ra(Un(i)),Xp(qi(m)),ra(Un(a))])))();tc(e.value0)("shadow")(J)(function(jt){return ai(function(){return jt?"#555":"#0000"}())})();var ft=Lo([ra(Un(o)),Hy(cp(W)),Qp(J),Kp(r),Zp(Un(ri({x:0,y:0,width:Ct,height:$n})("#f00")))]),$=tv(e.value0)(ft)();ge($)(),nc($)();var Z=Zi("download-left")("jacobin-titel-links.png")({x:0,y:0,width:Ct/2,height:$n})($)();if(Z instanceof s){var mt=Zi("download-right")("jacobin-titel-rechts.png")({x:Ct/2,y:0,width:Ct/2,height:$n})($)();if(mt instanceof s)return void 0;throw new Error("Failed pattern match at Jacobin.TitleSlide (line 327, column 3 - line 327, column 173): "+[mt.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 326, column 3 - line 326, column 155): "+[Z.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 150, column 3 - line 150, column 84): "+[e.constructor.name])}),rv=se(Ia)(zy)(ky);rv();})();
