/* Generated by Spago v0.93.44 */
(()=>{var tc=function(t){return function(e){for(var n=t.length,r=e.length,u=new Array(n*r),a=0,o=0;o<n;o++)for(var i=t[o],l=0;l<r;l++)u[a++]=i(e[l]);return u}};var na={compose:function(t){return function(e){return function(n){return t(e(n))}}}};var G=function(t){return t.identity},Q={identity:function(t){return t},Semigroupoid0:function(){return na}};var Ut=!0;var et=function(t){return function(e){return function(n){return t(n)(e)}}},tt=function(t){return function(e){return t}};var ec=function(t){return function(e){for(var n=e.length,r=new Array(n),u=0;u<n;u++)r[u]=t(e[u]);return r}};var O=function(){function t(){}return t.value=new t,t}();var p=function(t){return t.map},Te=function(t){var e=p(t);return function(n){return function(r){return e(r)(n)}}},Lt=function(t){return p(t)(tt(void 0))};var Ze=function(t){var e=p(t);return function(n){return e(tt(n))}};var It={map:ec};var ev=G(Q);var oa={apply:tc,Functor0:function(){return It}},st=function(t){return t.apply},nc=function(t){var e=st(t),n=p(t.Functor0());return function(r){return function(u){return e(n(tt)(r))(u)}}},le=function(t){var e=st(t),n=p(t.Functor0());return function(r){return function(u){return e(n(tt(ev))(r))(u)}}};var y=function(t){return t.pure};var Yr=function(t){var e=st(t.Apply0()),n=y(t);return function(r){return function(u){return e(n(r))(u)}}};var oc=typeof Array.prototype.flatMap=="function"?function(t){return function(e){return t.flatMap(e)}}:function(t){return function(e){for(var n=[],r=t.length,u=0;u<r;u++)for(var a=e(t[u]),o=a.length,i=0;i<o;i++)n.push(a[i]);return n}};var Se=function(t){return t.discard};var ua={bind:oc,Apply0:function(){return oa}},C=function(t){return t.bind},me=function(t){return et(C(t))};var Pe={discard:function(t){return C(t)}};var ac=function(t){return function(e){return function(n){for(var r=e,u=n.length,a=u-1;a>=0;a--)r=t(n[a])(r);return r}}},uc=function(t){return function(e){return function(n){for(var r=e,u=n.length,a=0;a<u;a++)r=t(r)(n[a]);return r}}};var lc=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var te=function(t){return t.reflectSymbol};var ge=function(t){return function(e){return e[t]}},ie=function(t){return function(e){return function(n){var r={};for(var u in n)({}).hasOwnProperty.call(n,u)&&(r[u]=n[u]);return r[t]=e,r}}};var We={append:lc};var $=function(t){return t.append};var Ft=function(t){return t.alt};var cc="\uFFFF",fc="\0",fv=Number.POSITIVE_INFINITY,sv=Number.NEGATIVE_INFINITY;var Su=function(t){return function(e){return function(n){return function(r){return function(u){return r<u?t:r===u?e:n}}}}};var sc=Su,dc=Su;var pc=Su;var Pu=function(t){return function(e){return t===e}};var vc=Pu,mc=Pu,_c=Pu;var gc={eq:mc},la={eq:vc},ia={eq:_c};var Y=function(t){return t.eq};var B=function(){function t(){}return t.value=new t,t}(),U=function(){function t(){}return t.value=new t,t}(),rt=function(){function t(){}return t.value=new t,t}();var dr={eq:function(t){return function(e){return t instanceof B&&e instanceof B||t instanceof U&&e instanceof U||t instanceof rt&&e instanceof rt}}};var hc=function(t){return function(e){return t-e|0}},Rc=function(t){return function(e){return t-e}};var yc=function(t){return function(e){return t+e|0}},Dc=function(t){return function(e){return t*e|0}},Fc=function(t){return function(e){return t+e}},wc=function(t){return function(e){return t*e}};var bc=function(t){return t.zeroRecord},he=function(t){return t.zero};var pr={addRecord:function(t){return function(e){return function(n){return{}}}},mulRecord:function(t){return function(e){return function(n){return{}}}},oneRecord:function(t){return function(e){return{}}},zeroRecord:function(t){return function(e){return{}}}};var Ue={add:Fc,zero:0,mul:wc,one:1},ca={add:yc,zero:0,mul:Dc,one:1},Tc=function(t){return t.oneRecord},He=function(t){return t.one},Cc=function(t){return t.mulRecord},ee=function(t){return t.mul},Ec=function(t){return t.addRecord},vr=function(){return function(t){return{add:Ec(t)(O.value),mul:Cc(t)(O.value),one:Tc(t)(O.value)(O.value),zero:bc(t)(O.value)(O.value)}}},ce=function(t){return t.add};var pn=function(t){var e=te(t);return function(){return function(n){var r=Ec(n),u=Cc(n),a=Tc(n),o=bc(n);return function(i){var l=ce(i),f=ee(i),c=He(i),v=he(i);return{addRecord:function(m){return function(h){return function(b){var L=r(O.value)(h)(b),W=e(O.value),J=ie(W),it=ge(W);return J(l(it(h))(it(b)))(L)}}},mulRecord:function(m){return function(h){return function(b){var L=u(O.value)(h)(b),W=e(O.value),J=ie(W),it=ge(W);return J(f(it(h))(it(b)))(L)}}},oneRecord:function(m){return function(h){var b=a(O.value)(O.value),L=e(O.value),W=ie(L);return W(c)(b)}},zeroRecord:function(m){return function(h){var b=o(O.value)(O.value),L=e(O.value),W=ie(L);return W(v)(b)}}}}}}};var gv=vr(),Mc=function(t){return t.subRecord},mr=function(t){return t.sub};var Au={subRecord:function(t){return function(e){return function(n){return{}}}},SemiringRecord0:function(){return pr}},fa=function(t){var e=te(t),n=pn(t)();return function(){return function(r){var u=Mc(r),a=n(r.SemiringRecord0());return function(o){var i=mr(o),l=a(o.Semiring0());return{subRecord:function(f){return function(c){return function(v){var m=u(O.value)(c)(v),h=e(O.value),b=ie(h),L=ge(h);return b(i(L(c))(L(v)))(m)}}},SemiringRecord0:function(){return l}}}}}},Wu=function(){return function(t){var e=gv(t.SemiringRecord0());return{sub:Mc(t)(O.value),Semiring0:function(){return e}}}};var sa={sub:Rc,Semiring0:function(){return Ue}},xc={sub:hc,Semiring0:function(){return ca}};var Zr=function(){return{compare:dc(B.value)(rt.value)(U.value),Eq0:function(){return gc}}}(),fe=function(){return{compare:sc(B.value)(rt.value)(U.value),Eq0:function(){return la}}}(),da=function(){return{compare:pc(B.value)(rt.value)(U.value),Eq0:function(){return ia}}}();var k=function(t){return t.compare};var tn=function(t){return t.top};var to={top:cc,bottom:fc,Ord0:function(){return da}};var vn=function(t){return t.bottom};var Nc=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"},Sc=function(t){var e=t.charCodeAt(0);if(e<32||e===127){switch(t){case"\x07":return"'\\a'";case"\b":return"'\\b'";case"\f":return"'\\f'";case`
`:return"'\\n'";case"\r":return"'\\r'";case"	":return"'\\t'";case"\v":return"'\\v'"}return"'\\"+e.toString(10)+"'"}return t==="'"||t==="\\"?"'\\"+t+"'":"'"+t+"'"};var Pc=function(t){return function(e){for(var n=[],r=0,u=e.length;r<u;r++)n[r]=t(e[r]);return"["+n.join(",")+"]"}};var pa={show:Nc};var va={show:Sc};var E=function(t){return t.show},Hu=function(t){return{show:Pc(E(t))}};var Ev=G(Q),d=function(){function t(){}return t.value=new t,t}(),s=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}();var Re=function(t){return function(e){return function(n){if(n instanceof d)return t;if(n instanceof s)return e(n.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[t.constructor.name,e.constructor.name,n.constructor.name])}}},mn=Re(!0)(tt(!1));var dt={map:function(t){return function(e){return e instanceof s?new s(t(e.value0)):d.value}}};var jt=function(t){return Re(t)(Ev)},$e=function(){return function(t){if(t instanceof s)return t.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[t.constructor.name])}};var Rt=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),mt=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}();var $n=function(t){return t.defer};var Uc=function(t){return function(e){return t&&e}},Hc=function(t){return function(e){return t||e}},$c=function(t){return!t};var ga=function(t){return t.not};var no=function(t){return t.ff};var hr=function(t){return t.disj},ye={ff:!1,tt:!0,implies:function(t){return function(e){return hr(ye)(ga(ye)(t))(e)}},conj:Uc,disj:Hc,not:$c};var qc=function(t){return Math.min(Math.abs(t),2147483647)},Oc=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},Bc=function(t){return function(e){if(e===0)return 0;var n=Math.abs(e);return(t%n+n)%n}};var kc={Ring0:function(){return xc}};var ro=function(t){return t.mod};var ha={degree:qc,div:Oc,mod:Bc,CommutativeRing0:function(){return kc}};var _t=function(t){return t.mempty};var M=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var nn=function(t){return t.value1};var rn=function(t){return t.value0};var Fa=function(t){return t};var kv=function(t){var e=hr(t);return{append:function(n){return function(r){return e(n)(r)}}}};var Gu=function(t){var e=kv(t);return{mempty:no(t),Semigroup0:function(){return e}}};var _=function(t){return t};var Vu=function(){return _};var jc=Vu();var qn=function(){return jc};var ju=function(){return function(){return function(){return function(){return function(t){return jc}}}}};var jv=G(Q),Xv=Y(dr);var Yv=ju()()()(),qt=function(t){return t.foldr};var Bn=function(t){var e=le(t.Apply0()),n=y(t);return function(r){var u=qt(r);return function(a){return u(function(o){return e(a(o))})(n(void 0))}}},lo=function(t){var e=Bn(t);return function(n){return et(e(n))}};var gt=function(t){return t.foldl};var Yc=function(t){var e=gt(t);return function(n){var r=function(u){return function(a){if(u instanceof d)return new s(a);if(u instanceof s)return new s(function(){var o=Xv(n(u.value0)(a))(U.value);return o?u.value0:a}());throw new Error("Failed pattern match at Data.Foldable (line 441, column 3 - line 441, column 27): "+[u.constructor.name,a.constructor.name])}};return e(r)(d.value)}},io=function(t){var e=k(t);return function(n){return Yc(n)(e)}};var Yu=function(t){var e=gt(t);return function(n){return e(ce(n))(he(n))}};var Qc=function(t){var e=qt(t);return function(n){var r=$(n.Semigroup0()),u=_t(n);return function(a){return e(function(o){return function(i){return r(a(o))(i)}})(u)}}},pt={foldr:ac,foldl:uc,foldMap:function(t){return Qc(pt)(t)}};var qe=function(t){return t.foldMap};var kn=function(t){var e=qe(t);return function(n){return Yv(Fa)(e(Gu(n)))}};var zn=function(t){var e=kn(t);return function(n){return e(n)(jv)}};var Ta=function(t){return t.toUpperCase()};var Jn=function(t){return function(e){return e.join(t)}};var wr=function(t){return t===""};var Kc=function(){function t(u){return[u]}function e(u){return function(a){return[u,a]}}function n(u){return function(a){return function(o){return[u,a,o]}}}function r(u){return function(a){return u.concat(a)}}return function(u){return function(a){return function(o){return function(i){return function(l){function f(c,v){switch(v-c){case 0:return o([]);case 1:return a(t)(i(l[c]));case 2:return u(a(e)(i(l[c])))(i(l[c+1]));case 3:return u(u(a(n)(i(l[c])))(i(l[c+1])))(i(l[c+2]));default:var m=c+Math.floor((v-c)/4)*2;return u(a(r)(f(c,m)))(f(m,v))}}return f(0,l.length)}}}}}}();var br=function(t){return t};var Zu={map:function(t){return function(e){return t(e)}}};var ef={apply:function(t){return function(e){return t(e)}},Functor0:function(){return Zu}},t1={bind:function(t){return function(e){return e(t)}},Apply0:function(){return ef}},e1={pure:br,Apply0:function(){return ef}},nf={Applicative0:function(){return e1},Bind1:function(){return t1}};var A1=G(Q),Pt=function(t){return t.traverse};var W1=function(t){var e=Pt(t);return function(n){return e(n)(A1)}},Xt={traverse:function(t){var e=t.Apply0();return Kc(st(e))(p(e.Functor0()))(y(t))},sequence:function(t){return W1(Xt)(t)},Functor0:function(){return It},Foldable1:function(){return pt}};var df=function(t){return function(e){var n=Pt(e)(t);return function(r){return function(u){return n(u)(r)}}}};var pf=function(t){return function(){return t}},vf=function(t){return function(e){return function(){return e(t())()}}};var _f=function(t){var e=C(t.Bind1()),n=y(t.Applicative0());return function(r){return function(u){return e(u)(function(a){return n(r(a))})}}},Vn=function(t){var e=C(t.Bind1()),n=y(t.Applicative0());return function(r){return function(u){return e(r)(function(a){return e(u)(function(o){return n(a(o))})})}}};var gf=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}},bt={Applicative0:function(){return yt},Bind1:function(){return hn}},hn={bind:vf,Apply0:function(){return al(0)}},yt={pure:pf,Apply0:function(){return al(0)}},hf=gf("functorEffect","Effect",function(){return{map:Yr(yt)}}),al=gf("applyEffect","Effect",function(){return{apply:Vn(bt),Functor0:function(){return hf(0)}}}),A=hf(20),xa=al(23);var Bt={liftEffect:G(Q),Monad0:function(){return bt}},At=function(t){return t.liftEffect};function Rf(t){return function(e){return function(n){return function(){var r=new Image;r.src=t,r.addEventListener("load",function(){n(r)()},!1),r.addEventListener("error",function(){e()},!1)}}}}function yf(t,e,n){return function(){var r=document.getElementById(t);return r&&r instanceof HTMLCanvasElement?e(r):n}}function jn(t){return function(){return t.getContext("2d")}}function so(t){return function(){return t.width}}function po(t){return function(){return t.height}}function ul(t){return function(e){return function(){t.width=e}}}function ll(t){return function(e){return function(){t.height=e}}}function La(t){return function(){return t.toDataURL()}}function Ee(t){return function(e){return function(){t.fillStyle=e}}}function Df(t){return function(e){return function(){t.globalCompositeOperation=e}}}function vo(t){return function(){t.beginPath()}}function mo(t){return function(){t.fill()}}function _o(t){return function(e){return function(n){return function(){t.lineTo(e,n)}}}}function il(t){return function(e){return function(n){return function(){t.moveTo(e,n)}}}}function cl(t){return function(){t.closePath()}}function fl(t){return function(e){return function(){t.rect(e.x,e.y,e.width,e.height)}}}function sl(t){return function(e){return function(){t.clearRect(e.x,e.y,e.width,e.height)}}}function dl(t){return function(e){return function(){t.translate(e.translateX,e.translateY)}}}function Ff(t){return function(e){return function(){t.textAlign=e}}}function wf(t){return function(e){return function(){t.textBaseline=e}}}function Tr(t){return function(e){return function(){t.font=e}}}function go(t){return function(e){return function(n){return function(r){return function(){t.fillText(e,n,r)}}}}}function pl(t){return function(){t.save()}}function vl(t){return function(){t.restore()}}function ml(t){return function(e){return function(n){return function(r){return function(u){return function(a){return function(){t.drawImage(e,n,r,u,a)}}}}}}}function _l(t){return function(e){return function(n){return function(r){return function(u){return function(a){return function(o){return function(i){return function(l){return function(f){return function(){t.drawImage(e,n,r,u,a,o,i,l,f)}}}}}}}}}}}var G1=le(xa),De=function(){function t(){}return t.value=new t,t}(),V1=function(){function t(){}return t.value=new t,t}(),j1=function(){function t(){}return t.value=new t,t}(),X1=function(){function t(){}return t.value=new t,t}(),Y1=function(){function t(){}return t.value=new t,t}(),Me=function(){function t(){}return t.value=new t,t}(),ne=function(){function t(){}return t.value=new t,t}(),Rn=function(){function t(){}return t.value=new t,t}(),Cr=function(){function t(){}return t.value=new t,t}(),Er=function(){function t(){}return t.value=new t,t}(),Mr=function(){function t(){}return t.value=new t,t}();var Oe=function(){function t(){}return t.value=new t,t}(),Q1=function(){function t(){}return t.value=new t,t}(),K1=function(){function t(){}return t.value=new t,t}(),Z1=function(){function t(){}return t.value=new t,t}(),tm=function(){function t(){}return t.value=new t,t}(),em=function(){function t(){}return t.value=new t,t}(),nm=function(){function t(){}return t.value=new t,t}(),rm=function(){function t(){}return t.value=new t,t}(),om=function(){function t(){}return t.value=new t,t}(),am=function(){function t(){}return t.value=new t,t}(),um=function(){function t(){}return t.value=new t,t}(),lm=function(){function t(){}return t.value=new t,t}(),im=function(){function t(){}return t.value=new t,t}(),cm=function(){function t(){}return t.value=new t,t}(),fm=function(){function t(){}return t.value=new t,t}(),sm=function(){function t(){}return t.value=new t,t}(),dm=function(){function t(){}return t.value=new t,t}(),pm=function(){function t(){}return t.value=new t,t}(),vm=function(){function t(){}return t.value=new t,t}(),mm=function(){function t(){}return t.value=new t,t}(),_m=function(){function t(){}return t.value=new t,t}(),gm=function(){function t(){}return t.value=new t,t}(),hm=function(){function t(){}return t.value=new t,t}(),Rm=function(){function t(){}return t.value=new t,t}(),ym=function(){function t(){}return t.value=new t,t}(),Dm=function(){function t(){}return t.value=new t,t}(),Tt=function(t){return function(e){return function(){pl(t)();var r=e();return vl(t)(),r}}},hl=function(t){return function(e){return Rf(t)(e(d.value))(function(n){return e(s.create(n))})}};var xr=function(t){return function(e){var n=function(r){if(r instanceof De)return"top";if(r instanceof V1)return"hanging";if(r instanceof j1)return"middle";if(r instanceof X1)return"alphabetic";if(r instanceof Y1)return"ideographic";if(r instanceof Me)return"bottom";throw new Error("Failed pattern match at Graphics.Canvas (line 577, column 5 - line 577, column 33): "+[r.constructor.name])};return wf(t)(n(e))}},Lr=function(t){return function(e){var n=function(r){if(r instanceof ne)return"left";if(r instanceof Rn)return"right";if(r instanceof Cr)return"center";if(r instanceof Er)return"start";if(r instanceof Mr)return"end";throw new Error("Failed pattern match at Graphics.Canvas (line 531, column 5 - line 531, column 32): "+[r.constructor.name])};return Ff(t)(n(e))}};var Ef=function(t){return function(e){var n=function(r){if(r instanceof Oe)return"source-over";if(r instanceof Q1)return"source-in";if(r instanceof K1)return"source-out";if(r instanceof Z1)return"source-atop";if(r instanceof tm)return"destination-over";if(r instanceof em)return"destination-in";if(r instanceof nm)return"destination-out";if(r instanceof rm)return"destination-atop";if(r instanceof om)return"lighter";if(r instanceof am)return"copy";if(r instanceof um)return"xor";if(r instanceof lm)return"multiply";if(r instanceof im)return"screen";if(r instanceof cm)return"overlay";if(r instanceof fm)return"darken";if(r instanceof sm)return"lighten";if(r instanceof dm)return"color-dodge";if(r instanceof pm)return"color-burn";if(r instanceof vm)return"hard-light";if(r instanceof mm)return"soft-light";if(r instanceof _m)return"difference";if(r instanceof gm)return"exclusion";if(r instanceof hm)return"hue";if(r instanceof Rm)return"saturation";if(r instanceof ym)return"color";if(r instanceof Dm)return"luminosity";throw new Error("Failed pattern match at Graphics.Canvas (line 326, column 5 - line 326, column 45): "+[r.constructor.name])};return Df(t)(n(e))}},Rl=function(t){return function(e){return G1(ll(t)(e.height))(ul(t)(e.width))}},yl=function(t){return yf(t,s.create,d.value)},Mf=function(t){return function(){var n=so(t)(),r=po(t)();return{width:n,height:r}}},xf=function(t){return function(e){return function(){vo(t)();var r=e();return mo(t)(),r}}};var Ia=isFinite;function Lf(t,e,n,r){var u=parseFloat(t);return e(u)?n(u):r}var Ir=Math.round;var Na=Math.tan;var If=3.141592653589793;var Sa=function(t){return Lf(t,Ia,s.create,d.value)};var Pa=function(t){return function(e){return e(function(n){return t(n)})}},ke=function(t){return function(e){return{x:e.x+t.translateX,y:e.y+t.translateY}}};var Ct=function(t){return t.translate},Nf=function(t){return function(e){return{width:e.width*t.scaleX,height:e.height*t.scaleY}}},Dl=function(t){return t.scale},Sf=function(t){var e=Dl(t);return function(n){return e({scaleX:n,scaleY:n})}},Et=function(t){return t.position},kt=function(t){return function(e){return function(n){return n(t)(e)}}},Mm=function(t){var e=p(t);return function(n){return Pa(function(r){var u=e(kt(r)),a=n(r);return function(o){return u(a(o))}})}};var Xn=function(t){return t.mapLayerWrapper},Mt=function(t){return t.draw},Pf=function(t){var e=Ct(t);return function(n){return function(r){return function(u){var a={translateX:r.translateX-n.offsetX,translateY:r.translateY-n.offsetY};return e(a)(u)}}}},Yt=function(t){var e=y(t);return function(n){var r=Pf(n);return function(u){return function(a){return function(o){if(u instanceof d)return e(o);if(u instanceof s)return r(u.value0)(a)(o);throw new Error("Failed pattern match at Template.Layer (line 61, column 1 - line 61, column 115): "+[u.constructor.name,a.constructor.name,o.constructor.name])}}}}},zt=function(t){return t.dragStart},Jt=function(t){return t.dragEnd},se=function(t){return t.drag},$t=function(t){return t.containsPoint},yn=function(t){var e=Mm(t);return{position:Pa(function(n){return Et(n)}),translate:function(n){return e(function(r){return Ct(r)(n)})},containsPoint:function(n){return Pa(function(r){return $t(r)(n)})},draw:function(n){return Pa(function(r){return Mt(r)(n)})},dragStart:function(n){return e(function(r){return zt(r)(n)})},drag:function(n){return e(function(r){return se(r)(n)})},dragEnd:e(function(n){return Jt(n)})}};var Wf=function(t){return function(e){return function(n){return function(r){return{position:t,dimensions:e,angle:n,fillStyle:r,dragOffset:d.value}}}}},Af=function(t){return t*If/180},Fl=function(t){var e=t.Applicative0(),n=y(e),r=Yt(e);return{position:function(u){return n(u.position)},translate:function(u){return function(a){return n({dimensions:a.dimensions,angle:a.angle,fillStyle:a.fillStyle,dragOffset:a.dragOffset,position:ke(u)(a.position)})}},containsPoint:function(u){return function(a){var o=(a.dimensions.height-u.y)/Na(Af(a.angle));return n(a.position.x+o<=u.x&&u.x<=a.position.x+a.dimensions.width&&a.position.y<=u.y&&u.y<=a.position.y+a.dimensions.height)}},draw:function(u){return function(a){return Tt(u)(function(){return Ee(u)(a.fillStyle)(),vo(u)(),il(u)(a.position.x)(a.position.y+a.dimensions.height)(),_o(u)(a.position.x+a.dimensions.width)(a.position.y+a.dimensions.height)(),_o(u)(a.position.x+a.dimensions.width)(a.position.y)(),_o(u)(a.position.x+a.dimensions.height/Na(Af(a.angle)))(a.position.y)(),cl(u)(),mo(u)()})}},dragStart:function(u){return function(a){return n({position:a.position,dimensions:a.dimensions,angle:a.angle,fillStyle:a.fillStyle,dragOffset:new s(u)})}},drag:function(u){return function(a){return r(Fl(t))(a.dragOffset)(u)(a)}},dragEnd:function(u){return n({position:u.position,dimensions:u.dimensions,angle:u.angle,fillStyle:u.fillStyle,dragOffset:d.value})}}};var Uf=function(t,e){for(var n=t>e?-1:1,r=new Array(n*(e-t)+1),u=t,a=0;u!==e;)r[a++]=u,u+=n;return r[a]=u,r},Lm=function(t,e){if(t<1)return[];var n=new Array(t);return n.fill(e)},Im=function(t,e){for(var n=[],r=0,u=0;u<t;u++)n[r++]=e;return n},Nm=typeof Array.prototype.fill=="function"?Lm:Im,Hf=function(){function t(u,a){this.head=u,this.tail=a}var e={};function n(u){return function(a){return new t(u,a)}}function r(u){for(var a=[],o=0,i=u;i!==e;)a[o++]=i.head,i=i.tail;return a}return function(u,a){return r(u(n)(e)(a))}}(),xt=function(t){return t.length};var $f=function(t,e,n,r){return r<0||r>=n.length?e:t(n[r])};var qf=function(t,e,n,r){for(var u=0,a=r.length;u<a;u++)if(n(r[u]))return t(u);return e};var Of=function(t,e,n,r,u){if(n<0||n>=u.length)return e;var a=u.slice();return a[n]=r,t(a)},Dn=function(t){return t.slice().reverse()},Fn=function(t){if(t.length<=1e4)return Array.prototype.concat.apply([],t);for(var e=[],n=0,r=t.length;n<r;n++)for(var u=t[n],a=0,o=u.length;a<o;a++)e.push(u[a]);return e};var Bf=function(t,e,n){for(var r=n.length,u=e,a=new Array(r),o=0;o<r;o++)u=t(u)(n[o]),a[o]=u;return a};var kf=function(t,e,n){return n.slice(t,e)},zf=function(t,e,n){for(var r=e.length<n.length?e.length:n.length,u=new Array(r),a=0;a<r;a++)u[a]=t(e[a])(n[a]);return u},Jf=function(t,e){for(var n=e.length,r=0;r<n;r++)if(t(e[r]))return!0;return!1},Gf=function(t,e){for(var n=e.length,r=0;r<n;r++)if(!t(e[r]))return!1;return!0};var Vf=function(t){return function(){return{value:t}}};var re=function(t){return function(){return t.value}},jf=function(t){return function(e){return function(){var n=t(e.value);return e.value=n.state,n.value}}},Sr=function(t){return function(e){return function(){e.value=t}}};var Am=Lt(A),wn=Vf,Wm=jf,wl=function(t){return Wm(function(e){var n=t(e);return{state:n,value:n}})},bl=function(t){return function(e){return Am(wl(t)(e))}};var oe=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),ae=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),an=function(t){return t.tailRecM};var $m=function(t){var e=function(n){var r=!1,u;function a(o){if(o instanceof oe){n=t(o.value0);return}if(o instanceof ae)return r=!0,o.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 103, column 3 - line 103, column 25): "+[o.constructor.name])}for(;!r;)u=a(n);return u};return function(n){return e(t(n))}};var Xf={tailRecM:function(t){var e=function(r){return r},n=$m(function(r){return e(t(r))});return function(r){return br(n(r))}},Monad0:function(){return nf}};function zm(t){return t}var Zf=zm;function Jm(t){return t.slice()}var ts=Jm;var es=function(t,e){return e.push(t)};var Wa=function(e){return function(n){return function(){return e(n)}}},Tl=function(e){return function(n){return function(r){return function(){return e(n,r)}}}};var ns=Wa(Zf);var Km=Wa(ts),rs=function(t){return function(e){return function(){var r=Km(e)();return t(r)(),ns(r)()}}};var Cl=Tl(es);var Ro=function(t){return function(e,n,r,u,a){return t(e)(n)(r)(u)(a)}};var bn=function(t){return function(e){return function(n){return t(e,n)}}},yo=function(t){return function(e){return function(n){return function(r){return t(e,n,r)}}}},Ua=function(t){return function(e){return function(n){return function(r){return function(u){return t(e,n,r,u)}}}}},El=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){return t(e,n,r,u,a)}}}}}};var us=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){for(var o=[],i=a;;){var l=u(i);if(t(l))return o;var f=e(l);o.push(n(f)),i=r(f)}}}}}}};var ls=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){for(var o=[],i=a;;){var l=u(i);o.push(n(l));var f=r(l);if(t(f))return o;i=e(f)}}}}}}};var s_=$e();var Ml={unfoldr1:ls(mn)(s_)(rn)(nn)};var v_=$e(),un=function(t){return t.unfoldr};var Ll={unfoldr:us(mn)(v_)(rn)(nn),Unfoldable10:function(){return Ml}};var m_=$(We);var ds=yo(zf);var Je=function(){return ds(M.create)}();var ps=function(){return El(Of)(s.create)(d.value)}();var Wt=function(t){return function(e){return rs(Cl(e))(t)()}},Il=yo(kf),wo=function(t){return function(e){return t<=0?{before:[],after:e}:{before:Il(0)(t)(e),after:Il(t)(xt(e))(e)}}};var Sl=function(t){return[t]};var Ar=yo(Bf);var Pl=bn(Uf);var Ge=function(){return Ua($f)(s.create)(d.value)}();var Al=function(t){return function(e){return function(n){var r=function(u){return ps(t)(e(u))(n)};return Re(d.value)(r)(Ge(n)(t))}}};var Wl=function(t){return bn(Hf)(qt(t))};var bo=function(){return Ua(qf)(s.create)(d.value)}();var Ul=function(t){var e=Y(t);return function(n){return bo(function(r){return e(r)(n)})}},Hl=function(t){var e=Ul(t);return function(n){return function(r){return mn(e(n)(r))}}};var Qn=function(t){return function(e){return m_([t])(e)}};var vs=et(C(ua));var To=bn(Jf);var Oa=bn(Gf);var __=zn(pt)(ye),g_=Pt(Xt),h_=mr(Wu()(fa({reflectSymbol:function(){return"x"}})()(fa({reflectSymbol:function(){return"y"}})()(Au)(sa))(sa))),R_=Bn(yt)(pt);var $l=function(t){var e=t.Applicative0(),n=y(e),r=t.Bind1().Apply0().Functor0(),u=p(r),a=g_(e),o=yn(r),i=$t(o),l=Mt(o),f=Yt(e);return{position:function(c){return n(c.position)},translate:function(c){return function(v){return n({layers:v.layers,dragOffset:v.dragOffset,position:ke(c)(v.position)})}},containsPoint:function(c){return function(v){return u(__)(a(i(h_(c)(v.position)))(v.layers))}},draw:function(c){return function(v){return Tt(c)(function(){return dl(c)({translateX:v.position.x,translateY:v.position.y})(),R_(function(){var h=Tt(c),b=l(c);return function(L){return h(b(L))}}())(Dn(v.layers))()})}},dragStart:function(c){return function(v){return n({layers:v.layers,position:v.position,dragOffset:new s(c)})}},drag:function(c){return function(v){return f($l(t))(v.dragOffset)(c)(v)}},dragEnd:function(c){return n({layers:c.layers,position:c.position,dragOffset:d.value})}}},ql=function(t){return{layers:t,position:{x:0,y:0},dragOffset:d.value}};var Co=t=>t.width,Eo=t=>t.height;var Kn=t=>e=>()=>t.letterSpacing=e;var ms=function(t){return function(e){return function(n){return function(r){return ml(t)(e)(n.x)(n.y)(r.width)(r.height)}}}};var Ol=function(t){return{width:Co(t),height:Eo(t)}};var F_=ee(vr()(pn({reflectSymbol:function(){return"scaleX"}})()(pn({reflectSymbol:function(){return"scaleY"}})()(pr)(Ue))(Ue))),w_=Se(Pe),b_=p(dt);var _s=function(t){var e=y(t.Monad0().Applicative0());return{scale:function(n){return function(r){return e({image:r.image,position:r.position,composite:r.composite,dragOffset:r.dragOffset,scale:F_(n)(r.scale)})}}}},Ba=function(t){var e=t.Monad0(),n=e.Applicative0(),r=y(n),u=C(e.Bind1()),a=At(t),o=Yt(n);return{position:function(i){return r(i.position)},translate:function(i){return function(l){return r({image:l.image,scale:l.scale,composite:l.composite,dragOffset:l.dragOffset,position:ke(i)(l.position)})}},containsPoint:function(i){return function(l){return u(a(re(l.image)))(function(f){if(f instanceof d)return r(!1);if(f instanceof s)return r(l.position.x<=i.x&&i.x<=l.position.x+Co(f.value0)*l.scale.scaleX&&l.position.y<=i.y&&i.y<=l.position.y+Eo(f.value0)*l.scale.scaleY);throw new Error("Failed pattern match at Template.Layer.Image (line 74, column 5 - line 80, column 90): "+[f.constructor.name])})}},dragStart:function(i){return function(l){return r({image:l.image,position:l.position,scale:l.scale,composite:l.composite,dragOffset:new s(i)})}},drag:function(i){return function(l){return o(Ba(t))(l.dragOffset)(i)(l)}},dragEnd:function(i){return r({image:i.image,position:i.position,scale:i.scale,composite:i.composite,dragOffset:d.value})},draw:function(i){return function(l){return function(){var c=re(l.image)();if(c instanceof d)return void 0;if(c instanceof s)return Tt(i)(function(){return Ef(i)(l.composite)(),ms(i)(c.value0)(l.position)(Nf(l.scale)(Ol(c.value0)))()})();throw new Error("Failed pattern match at Template.Layer.Image (line 88, column 5 - line 94, column 54): "+[c.constructor.name])}}}}},gs=function(t){return function(e){return{image:e.image,position:e.position,composite:e.composite,dragOffset:e.dragOffset,scale:t}}},kl=function(t){var e=At(t);return function(n){return function(r){return function(u){return function(a){return e(function(){var i=wn(d.value)();return hl(n)(function(){var l=et(bl)(i);return function(f){return l(tt(f))}}())(),{image:i,position:r,scale:u,composite:a,dragOffset:d.value}})}}}}},hs=function(t){var e=At(t);return function(n){return function(r){return function(u){return e(function(){var o=wn(d.value)();return{image:o,position:n,scale:r,composite:u,dragOffset:d.value}})}}}},Rs=function(t){var e=t.Monad0(),n=w_(e.Bind1()),r=At(t),u=y(e.Applicative0());return function(a){return function(o){return n(r(hl(a)(function(){var i=et(bl)(o.image);return function(l){return i(tt(l))}}())))(function(){return u(o)})}}},ys=function(t){return t.scale},Ds=function(t){var e=t.Monad0(),n=C(e.Bind1()),r=At(t),u=y(e.Applicative0());return function(a){return n(r(re(a.image)))(function(o){return u(b_(Ol)(o))})}};var Zn=function(t){return t.throwError};var xe=function(t){return t.lift};var N_=p(dt);var za=function(t){return t},Tn=function(t){return t};var Ur={lift:function(t){var e=_f(t)(s.create);return function(n){return za(e(n))}}};var S_=function(t){var e=p(t);return{map:function(n){return function(r){return e(N_(n))(r)}}}},P_=function(t){return{Applicative0:function(){return xo(t)},Bind1:function(){return tr(t)}}},tr=function(t){var e=C(t.Bind1()),n=y(t.Applicative0());return{bind:function(r){return function(u){return e(r)(function(a){if(a instanceof d)return n(d.value);if(a instanceof s){var o=u(a.value0);return o}throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 55, column 11 - line 57, column 42): "+[a.constructor.name])})}},Apply0:function(){return Ms(t)}}},Ms=function(t){var e=S_(t.Bind1().Apply0().Functor0());return{apply:Vn(P_(t)),Functor0:function(){return e}}},xo=function(t){return{pure:function(){var e=y(t.Applicative0());return function(n){return za(e(s.create(n)))}}(),Apply0:function(){return Ms(t)}}};var Hr=function(t){var e=y(t.Applicative0());return function(n){return za(e(n))}};var A_=xe(Ur);var xs=function(t){var e=C(tr(t)),n=Hr(t),r=A_(t);return function(u){return function(a){return function(o){return e(n(Ge(o)(u)))(function(i){return e(r(a(i)))(function(l){return n(Al(u)(tt(l))(o))})})}}}};var jl=function(t){return Je(Pl(0)(xt(t)))(t)};var W_=Pt(Xt),U_=zn(pt)(ye),H_=Bn(yt)(pt),$_=xe(Ur),q_=G(Q);var Is=function(t){var e=t.Applicative0(),n=t.Bind1().Apply0().Functor0(),r=Te(n),u=W_(e),a=yn(n),o=Ct(a),i=p(n),l=$t(a),f=Mt(a),c=C(tr(t)),v=$_(t),m=Hr(t),h=Et(a),b=xs(t),L=zt(a),W=y(xo(t)),J=se(a),it=Jt(a);return{position:tt(y(e)({x:0,y:0})),translate:function(z){return function(Z){return r(u(o(z))(Z.layers))(function(ht){return{dragIndex:Z.dragIndex,layers:ht}})}},containsPoint:function(z){return function(Z){return i(U_)(u(l(z))(Z.layers))}},draw:function(z){return function(Z){return H_(function(){var ht=Tt(z),be=f(z);return function(Ke){return ht(be(Ke))}}())(Dn(Z.layers))}},dragStart:function(z){return function(Z){return i(jt(Z))(Tn(c(v(u(l({x:z.offsetX,y:z.offsetY}))(Z.layers)))(function(ht){return c(m(bo(q_)(ht)))(function(be){return c(m(Ge(Z.layers)(be)))(function(Ke){return c(v(h(Ke)))(function(Hn){return c(b(be)(L({offsetX:z.offsetX-Hn.x,offsetY:z.offsetY-Hn.y}))(Z.layers))(function(sr){return W({dragIndex:new s(be),layers:sr})})})})})})))}},drag:function(z){return function(Z){return i(jt(Z))(Tn(c(m(Z.dragIndex))(function(ht){return c(m(Ge(Z.layers)(ht)))(function(be){return c(v(h(be)))(function(Ke){return c(b(ht)(J({translateX:z.translateX-Ke.x,translateY:z.translateY-Ke.y}))(Z.layers))(function(Hn){return W({dragIndex:Z.dragIndex,layers:Hn})})})})})))}},dragEnd:function(z){return i(jt({layers:z.layers,dragIndex:d.value}))(Tn(c(m(z.dragIndex))(function(Z){return c(b(Z)(it)(z.layers))(function(ht){return W({dragIndex:d.value,layers:ht})})})))}}},Xl=function(t){return{layers:t,dragIndex:d.value}};var Yl=function(t){var e=y(t),n=Yt(t);return{position:function(r){return e({x:r.rect.x,y:r.rect.y})},translate:function(r){return function(u){return e({fillStyle:u.fillStyle,dragOffset:u.dragOffset,rect:{width:u.rect.width,height:u.rect.height,x:u.rect.x+r.translateX,y:u.rect.y+r.translateY}})}},containsPoint:function(r){return function(u){return e(u.rect.x<=r.x&&r.x<=u.rect.x+u.rect.width&&u.rect.y<=r.y&&r.y<=u.rect.y+u.rect.height)}},draw:function(r){return function(u){return function(){return Ee(r)(u.fillStyle)(),xf(r)(fl(r)(u.rect))()}}},dragStart:function(r){return function(u){return e({rect:u.rect,fillStyle:u.fillStyle,dragOffset:new s(r)})}},drag:function(r){return function(u){return n(Yl(t))(u.dragOffset)(r)(u)}},dragEnd:function(r){return e({rect:r.rect,fillStyle:r.fillStyle,dragOffset:d.value})}}},Ql=function(t){return function(e){return{rect:t,fillStyle:e,dragOffset:d.value}}};var k_=Se(Pe),Kl=function(t){var e=t.Monad0(),n=e.Bind1(),r=C(n),u=At(t),a=k_(n),o=y(e.Applicative0());return function(i){return function(l){return r(u(re(l)))(function(f){return r(i(f))(function(c){return a(u(Sr(c)(l)))(function(){return o(c)})})})}}},Ns=function(t){var e=Ze(t.Monad0().Bind1().Apply0().Functor0()),n=Kl(t);return function(r){return function(u){return e(void 0)(n(r)(u))}}};var J_=me(hn),G_=function(t){return t};var Lo=function(t){var e=t.Monad0().Bind1(),n=me(e),r=At(t),u=Ze(e.Apply0().Functor0()),a=Kl(t);return function(o){var i=Et(o),l=Ct(o),f=$t(o),c=zt(o),v=se(o),m=Jt(o),h=Mt(o);return{position:function(b){return n(i)(r(re(b)))},translate:function(b){return function(L){return u(L)(a(l(b))(L))}},containsPoint:function(b){return function(L){return n(f(b))(r(re(L)))}},dragStart:function(b){return function(L){return u(L)(a(c(b))(L))}},drag:function(b){return function(L){return u(L)(a(v(b))(L))}},dragEnd:function(b){return u(b)(a(m)(b))},draw:function(b){return function(L){return J_(h(b))(re(L))}}}}};var Ss=function(t){var e=Ns(t);return function(n){return function(r){return e(n)(r)}}};var V_=function(t){var e=At(t);return function(n){return function(r){return e(wl(n)(r))}}},Ps=function(t){var e=Ze(t.Monad0().Bind1().Apply0().Functor0()),n=V_(t);return function(r){return function(u){return e(void 0)(n(r)(u))}}},Ga=function(t){var e=p(t.Monad0().Bind1().Apply0().Functor0()),n=At(t);return function(r){return e(G_)(n(wn(r)))}};var j_={mapLayerWrapper:function(t){return function(e){var n=Te(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(r(u.layer))(function(a){return{offsetY:u.offsetY,gridSizeY:u.gridSizeY,layer:a}})}}}}},X_=Xn(j_),Y_={mapLayerWrapper:function(t){return function(e){var n=Te(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(r(u.layer))(function(a){return{offsetX:u.offsetX,gridSizeX:u.gridSizeX,layer:a}})}}}}},Q_=Xn(Y_);var Zl=function(t){return function(e){return function(n){return{layer:n,gridSizeY:e,offsetY:t}}}},Ws=function(t){return function(e){return function(n){return{layer:n,gridSizeX:e,offsetX:t}}}};var K_=function(t){var e=Et(t),n=se(t);return function(r){var u=C(r.Bind1());return function(a){return function(o){return function(i){return function(l){return u(e(l))(function(f){var c=a+o*Ir((f.y+i.translateY-a)/o);return n({translateX:i.translateX,translateY:c-f.y})(l)})}}}}}},Us=function(t){var e=Et(t),n=X_(t),r=Ct(t),u=$t(t),a=zt(t),o=K_(t),i=Jt(t),l=Mt(t);return function(f){var c=n(f),v=o(f);return{position:function(m){return e(m.layer)},translate:function(m){return c(r(m))},containsPoint:function(m){return function(h){return u(m)(h.layer)}},dragStart:function(m){return c(a(m))},drag:function(m){return function(h){return c(v(h.offsetY)(h.gridSizeY)(m))(h)}},dragEnd:c(i),draw:function(m){return function(h){return l(m)(h.layer)}}}}},Z_=function(t){var e=Et(t),n=se(t);return function(r){var u=C(r.Bind1());return function(a){return function(o){return function(i){return function(l){return u(e(l))(function(f){var c=a+o*Ir((f.x+i.translateX-a)/o);return n({translateX:c-f.x,translateY:i.translateY})(l)})}}}}}},Hs=function(t){var e=Et(t),n=Q_(t),r=Ct(t),u=$t(t),a=zt(t),o=Z_(t),i=Jt(t),l=Mt(t);return function(f){var c=n(f),v=o(f);return{position:function(m){return e(m.layer)},translate:function(m){return c(r(m))},containsPoint:function(m){return function(h){return u(m)(h.layer)}},dragStart:function(m){return c(a(m))},drag:function(m){return function(h){return c(v(h.offsetX)(h.gridSizeX)(m))(h)}},dragEnd:c(i),draw:function(m){return function(h){return l(m)(h.layer)}}}}};var lt=function(t){return t};function $s(t){return t.split(/\r\n|[\n\v\f\r\u0085\u2028\u2029]/)}function qs(t){return t.split(/[\u000a-\u000d\u0085\u2028\u2029\u0009\u0020\u00a0\u1680\u2000-\u200a\u202f\u205f\u3000]+/)}var oF=typeof Array.from=="function",ag=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",aF=typeof String.prototype.fromCodePoint=="function",ug=typeof String.prototype.codePointAt=="function",Os=function(t){return ug?function(e){return e.codePointAt(0)}:t},Bs=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){var o=a.length;if(u<0||u>=o)return n;if(ag)for(var i=a[Symbol.iterator](),l=u;;--l){var f=i.next();if(f.done)return n;if(l===0)return e(r(f.value))}return t(u)(a)}}}}}};function En(t){return t.charCodeAt(0)}function ks(t){return String.fromCharCode(t)}var Gs=vn(to),Vs=tn(to);var cn=function(t){return t.toEnum};var Mn=function(t){return t.fromEnum};var er=function(t){return function(e){return function(n){return t(e(n)+1|0)}}},nr=function(t){return function(e){return function(n){return t(e(n)-1|0)}}};var ti=function(t){return t>=En(Gs)&&t<=En(Vs)?new s(ks(t)):d.value},pg={succ:er(ti)(En),pred:nr(ti)(En),Ord0:function(){return da}};var No=function(){return{cardinality:En(Vs)-En(Gs)|0,toEnum:ti,fromEnum:En,Bounded0:function(){return to},Enum1:function(){return pg}}}();var ei=function(t){return t.join("")};var xn=function(t){return t.length};var rr=function(t){return function(e){return e.substring(t)}};var Ln=function(t){return function(e){if(t>=0&&t<e.length)return e.charAt(t);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var yg=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}},So=Mn(No);var Dg=k(fe);var Ys=function(t){return function(e){return(((t-55296|0)*1024|0)+(e-56320|0)|0)+65536|0}};var Qs=function(t){return 56320<=t&&t<=57343},Ks=function(t){return 55296<=t&&t<=56319},Va=function(t){var e=xn(t);if(e===0)return d.value;if(e===1)return new s({head:So(Ln(0)(t)),tail:""});var n=So(Ln(1)(t)),r=So(Ln(0)(t)),u=Ks(r)&&Qs(n);return u?new s({head:Ys(r)(n),tail:rr(2)(t)}):new s({head:r,tail:rr(1)(t)})};var Fg=function(t){var e=So(Ln(0)(t)),n=Ks(e)&&xn(t)>1;if(n){var r=So(Ln(1)(t)),u=Qs(r);return u?Ys(e)(r):e}return e},Xs=Os(Fg);var ri={eq:function(t){return function(e){return t===e}}},oi={compare:function(t){return function(e){return Dg(t)(e)}},Eq0:function(){return ri}};var wg=function(t){return function(e){var n=t,r=!1,u;function a(o,i){var l=Va(i);if(l instanceof s){var f=o===0;if(f)return r=!0,new s(l.value0.head);n=o-1|0,e=l.value0.tail;return}return r=!0,d.value}for(;!r;)u=a(n,e);return u}},Zs=function(t){return function(e){return t<0?d.value:t===0&&e===""?d.value:t===0?new s(Xs(e)):Bs(wg)(s.create)(d.value)(Xs)(t)(e)}},bg={bottom:0,top:1114111,Ord0:function(){return oi}},or=function(){return{cardinality:1114112,fromEnum:function(t){return t},toEnum:function(t){if(t>=0&&t<=1114111)return new s(t);if(Ut)return d.value;throw new Error("Failed pattern match at Data.String.CodePoints (line 63, column 1 - line 68, column 26): "+[t.constructor.name])},Bounded0:function(){return bg},Enum1:function(){return Tg(0)}}}(),Tg=yg("enumCodePoint","Data.String.CodePoints",function(){return{succ:er(cn(or))(Mn(or)),pred:nr(cn(or))(Mn(or)),Ord0:function(){return oi}}});var Xa=function(t){return qs(t)};var qr=function(t){return $s(t)};var Ya=t=>e=>()=>t.measureText(e);var Qa=Pt(Xt)(yt),Ug=gt(pt),Hg=p(It),ad=p(A),$g=io(Zr)(pt),nd=E(pa),qg=lo(yt)(pt);var Ka=function(t){return function(e){return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,fontName:e.fontName,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:t}}};var Po=function(t){return function(e){return function(){var r=Ya(t)(e)();return r.width}}},Og=function(t){return function(e){return function(n){var r=Xa(n);return function(){var a=Qa(Po(t))(r)(),o=Po(t)(" ")(),i=function(c){return function(v){if(c.value1.value0.length===0)return new M(c.value0,new M([v.value0],v.value1));var m=c.value1.value1+o+v.value1>e;return m?new M(Wt(c.value0)(c.value1.value0),new M([v.value0],v.value1)):new M(c.value0,new M(Wt(c.value1.value0)(v.value0),c.value1.value1+o+v.value1))}},l=Ug(i)(new M([],new M([],0)))(Je(r)(a)),f=Hg(Jn(" "))(l.value0);return l.value1.value0.length===0?f:Wt(f)(Jn(" ")(l.value1.value0))}}}},rd=function(t){return function(e){return function(n){return ad(Fn)(Qa(Og(t)(e))(qr(n)))}}},ii=function(t){return function(e){return function(){var r=Ya(t)(e)();return r.actualBoundingBoxAscent+r.actualBoundingBoxDescent}}};var od=function(t){return function(e){return ad(function(){var n=jt(0);return function(r){return n($g(r))}}())(Qa(ii(t))(e))}},Za=function(t){var e=t.Monad0().Applicative0(),n=y(e),r=At(t),u=Yt(e);return{position:function(a){return n(a.position)},translate:function(a){return function(o){return n({text:o.text,maxWidth:o.maxWidth,fillStyle:o.fillStyle,fontName:o.fontName,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,letterSpacing:o.letterSpacing,dragOffset:o.dragOffset,context:o.context,position:ke(a)(o.position)})}},containsPoint:function(a){return function(o){return r(Tt(o.context)(function(){Ee(o.context)(o.fillStyle)(),Tr(o.context)(o.fontStyle+(" "+(o.fontWeight+(" "+(nd(o.fontSize)+("px "+o.fontName))))))(),xr(o.context)(o.baseline)(),Lr(o.context)(o.align)(),Kn(o.context)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return rd(o.context)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return qr(o.text);throw new Error("Failed pattern match at Template.Layer.Text (line 70, column 14 - line 72, column 44): "+[o.maxWidth.constructor.name])}(),f=Qa(Po(o.context))(l)(),c=od(o.context)(l)();return et(To)(jl(f))(function(v){var m=function(){return o.baseline instanceof De?o.position.y+c*o.lineHeight*lt(v.value0):o.baseline instanceof Me?o.position.y-c-lt((xt(l)-v.value0|0)-1|0)*c*o.lineHeight:o.position.y+c*o.lineHeight*lt(v.value0)}();if(o.align instanceof Er||o.align instanceof ne)return o.position.x<=a.x&&a.x<=o.position.x+v.value1&&m<=a.y&&a.y<=m+c;if(o.align instanceof Mr||o.align instanceof Rn)return o.position.x-v.value1<=a.x&&a.x<=o.position.x&&m<=a.y&&a.y<=m+c;if(o.align instanceof Cr)return o.position.x-v.value1/2<=a.x&&a.x<=o.position.x+v.value1/2&&m<=a.y&&a.y<=m+c;throw new Error("Failed pattern match at Template.Layer.Text (line 84, column 7 - line 99, column 41): "+[o.align.constructor.name])})}))}},dragStart:function(a){return function(o){return n({text:o.text,position:o.position,maxWidth:o.maxWidth,fillStyle:o.fillStyle,fontName:o.fontName,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,letterSpacing:o.letterSpacing,context:o.context,dragOffset:new s(a)})}},drag:function(a){return function(o){return u(Za(t))(o.dragOffset)(a)(o)}},dragEnd:function(a){return n({text:a.text,position:a.position,maxWidth:a.maxWidth,fillStyle:a.fillStyle,fontName:a.fontName,fontSize:a.fontSize,fontStyle:a.fontStyle,fontWeight:a.fontWeight,align:a.align,baseline:a.baseline,lineHeight:a.lineHeight,letterSpacing:a.letterSpacing,context:a.context,dragOffset:d.value})},draw:function(a){return function(o){return Tt(a)(function(){Ee(a)(o.fillStyle)(),Tr(a)(o.fontStyle+(" "+(o.fontWeight+(" "+(nd(o.fontSize)+("px "+o.fontName))))))(),xr(a)(o.baseline)(),Lr(a)(o.align)(),Kn(a)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return rd(a)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return qr(o.text);throw new Error("Failed pattern match at Template.Layer.Text (line 112, column 14 - line 114, column 44): "+[o.maxWidth.constructor.name])}(),f=od(a)(l)();return qg(jl(l))(function(c){var v=function(){return o.baseline instanceof De?o.position.y+lt(c.value0)*f*o.lineHeight:o.baseline instanceof Me?o.position.y-lt((xt(l)-c.value0|0)-1|0)*f*o.lineHeight:o.position.y+lt(c.value0)*f*o.lineHeight}();return go(a)(c.value1)(o.position.x)(v)})()})}}}};var ud=function(t){return t};var Qg=ud;var fi=function(t){return t};var sd=function(t){if(xt(t)>0)return new s(Qg(t));if(Ut)return d.value;throw new Error("Failed pattern match at Data.Array.NonEmpty (line 161, column 1 - line 161, column 58): "+[t.constructor.name])};var Br=function(t){var e=null;return function(){return t===void 0||(e=t(),t=void 0),e}},Uo=function(t){return t()};var ah=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}};var uh=qn();var fn=function(){function t(e,n,r){this.value0=e,this.value1=n,this.value2=r}return t.create=function(e){return function(n){return function(r){return new t(e,n,r)}}},t}(),sn=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var dd=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),pd=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),pi=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var vd={defer:function(t){var e=Br(t);return function(n,r,u,a,o){var i=Uo(e);return i(n,r,u,a,o)}}};var ar={map:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return e(n,r,u,a,function(l,f){return r(function(c){return o(l,t(f))})})})}}}};var In={alt:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return t(new fn(n.value0,n.value1,!1),r,u,function(l,f){return r(function(c){return l.value2?a(l,f):e(n,r,u,a,o)})},o)})}}},Functor0:function(){return ar}},lh=function(t){return function(e,n,r,u,a){var o=t(e);return a(o.value1,o.value0)}};var ih=function(t){var e=t.Monad0(),n=p(e.Bind1().Apply0().Functor0()),r=y(e.Applicative0()),u=an(t);return function(a){return function(o){var i=function(l){var f=!1,c;function v(m){var h=m(void 0);if(h instanceof dd){l=h.value0;return}if(h instanceof pd)return f=!0,n(oe.create)(h.value0);if(h instanceof pi)return f=!0,r(new ae(new M(h.value1,h.value0)));throw new Error("Failed pattern match at Parsing (line 160, column 13 - line 166, column 32): "+[h.constructor.name])}for(;!f;)c=v(l);return c};return u(i)(function(l){return o(a,dd.create,pd.create,function(f,c){return new pi(f,new Rt(c))},function(f,c){return new pi(f,new mt(c))})})}}},md=lh(function(t){return new M(t.value1,t)});var ch={index:0,line:1,column:1},fh=function(t){var e=p(t.Monad0().Bind1().Apply0().Functor0()),n=ih(t);return function(r){return function(u){var a=new fn(r,ch,!1);return e(rn)(n(a)(u))}}},sh=fh(Xf),_d=function(t){var e=sh(t);return function(n){return uh(e(n))}};var eu=function(t){return function(e){return t.value2&&!e.value2?new fn(e.value0,e.value1,!0):e}},Nn={apply:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return t(n,r,u,a,function(l,f){return r(function(c){var v=eu(n)(l);return e(v,r,u,a,function(m,h){return r(function(b){return o(eu(v)(m),f(h))})})})})})}}},Functor0:function(){return ar}};var kr={pure:function(t){return function(e,n,r,u,a){return a(e,t)}},Apply0:function(){return Nn}};var ur={bind:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return t(n,r,u,a,function(l,f){return r(function(c){var v=e(f);return v(eu(n)(l),r,u,a,o)})})})}}},Apply0:function(){return Nn}},dh=me(ur);var gd={Applicative0:function(){return kr},Bind1:function(){return ur}};var mi={throwError:function(t){return function(e,n,r,u,a){return u(e,t)}},Monad0:function(){return gd}},ph=Zn(mi),vh=function(t){return function(e){return ph(new sn(t,e))}},zr=function(t){return dh(vh(t))(md)};var nu={tailRecM:function(t){return function(e){return function(n,r,u,a,o){var i=ah("loop","Parsing",function(){return function(f,c,v){var m=t(c);return m(f,r,u,a,function(h,b){var L=eu(f)(h);if(b instanceof oe){var W=v===0;return W?r(function(J){return i(288)(L,b.value0,30)}):i(290)(L,b.value0,v-1|0)}if(b instanceof ae)return o(L,b.value0);throw new Error("Failed pattern match at Parsing (line 284, column 19 - line 292, column 46): "+[b.constructor.name])})}}),l=i(279);return l(n,e,30)}}},Monad0:function(){return gd}};var Ve=function(){function t(){}return t.value=new t,t}(),je=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var Jr={foldr:function(t){return function(e){var n=function(){var u=function(a){return function(o){var i=a,l=!1,f;function c(v,m){if(m instanceof Ve)return l=!0,v;if(m instanceof je){i=new je(m.value0,v),o=m.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[v.constructor.name,m.constructor.name])}for(;!l;)f=c(i,o);return f}};return u(Ve.value)}(),r=gt(Jr)(et(t))(e);return function(u){return r(n(u))}}},foldl:function(t){var e=function(n){return function(r){var u=n,a=!1,o;function i(l,f){if(f instanceof Ve)return a=!0,l;if(f instanceof je){u=t(l)(f.value0),r=f.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[f.constructor.name])}for(;!a;)o=i(u,r);return o}};return e},foldMap:function(t){var e=$(t.Semigroup0()),n=_t(t);return function(r){return gt(Jr)(function(u){var a=e(u);return function(o){return a(r(o))}})(n)}}};var bd=Ft(In),zh=$n(vd);var Jh=le(Nn);var Gh=nc(Nn);var Td=function(t){return function(e){return bd(t)(zh(function(n){return zr("Expected "+e(void 0))}))}},_i=function(t){return function(e){return bd(t)(zr("Expected "+e))}};var Gr=function(t){return function(e,n,r,u,a){return t(e,n,r,function(o,i){return u(new fn(o.value0,o.value1,e.value2),i)},a)}};var qo=function(t){return function(e){return function(n){return Gh(Jh(t)(n))(e)}}};var hi=C(ur),Vh=an(nu),jh=Ft(In),ru=y(kr),Xh=Wl(Jr);var Yh=function(t){return hi(et(Vh)(Ve.value)(function(e){return jh(hi(t)(function(n){return ru(new oe(new je(n,e)))}))(ru(new ae(e)))}))(function(e){return ru(Dn(Xh(e)))})},Ri=function(t){return hi(Yh(t))(function(e){var n=sd(e);if(n instanceof d)return zr("Expected at least 1");if(n instanceof s)return ru(n.value0);throw new Error("Failed pattern match at Parsing.Combinators.Array (line 55, column 3 - line 57, column 25): "+[n.constructor.name])})};var yi=Mn(or),Kh=ro(ha),Zh=$e(),t0=cn(No);var e0=E(va);var Di=function(t){return function(e){return function(n){var r=yi(e);if(r===10)return{index:t.index+1|0,line:t.line+1|0,column:1};if(r===13){var u=Zs(0)(n);return u instanceof s&&yi(u.value0)===10?{index:t.index+1|0,line:t.line,column:t.column}:{index:t.index+1|0,line:t.line+1|0,column:1}}return r===9?{index:t.index+1|0,line:t.line,column:(t.column+8|0)-Kh(t.column-1|0)(8)|0}:{index:t.index+1|0,line:t.line,column:t.column+1|0}}}},n0=function(t){return function(e){return function(n){var r=t,u=e,a=!1,o;function i(l,f,c){var v=Va(f);if(v instanceof d)return a=!0,l;if(v instanceof s){var m=function(){if(wr(v.value0.tail))return Di(l)(v.value0.head)(c);if(Ut)return Di(l)(v.value0.head)(v.value0.tail);throw new Error("Failed pattern match at Parsing.String (line 165, column 7 - line 167, column 52): ")}();r=m,u=v.value0.tail,n=c;return}throw new Error("Failed pattern match at Parsing.String (line 161, column 36 - line 168, column 38): "+[v.constructor.name])}for(;!a;)o=i(r,u,n);return o}}};var Fi=function(t){return Ro(function(e){return function(n){return function(r){return function(u){return function(a){var o=Va(e.value0);if(o instanceof d)return u(e,new sn("Unexpected EOF",e.value1));if(o instanceof s){var i=yi(o.value0.head),l=i<0||i>65535;if(l)return u(e,new sn("Expected Char",e.value1));var f=Zh(t0(i)),c=t(f);return c?a(new fn(o.value0.tail,Di(e.value1)(o.value0.head)(o.value0.tail),!0),f):u(e,new sn("Predicate unsatisfied",e.value1))}throw new Error("Failed pattern match at Parsing.String (line 114, column 7 - line 129, column 75): "+[o.constructor.name])}}}}})};var wi=Ro(function(t){return function(e){return function(n){return function(r){return function(u){var a=wr(t.value0);return a?u(new fn(t.value0,t.value1,!0),void 0):r(t,new sn("Expected EOF",t.value1))}}}}}),Ed=function(t){return Ro(function(e){return function(n){return function(r){return function(u){return function(a){var o=t(e.value0);if(o instanceof Rt)return u(e,new sn(o.value0,e.value1));if(o instanceof mt)return a(new fn(o.value0.remainder,n0(e.value1)(o.value0.consumed)(o.value0.remainder),!wr(o.value0.consumed)),o.value0.value);throw new Error("Failed pattern match at Parsing.String (line 286, column 7 - line 290, column 121): "+[o.constructor.name])}}}}})};var bi=Ed(function(t){return new mt({value:t,consumed:t,remainder:""})});var de=function(t){return _i(Fi(function(e){return e===t}))(e0(t))};var c0=E(Hu(va));var f0=Hl(ia);var Ld=function(t){return Td(Fi(et(f0)(t)))(function(e){return"none of "+c0(t)})};function ou(t,e){var n={};for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r]);for(var u in t)({}).hasOwnProperty.call(t,u)&&(n[u]=t[u]);return n}var au=function(){return function(){return function(t){return function(e){return ou(t,e)}}}};var v0=E(pa),uu=$(We),Oo=Te(It),Ud=gt(pt),Ei=p(A),m0=io(Zr)(pt),lr=Pt(Xt)(yt),lu=Yu(pt)(Ue),Xe=p(It),_0=y(yt),g0=p(dt),we=p(ar),Ye=Ft(In),fu=le(Nn),h0=au()(),R0=df(yt)(Xt),y0=G(Q),Ti=lo(yt)(pt),Hd=Ze(ar);var su=function(){function t(){}return t.value=new t,t}(),$d=function(){function t(){}return t.value=new t,t}(),du=function(){function t(){}return t.value=new t,t}(),qd=function(){function t(){}return t.value=new t,t}();var Od=function(t){return t.text},D0=function(t){return function(e){return function(n){return{line:Wt(e.line)(n),width:e.width+t+n.width}}}},Mi=function(t){return function(e){return function(n){var r=function(){if(n.weight instanceof su)return e.weight.normal;if(n.weight instanceof $d)return e.weight.bold;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 295, column 14 - line 297, column 37): "+[n.weight.constructor.name])}(),u=function(){if(n.style instanceof du)return e.style.normal;if(n.style instanceof qd)return e.style.italic;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 292, column 13 - line 294, column 39): "+[n.style.constructor.name])}();return Tr(t)(u+(" "+(r+(" "+(v0(e.size)+("px "+e.name))))))}}},Bd=function(t){return function(e){return{text:e.text,position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,font:{name:e.font.name,style:e.font.style,weight:e.font.weight,size:t}}}},F0=function(t){return wr(Od(t.fragment))},w0=function(t){return Oa(F0)(t.word)},b0=function(t){return Oa(w0)(t.line)};var kd=function(t){return function(e){var n=function(u){return function(a){var o=wo(1)(t(a.text));if(o.before.length===1&&o.before[0]===""&&o.after.length===0)return{splits:u.splits,split:u.split};if(o.before.length===1&&o.after.length===0)return{splits:u.splits,split:Wt(u.split)({style:a.style,weight:a.weight,text:o.before[0]})};if(o.before.length===1&&o.before[0]===""){var i=wo(xt(o.after)-1|0)(o.after);return i.after.length===1&&i.after[0]===""?{splits:uu(Wt(u.splits)(u.split))(Oo(i.before)(function(l){return[{style:a.style,weight:a.weight,text:l}]})),split:[]}:i.after.length===1?{splits:uu(Wt(u.splits)(u.split))(Oo(i.before)(function(l){return[{style:a.style,weight:a.weight,text:l}]})),split:[{style:a.style,weight:a.weight,text:i.after[0]}]}:{splits:u.splits,split:u.split}}if(o.before.length===1){var i=wo(xt(o.after)-1|0)(o.after);return i.after.length===1&&i.after[0]===""?{splits:uu(Wt(u.splits)(Wt(u.split)({style:a.style,weight:a.weight,text:o.before[0]})))(Oo(i.before)(function(f){return[{style:a.style,weight:a.weight,text:f}]})),split:[]}:i.after.length===1?{splits:uu(Wt(u.splits)(Wt(u.split)({style:a.style,weight:a.weight,text:o.before[0]})))(Oo(i.before)(function(f){return[{style:a.style,weight:a.weight,text:f}]})),split:[{style:a.style,weight:a.weight,text:i.after[0]}]}:{splits:u.splits,split:u.split}}return{splits:u.splits,split:u.split}}},r=Ud(n)({splits:[],split:[]})(e);return Wt(r.splits)(r.split)}},zd=kd(Xa),xi=function(t){return{text:t,style:du.value,weight:su.value}};var T0=function(t){return function(e){return{fragment:t,width:e}}},Jd=function(t){return function(e){return function(n){return Tt(t)(function(){return Mi(t)(e)(n)(),Po(t)(n.text)()})}}},Li=function(t){return function(e){return Jd(t)(e)({style:du.value,weight:su.value,text:" "})}},C0=function(t){return function(e){return function(n){return Tt(t)(function(){return Mi(t)(e)(n)(),ii(t)(n.text)()})}}},E0=function(t){return function(e){return function(n){return Ei(function(){var r=jt(0);return function(u){return r(m0(u))}}())(lr(C0(t)(e))(n))}}},M0=function(t){return function(e){return function(n){return Ei(T0(n))(Jd(t)(e)(n))}}},Gd=function(t){return function(e){return function(n){return function(){var u=lr(M0(t)(e))(n)(),a=lu(Xe(function(o){return o.width})(u));return{word:u,width:a}}}}},Nd=function(t){return function(e){return function(n){var r=zd(n);return function(){var a=lr(Gd(t)(e))(r)(),o=Li(t)(e)(),i=o*lt(xt(a)-1|0)+lu(Xe(function(l){return l.width})(a));return{line:a,width:i}}}}},x0=function(t){return function(e){return function(n){return function(r){var u=zd(r);return function(){var o=lr(Gd(t)(e))(u)(),i=Li(t)(e)(),l=function(c){return function(v){if(c.value1.line.length===0)return new M(c.value0,{line:[v],width:v.width});var m=c.value1.width+i+v.width>n;return m?new M(Wt(c.value0)(c.value1),{line:[v],width:v.width}):new M(c.value0,D0(i)(c.value1)(v))}},f=Ud(l)(new M([],{line:[],width:0}))(o);return f.value1.line.length===0?f.value0:Wt(f.value0)(f.value1)}}}}},Ii=function(t){return function(e){return{text:e.text,position:e.position,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,maxWidth:g0(t)(e.maxWidth)}}},Bo=function(){var t=we(fi);return function(e){return t(Ri(e))}}(),ko=we(function(t){return xi(ei(t))})(Bo(Ld(["_","*"]))),Ci=kd(qr),Sd=function(t){return function(e){return function(n){return function(r){return Ei(Fn)(lr(x0(t)(e)(n))(Ci(r)))}}}},iu=function(t){return{text:t.text,weight:t.weight,style:qd.value}},Pd=Ye(Gr(qo(de("_"))(de("_"))(we(iu)(ko))))(Ye(ko)(fu(de("_"))(we(function(t){return iu(xi(t))})(bi)))),L0=function(t){return t.fragment},I0=function(t){return Xe(L0)(t.word)},N0=function(t){return Xe(I0)(t.line)},Ad=function(t){return function(e){return function(n){return function(r){return function(){var a=E0(t)(e)(Fn(vs(N0)(r)))();return Oo(r)(function(o){return h0(o)({height:function(){var i=b0(o);return i?n*e.size:a}()})})}}}}},pu=function(t){var e=t.Monad0().Applicative0(),n=y(e),r=At(t),u=Yt(e);return{position:function(a){return n(a.position)},translate:function(a){return function(o){return n({text:o.text,maxWidth:o.maxWidth,fillStyle:o.fillStyle,font:o.font,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,emptyLineHeight:o.emptyLineHeight,letterSpacing:o.letterSpacing,dragOffset:o.dragOffset,context:o.context,position:ke(a)(o.position)})}},containsPoint:function(a){return function(o){return r(Tt(o.context)(function(){Ee(o.context)(o.fillStyle)(),xr(o.context)(o.baseline)(),Lr(o.context)(o.align)(),Kn(o.context)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return Sd(o.context)(o.font)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return lr(Nd(o.context)(o.font))(Ci(o.text))();throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 199, column 15 - line 201, column 89): "+[o.maxWidth.constructor.name])}(),f=Ad(o.context)(o.font)(o.emptyLineHeight)(l)(),c=lu(Xe(function(h){return h.height})(f))+(o.lineHeight-1)*o.font.size*lt(xt(f)-1|0),v=Qn(0)(Ar(function(h){return function(b){return h+b.height+(o.lineHeight-1)*o.font.size}})(0)(f)),m=R0(Je(f)(v))(function(h){var b=function(){return o.baseline instanceof De?o.position.y+h.value1:o.baseline instanceof Me?o.position.y+h.value1-c:o.position.y+h.value1}();return _0(function(){if(o.align instanceof Er||o.align instanceof ne)return o.position.x<=a.x&&a.x<=o.position.x+h.value0.width&&b<=a.y&&a.y<=b+h.value0.height;if(o.align instanceof Mr||o.align instanceof Rn)return o.position.x-h.value0.width<=a.x&&a.x<=o.position.x&&b<=a.y&&a.y<=b+h.value0.height;if(o.align instanceof Cr)return o.position.x-h.value0.width/2<=a.x&&a.x<=o.position.x+h.value0.width/2&&b<=a.y&&a.y<=b+h.value0.height;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 217, column 14 - line 237, column 33): "+[o.align.constructor.name])}())})();return To(y0)(m)}))}},dragStart:function(a){return function(o){return n({text:o.text,position:o.position,maxWidth:o.maxWidth,fillStyle:o.fillStyle,font:o.font,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,emptyLineHeight:o.emptyLineHeight,letterSpacing:o.letterSpacing,context:o.context,dragOffset:new s(a)})}},drag:function(a){return function(o){return u(pu(t))(o.dragOffset)(a)(o)}},dragEnd:function(a){return n({text:a.text,position:a.position,maxWidth:a.maxWidth,fillStyle:a.fillStyle,font:a.font,align:a.align,baseline:a.baseline,lineHeight:a.lineHeight,emptyLineHeight:a.emptyLineHeight,letterSpacing:a.letterSpacing,context:a.context,dragOffset:d.value})},draw:function(a){return function(o){return Tt(a)(function(){Ee(a)(o.fillStyle)(),xr(a)(o.baseline)(),Lr(a)(ne.value)(),Kn(a)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return Sd(a)(o.font)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return lr(Nd(a)(o.font))(Ci(o.text))();throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 252, column 15 - line 254, column 83): "+[o.maxWidth.constructor.name])}(),f=Ad(a)(o.font)(o.emptyLineHeight)(l)(),c=lu(Xe(function(m){return m.height})(f))+(o.lineHeight-1)*o.font.size*lt(xt(f)-1|0),v=Qn(0)(Ar(function(m){return function(h){return m+h.height+(o.lineHeight-1)*o.font.size}})(0)(f));return Ti(Je(f)(v))(function(m){var h=function(){return o.baseline instanceof De?o.position.y+m.value1:o.baseline instanceof Me?o.position.y+m.value1-c+m.value0.height:o.position.y+m.value1}(),b=function(){if(o.align instanceof Er||o.align instanceof ne)return o.position.x;if(o.align instanceof Mr||o.align instanceof Rn)return o.position.x-m.value0.width;if(o.align instanceof Cr)return o.position.x-m.value0.width/2;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 273, column 16 - line 278, column 57): "+[o.align.constructor.name])}();return function(){var W=Li(a)(o.font)(),J=Qn(0)(Ar(function(it){return function(z){return it+W+z.width}})(0)(m.value0.line));return Ti(Je(m.value0.line)(J))(function(it){var z=Qn(0)(Ar(function(Z){return function(ht){return Z+ht.width}})(0)(it.value0.word));return Ti(Je(it.value0.word)(z))(function(Z){return function(){return Mi(a)(o.font)(Z.value0.fragment)(),go(a)(Od(Z.value0.fragment))(b+it.value1+Z.value1)(h)()}})})()}})()})}}}},cu=function(t){return{text:t.text,style:t.style,weight:$d.value}},S0=Ye(Gr(qo(de("*"))(de("*"))(we(Xe(cu))(Bo(Pd)))))(fu(de("*"))(Ye(Hd([])(wi))(we(Xe(cu))(Bo(Pd))))),Wd=Ye(Gr(qo(de("*"))(de("*"))(we(cu)(ko))))(Ye(ko)(fu(de("*"))(we(function(t){return cu(xi(t))})(bi)))),P0=Ye(Gr(qo(de("_"))(de("_"))(we(Xe(iu))(Bo(Wd)))))(fu(de("_"))(Ye(Hd([])(wi))(we(Xe(iu))(Bo(Wd))))),A0=we(function(t){return Fn(fi(t))})(Ri(Ye(P0)(Ye(S0)(we(Sl)(ko)))));var zo=function(t){return function(e){var n=_d(t)(A0);if(n instanceof mt)return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:n.value0};if(n instanceof Rt)return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:[{text:t,style:du.value,weight:su.value}]};throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 177, column 37 - line 179, column 106): "+[n.constructor.name])}};var jd=function(t){return t},Xd=function(t){return t},Yd=function(t){return t},W0={mapLayerWrapper:function(t){return function(e){var n=p(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(jd)(r(u))}}}}},U0=Xn(W0);var H0={mapLayerWrapper:function(t){return function(e){var n=p(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(Xd)(r(u))}}}}},$0=Xn(H0);var q0={mapLayerWrapper:function(t){return function(e){var n=p(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(Yd)(r(u))}}}}},O0=Xn(q0);var Qd=function(t){return function(e){var n=Et(e),r=U0(e)(t),u=$t(e),a=zt(e),o=se(e),i=Mt(e);return{position:function(l){return n(l)},translate:function(){var l=Ct(e);return function(f){return r(l(f))}}(),containsPoint:function(l){return function(f){return u(l)(f)}},dragStart:function(l){return r(a({offsetX:l.offsetX,offsetY:0}))},drag:function(l){return r(o({translateX:l.translateX,translateY:0}))},dragEnd:r(Jt(e)),draw:function(l){return function(f){return i(l)(f)}}}}},Kd=function(t){return function(e){var n=Et(e),r=$0(e)(t),u=$t(e),a=zt(e),o=se(e),i=Mt(e);return{position:function(l){return n(l)},translate:function(){var l=Ct(e);return function(f){return r(l(f))}}(),containsPoint:function(l){return function(f){return u(l)(f)}},dragStart:function(l){return r(a({offsetX:0,offsetY:l.offsetY}))},drag:function(l){return r(o({translateX:0,translateY:l.translateY}))},dragEnd:r(Jt(e)),draw:function(l){return function(f){return i(l)(f)}}}}},Zd=function(t){var e=y(t.Applicative0());return function(n){var r=Et(n),u=$t(n),a=Mt(n);return{position:function(o){return r(o)},translate:function(){var o=O0(n)(t),i=Ct(n);return function(l){return o(i(l))}}(),containsPoint:function(o){return function(i){return u(o)(i)}},dragStart:tt(e),drag:tt(e),dragEnd:e,draw:function(o){return function(i){return a(o)(i)}}}}};var tp=jd,Ni=Xd,Sn=Yd;var ir=function(t){return function(e){return function(){return e[t]}}},k0=ir("URL"),z0=ir("documentURI"),J0=ir("origin"),G0=ir("compatMode"),V0=ir("characterSet"),j0=ir("contentType");var X0=ir("documentElement");function Jo(t){return function(e){return function(){return e.createElement(t)}}}function ep(t,e,n){return t==null?e:n(t)}var at=function(t){return ep(t,d.value,s.create)};function np(t,e,n,r){if(typeof window<"u"){var u=window[n];if(u!=null&&r instanceof u)return e(r)}for(var a=r;a!=null;){var o=Object.getPrototypeOf(a),i=o.constructor.name;if(i===n)return e(r);if(i==="Object")return t;a=o}return t}var F=function(t){return function(e){return np(d.value,s.create,t,e)}};var vu=function(t){return function(e){return e[t]}},n2=vu("namespaceURI"),r2=vu("prefix"),o2=vu("localName"),a2=vu("tagName");function cr(t){return function(e){return function(n){return function(){n.setAttribute(t,e)}}}}function Si(t){return function(){var e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}}var mu=function(t){return function(e){return function(){return e[t]}}},l2=mu("children"),i2=mu("firstElementChild"),c2=mu("lastElementChild"),f2=mu("childElementCount");var op=_,pe=_;var Ie=function(t){return function(e){return function(){return e[t]}}};var m2=Ie("baseURI"),_2=Ie("ownerDocument"),g2=Ie("parentNode"),h2=Ie("parentElement");var R2=Ie("childNodes"),y2=Ie("firstChild"),D2=Ie("lastChild"),F2=Ie("previousSibling"),w2=Ie("nextSibling"),b2=Ie("nodeValue");var T2=Ie("textContent");function Pi(t){return function(e){return function(){e.appendChild(t)}}}function ap(t){return function(e){return function(){return e.getElementById(t)}}}var I2=p(A),Pn=function(t){var e=I2(at),n=ap(t);return function(r){return e(n(r))}};function Qt(t){return function(){return function(e){return t(e)()}}}function Kt(t){return function(e){return function(n){return function(r){return function(){return r.addEventListener(t,e,n)}}}}}var up=_;function lp(t){return function(e){return e.item(t)}}var q2=p(dt),O2=function(t){var e=lp(t);return function(n){return at(e(n))}},ip=function(t){var e=un(t);return function(n){return e(function(r){return q2(et(M.create)(r+1|0))(O2(r)(n))})(0)}};function Ai(t){return function(){return URL.createObjectURL(t)}}var Wi=function(){return window};function cp(t){return t.body}var X2=p(A);var An=_;var fp=_,_u=_;var sp=function(t){return X2(at)(function(){return cp(t)})};function dp(t,e,n){var r=Object.prototype.toString.call(n);return r.indexOf("[object HTML")===0&&r.indexOf("Element]")===r.length-8?e(n):t}function gu(t){return function(){return t.click()}}function Ui(t){return function(){return t.offsetWidth}}function Hi(t){return function(){return t.offsetHeight}}var pp=_;var vp=_;var hu=function(t){return dp(d.value,s.create,t)};function gp(t){return function(){return t.files}}function Vr(t){return function(){return t.value}}var ER=p(A);var Ru=F("HTMLInputElement");var $i=function(){var t=ER(at);return function(e){return t(gp(e))}}();function yu(t){return function(){return t.value}}var Rp=F("HTMLTextAreaElement");function qi(t){return function(){return t.document}}function Go(t){return t.clientX}function Vo(t){return t.clientY}function jo(t){return t.touches}var Du=F("TouchEvent");function yp(t,e){return e.item(t)}var Fu=function(t){return function(e){return at(yp(t,e))}};function Xo(t){return t.clientX}function Yo(t){return t.clientY}var wu=F("MouseEvent");var Ne=y(yt),ny=Se(Pe),Ko=Lo(Bt)(yn(A)),ry=Mt(Ko),jr=Et(Ko),Dp=zt(Ko),Tu=se(Ko),Fp=Jt(Ko),Oi=tr(bt),Wn=C(Oi),bu=me(Oi),Qo=Hr(bt),Qe=xe(Ur)(bt),Bi=ny(Oi),wp=me(hn),ki=y(xo(bt)),oy=Ga(Bt),ay=au()(),fr=Ss(Bt),uy=ip(Ll),Xr=function(t){return function(e){return function(n){return function(){var u=Si(vp(e))(),a=Ui(e)(),o=Hi(e)(),i=so(t)(),l=po(t)();return{x:(n.x-u.left)*i/a,y:(n.y-u.top)*l/o}}}}},ve=function(t){return function(){var n=jn(t.canvas)(),r=Mf(t.canvas)();return sl(n)({x:0,y:0,width:r.width,height:r.height})(),Tt(n)(ry(n)(t.layer))()}},ly=function(t){return Qt(function(e){var n=Du(e);if(n instanceof d)return Ne(void 0);if(n instanceof s){var r=Fu(0)(jo(n.value0));if(r instanceof d)return ve(t);if(r instanceof s)return function(){var a=jr(t.layer)(),o=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(Go(r.value0)),y:lt(Vo(r.value0))})(),i={offsetX:o.x-a.x,offsetY:o.y-a.y};return Dp(i)(t.layer)(),ve(t)()};throw new Error("Failed pattern match at Template.Main (line 194, column 22 - line 204, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 192, column 63 - line 204, column 22): "+[n.constructor.name])})},iy=function(t){return Qt(function(e){var n=Du(e);if(n instanceof d)return Ne(void 0);if(n instanceof s){var r=Fu(0)(jo(n.value0));if(r instanceof d)return ve(t);if(r instanceof s)return function(){var a=jr(t.layer)(),o=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(Go(r.value0)),y:lt(Vo(r.value0))})(),i={translateX:o.x-a.x,translateY:o.y-a.y};return Tu(i)(t.layer)(),ve(t)()};throw new Error("Failed pattern match at Template.Main (line 222, column 22 - line 232, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 220, column 62 - line 232, column 22): "+[n.constructor.name])})},cy=function(t){return Qt(function(e){var n=Du(e);if(n instanceof d)return Ne(void 0);if(n instanceof s){var r=Fu(0)(jo(n.value0));if(r instanceof d)return ve(t);if(r instanceof s)return function(){var a=jr(t.layer)(),o=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(Go(r.value0)),y:lt(Vo(r.value0))})(),i={translateX:o.x-a.x,translateY:o.y-a.y};return Tu(i)(t.layer)(),Fp(t.layer)(),ve(t)()};throw new Error("Failed pattern match at Template.Main (line 251, column 22 - line 262, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 249, column 61 - line 262, column 22): "+[n.constructor.name])})},zi=function(t){return function(e){return Tn(Wn(bu(Qo)(Qe(yl(t))))(function(n){return Bi(Qe(Rl(n)(e)))(function(){return Wn(Qe(wp(qi)(Wi)))(function(r){return Wn(bu(Qo)(Qe(Pn(t)(An(r)))))(function(u){return Wn(Qo(hu(u)))(function(a){return ki({canvas:n,canvasElement:u,canvasHtmlElement:a,document:r})})})})})}))}},bp=function(t){var e=kt(t);return function(n){return function(r){return function(){var a=oy(e(r))();return ay(n)({layer:a})}}}},fy=function(t){return Qt(function(e){var n=wu(e);if(n instanceof d)return Ne(void 0);if(n instanceof s)return function(){var u=jr(t.layer)(),a=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(Xo(n.value0)),y:lt(Yo(n.value0))})(),o={translateX:a.x-u.x,translateY:a.y-u.y};return Tu(o)(t.layer)(),Fp(t.layer)(),ve(t)()};throw new Error("Failed pattern match at Template.Main (line 235, column 60 - line 246, column 20): "+[n.constructor.name])})},sy=function(t){return Qt(function(e){var n=wu(e);if(n instanceof d)return Ne(void 0);if(n instanceof s)return function(){var u=jr(t.layer)(),a=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(Xo(n.value0)),y:lt(Yo(n.value0))})(),o={translateX:a.x-u.x,translateY:a.y-u.y};return Tu(o)(t.layer)(),ve(t)()};throw new Error("Failed pattern match at Template.Main (line 207, column 62 - line 217, column 20): "+[n.constructor.name])})},dy=function(t){return Qt(function(e){var n=wu(e);if(n instanceof d)return Ne(void 0);if(n instanceof s)return function(){var u=jr(t.layer)(),a=Xr(t.canvas)(t.canvasHtmlElement)({x:lt(Xo(n.value0)),y:lt(Yo(n.value0))})(),o={offsetX:a.x-u.x,offsetY:a.y-u.y};return Dp(o)(t.layer)(),ve(t)()};throw new Error("Failed pattern match at Template.Main (line 179, column 62 - line 189, column 20): "+[n.constructor.name])})},py=function(t){return Qt(function(e){return ve(t)})},Ji=function(t){return function(e){return function(n){return function(r){return Tn(function(){var u=An(r.document);return Wn(bu(Qo)(Qe(Pn(t)(u))))(function(a){return Wn(Qe(Qt(function(o){return function(){var l=Jo("canvas")(_u(r.document))();cr("id")("hidden-clip-canvas")(l)();var f=sp(r.document)();if(f instanceof s){Pi(op(l))(pp(f.value0))();var c=yl("hidden-clip-canvas")();if(c instanceof s){Rl(c.value0)({width:n.width,height:n.height})();var v=jn(c.value0)(),m=r.canvas;_l(v)(m)(n.x)(n.y)(n.width)(n.height)(0)(0)(n.width)(n.height)();var h=La(c.value0)(),b=Jo("a")(_u(r.document))();cr("href")(h)(b)(),cr("download")(e)(b)();var L=hu(b);if(L instanceof s)return gu(L.value0)();throw new Error("Failed pattern match at Template.Main (line 173, column 9 - line 173, column 53): "+[L.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 162, column 5 - line 162, column 64): "+[c.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 159, column 5 - line 159, column 53): "+[f.constructor.name])}})))(function(o){return Bi(Qe(Kt("click")(o)(!1)(pe(a))))(function(){return ki(a)})})})}())}}}},Tp=function(t){return function(e){return function(n){return Tn(function(){var r=An(n.document);return Wn(bu(Qo)(Qe(Pn(t)(r))))(function(u){return Wn(Qe(Qt(function(a){return function(){var i=La(n.canvas)(),l=Jo("a")(_u(n.document))();cr("href")(i)(l)(),cr("download")(e)(l)();var f=hu(l);if(f instanceof s)return gu(f.value0)();throw new Error("Failed pattern match at Template.Main (line 144, column 9 - line 144, column 53): "+[f.constructor.name])}})))(function(a){return Bi(Qe(Kt("click")(a)(!1)(pe(u))))(function(){return ki(u)})})})}())}}},vy=function(t){return function(e){return function(n){return function(r){return function(){var a=Pn(e)(An(t.document))();if(a instanceof s){var o=Rp(a.value0);if(o instanceof s){var i=yu(o.value0)();fr(r(i))(n)();var l=Qt(function(f){return function(){var v=yu(o.value0)();return fr(r(v))(n)()}})();return Kt("input")(l)(!1)(pe(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 298, column 7 - line 298, column 55): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 297, column 3 - line 297, column 79): "+[a.constructor.name])}}}}},Zo=function(t){return function(e){return function(n){return function(r){return vy(t)(e)(n)(function(u){return function(a){return function(o){return Ne(a(o))}}(r(u))})}}}},Cp=function(t){return function(e){return function(n){return function(r){return function(){var a=Pn(e)(An(t.document))();if(a instanceof s){var o=Ru(a.value0);if(o instanceof s){var i=Vr(o.value0)();(function(){var f=Sa(i);if(f instanceof s)return fr(r(f.value0))(n)();if(f instanceof d)return void 0;throw new Error("Failed pattern match at Template.Main (line 317, column 3 - line 319, column 25): "+[f.constructor.name])})();var l=Qt(function(f){return function(){var v=Vr(o.value0)(),m=Sa(v);if(m instanceof s)return fr(r(m.value0))(n)();if(m instanceof d)return void 0;throw new Error("Failed pattern match at Template.Main (line 323, column 5 - line 325, column 27): "+[m.constructor.name])}})();return Kt("input")(l)(!1)(pe(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 314, column 7 - line 314, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 313, column 3 - line 313, column 79): "+[a.constructor.name])}}}}},my=function(t){return function(e){return function(n){return function(r){return Cp(t)(e)(n)(function(u){return function(a){return function(o){return Ne(a(o))}}(r(u))})}}}};var Ep=function(t){var e=Sf(t);return function(n){return function(r){return function(u){return function(){var o=wn(1)();return Cp(n)(r)(u)(function(i){return function(l){return function(){var c=re(o)();return Sr(i)(o)(),e(i/c)(l)()}}})()}}}}},Cu=function(t){return function(e){return function(n){return my(t)(e)(n)(Bd)}}},_y=function(t){return function(e){return function(n){return function(r){return function(){var a=Pn(e)(An(t.document))();if(a instanceof s){var o=Ru(a.value0);if(o instanceof s){var i=Vr(o.value0)();fr(r(i))(n)();var l=Qt(function(f){return function(){var v=Vr(o.value0)();return fr(r(v))(n)()}})();return Kt("input")(l)(!1)(pe(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 282, column 7 - line 282, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 281, column 3 - line 281, column 79): "+[a.constructor.name])}}}}},Eu=function(t){return function(e){return function(n){return function(r){return _y(t)(e)(n)(function(u){return function(a){return function(o){return Ne(a(o))}}(r(u))})}}}},gy=function(t){return function(e){return function(n){return function(r){return function(){var a=Pn(e)(An(t.document))();if(a instanceof s){var o=Ru(a.value0);if(o instanceof s){var i=function(c){if(c instanceof d)return Ne(void 0);if(c instanceof s){var v=Ge(uy(c.value0))(0);if(v instanceof d)return Ne(void 0);if(v instanceof s)return fr(r(v.value0))(n);throw new Error("Failed pattern match at Template.Main (line 353, column 24 - line 355, column 54): "+[v.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 351, column 26 - line 355, column 54): "+[c.constructor.name])},l=$i(o.value0)();i(l)();var f=Qt(function(c){return wp(i)($i(o.value0))})();return Kt("change")(f)(!1)(pe(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 348, column 7 - line 348, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 347, column 3 - line 347, column 79): "+[a.constructor.name])}}}}};var hy=function(t){return function(e){return function(n){return function(r){return gy(t)(e)(n)(function(u){return r(up(u))})}}}};var Gi=function(t){return function(e){return function(n){return function(r){return hy(t)(e)(n)(function(u){return function(a){return function(){var i=Ai(u)();return r(i)(a)()}}})}}}},Vi=function(t){return function(){var n=dy(t)(),r=sy(t)(),u=fy(t)(),a=ly(t)(),o=iy(t)(),i=cy(t)(),l=py(t)();return Kt("mousedown")(n)(!1)(pe(t.canvasElement))(),Kt("mousemove")(r)(!1)(pe(t.canvasElement))(),Kt("mouseup")(u)(!1)(pe(t.canvasElement))(),Kt("touchstart")(a)(!1)(pe(t.canvasElement))(),Kt("touchmove")(o)(!1)(pe(t.canvasElement))(),Kt("touchend")(i)(!1)(pe(t.canvasElement))(),Kt("input")(l)(!1)(fp(t.document))()}};var yy=Se(Pe),Dy=zn(pt)(ye),Lp=Pt(Xt),ji=Lt(A),Fy=Lp(yt),Ip=ee(vr()(pn({reflectSymbol:function(){return"height"}})()(pn({reflectSymbol:function(){return"width"}})()(pr)(Ue))(Ue))),Np=me(hn),dn=Ga(Bt),Sp=hs(Bt),Pp=Rs(Bt),Ap=Ep(_s(Bt)),ta=kl(Bt),Xi=Lo(Bt),Wp=kt(Xi(pu(Bt))),Up=kt(Xi(Za(Bt))),Hp=Zd(bt),$p=Ba(Bt),ea=kt(Hp($p)),qp=kt(Kd(bt)(Us($l(bt))(bt))),Op=kt(Xi($p)),Bp=kt(Hp(Yl(yt))),kp=bp(Is(bt));var zp=function(t){var e=Ba(t),n=Et(e),r=t.Monad0(),u=r.Bind1(),a=C(u),o=p(u.Apply0().Functor0()),i=Ds(t),l=Ct(e),f=r.Applicative0(),c=y(f),v=$t(e),m=Mt(e),h=zt(e),b=Yt(f),L=Jt(e);return{position:function(W){return n(W.guillotine)},translate:function(W){return function(J){return a(o(function(it){return function(z){return z+W.translateX}(function(z){return z.x}(it))})(n(J.guillotine)))(function(it){return a(i(J.guillotine))(function(z){var Z=ys(J.guillotine).scaleY,ht=function(){return z instanceof s&&z.value0.width!==0?gs({scaleX:(J.xMax-it)/z.value0.width,scaleY:Z})(J.guillotine):J.guillotine}();return a(l(W)(ht))(function(be){return c({xMax:J.xMax,guillotine:be})})})})}},containsPoint:function(W){return function(J){return v(W)(J.guillotine)}},draw:function(W){return function(J){return m(W)(J.guillotine)}},dragStart:function(W){return function(J){return a(h(W)(J.guillotine))(function(it){return c({xMax:J.xMax,guillotine:it})})}},drag:function(W){return function(J){return b(zp(t))(J.guillotine.dragOffset)(W)(J)}},dragEnd:function(W){return a(L(W.guillotine))(function(J){return c({xMax:W.xMax,guillotine:J})})}}},Jp=function(t){var e=t.Monad0(),n=Fl(e),r=Et(n),u=e.Bind1(),a=C(u),o=Ct(n),i=zp(t),l=Ct(i),f=Lo(t),c=f(Za(t)),v=Ct(c),m=f(pu(t)),h=Ct(m),b=yy(u),L=Ps(t),W=e.Applicative0(),J=y(W),it=u.Apply0().Functor0(),z=p(it),Z=Lp(W),ht=yn(it),be=$t(ht),Ke=kt(n),Hn=kt(i),sr=kt(m),Ki=kt(c),Vp=Mt(ht),jp=zt(n),Xp=Yt(W),Yp=Jt(n);return{position:function(vt){return r(vt.overlayBackground)},translate:function(vt){return function(ut){return a(o(vt)(ut.overlayBackground))(function(Mu){return a(l(vt)(ut.guillotine))(function(Qp){return a(v(vt)(ut.author))(function(Kp){return a(h(vt)(ut.title))(function(Zi){return b(L(Ii(function(xu){return xu-vt.translateX}))(Zi))(function(){return b(L(Ii(function(xu){return xu-vt.translateX}))(ut.bodyText))(function(){return J({overlayBackground:Mu,guillotine:Qp,author:Kp,bodyText:ut.bodyText,title:Zi})})})})})})})}},containsPoint:function(vt){return function(ut){return z(Dy)(Z(be(vt))([Ke(ut.overlayBackground),Hn(ut.guillotine),sr(ut.bodyText),Ki(ut.author),sr(ut.title)]))}},draw:function(vt){return function(ut){return ji(Fy(Vp(vt))([Ke(ut.overlayBackground),Hn(ut.guillotine),sr(ut.bodyText),Ki(ut.author),sr(ut.title)]))}},dragStart:function(vt){return function(ut){return a(jp(vt)(ut.overlayBackground))(function(Mu){return J({guillotine:ut.guillotine,bodyText:ut.bodyText,author:ut.author,title:ut.title,overlayBackground:Mu})})}},drag:function(vt){return function(ut){return Xp(Jp(t))(ut.overlayBackground.dragOffset)(vt)(ut)}},dragEnd:function(vt){return a(Yp(vt.overlayBackground))(function(ut){return J({guillotine:vt.guillotine,bodyText:vt.bodyText,author:vt.author,title:vt.title,overlayBackground:ut})})}}},wy=kt(Qd(bt)(Hs(Jp(Bt))(bt))),N=2;var by={width:1080,height:1920},Yi=Ip({width:N,height:N})(by),Mp=function(){return Yi.height}(),xp=function(){return Yi.width}(),Ty=function(t){var e=t.Monad0(),n=C(e.Bind1()),r=kl(t),u=y(e.Applicative0());return function(a){return function(o){return function(i){return function(l){return n(r(a)(o)(i)(Oe.value))(function(f){return u({guillotine:f,xMax:l})})}}}}},Cy=Ty(Bt),Ey=function(){return{width:1080,height:1080*5/4}}(),Qi=function(){return Ip({width:2*N,height:N})(Ey)}(),Un=function(){return Qi.height}(),Dt=function(){return Qi.width}(),My=ji(function(){var e=zi("canvas-story")(Yi)();if(e instanceof s){var n=jn(e.value0.canvas)(),r=Np(dn)(Sp({x:0,y:0})({scaleX:1,scaleY:1})(Oe.value))();Gi(e.value0)("image")(r)(Pp)(),Ap(e.value0)("image-size-story")(r)();var u=ta("./img/guillotinewit2x.png")({x:60*N,y:60*N})({scaleX:1,scaleY:1})(Oe.value)(),a=ta("./img/jacobinlogowit80x200.png")({x:Dt/2-100*N,y:Mp-160*N})({scaleX:1,scaleY:1})(Oe.value)(),o={x:60*N,y:250*N},i=dn({text:[],lineHeight:.9,position:o,maxWidth:new s(xp-2*60*N),fillStyle:"#fff",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:100*N},align:ne.value,baseline:Me.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();Zo(e.value0)("title-left")(i)(zo)(),Cu(e.value0)("title-size-story")(i)();var l=dn({text:"AUTEUR",lineHeight:.95,position:o,fillStyle:"#fff",fontName:"Oswald",fontStyle:"normal",fontWeight:"500",fontSize:N*50,align:ne.value,baseline:De.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();Eu(e.value0)("author")(l)(Ka)();var f=Zl(o.y)(50*N)(ql([Wp(i),Up(l)])),c=Xl([ea(Sn(a)),qp(Ni(f)),ea(Sn(u)),Op(r),Bp(Sn(Ql({x:0,y:0,width:xp,height:Mp})("#f00")))]),v=kp(e.value0)(c)();ve(v)(),Vi(v)();var m=Tp("download-story")("jacobin-story.png")(v)();if(m instanceof s)return void 0;throw new Error("Failed pattern match at Jacobin.TitleSlide (line 401, column 3 - line 401, column 75): "+[m.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 323, column 3 - line 323, column 83): "+[e.constructor.name])}),xy=ji(function(){var e=zi("canvas-title-slide")(Qi)();if(e instanceof s){var n=jn(e.value0.canvas)(),r=Np(dn)(Sp({x:0,y:0})({scaleX:1,scaleY:1})(Oe.value))();Gi(e.value0)("image")(r)(Pp)(),Ap(e.value0)("image-size")(r)();var u=Cy("./img/guillotine2x.png")({x:Dt/2+285*N,y:60*N})({scaleX:(Dt-180*N-(Dt/2+285*N))/1560,scaleY:1})(Dt-180*N)(),a=ta("./img/guillotinewit2x.png")({x:60*N,y:60*N})({scaleX:1,scaleY:1})(Oe.value)(),o=ta("./img/jacobinlogo80x200.png")({x:Dt-100*N,y:Un-160*N})({scaleX:1,scaleY:1})(Oe.value)(),i=ta("./img/jacobinlogowit80x200.png")({x:Dt/2-100*N,y:Un-160*N})({scaleX:1,scaleY:1})(Oe.value)(),l=dn({text:[],lineHeight:1.1,position:{x:Dt-N*60,y:N*150},fillStyle:"#f00",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"500",bold:"700"},size:90*N},align:Rn.value,baseline:De.value,letterSpacing:"-3px",emptyLineHeight:.25,dragOffset:d.value,maxWidth:new s(Dt/2-2*60*N),context:n})();Zo(e.value0)("bodytext")(l)(zo)(),Cu(e.value0)("bodytext-size")(l)();var f={x:60*N,y:250*N},c=dn({text:[],lineHeight:.9,position:f,maxWidth:new s(Dt/2-2*60*N),fillStyle:"#fff",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:100*N},align:ne.value,baseline:Me.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();Zo(e.value0)("title-left")(c)(zo)(),Cu(e.value0)("title-size")(c)();var v=dn({text:"AUTEUR",lineHeight:.95,position:f,fillStyle:"#fff",fontName:"Oswald",fontStyle:"normal",fontWeight:"500",fontSize:N*50,align:ne.value,baseline:De.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();Eu(e.value0)("author")(v)(Ka)();var m=Zl(f.y)(50*N)(ql([Wp(c),Up(v)])),h=dn({text:"AUTEUR",lineHeight:.95,position:{x:Dt/2+128*N,y:Un-160*N},fillStyle:"#f00",fontName:"Oswald",fontStyle:"normal",fontWeight:"400",fontSize:2*50,align:ne.value,baseline:Me.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();Eu(e.value0)("author")(h)(function(ht){return Ka(Ta(ht))})();var b=dn({text:[],lineHeight:.9,position:{x:Dt/2+128*N,y:Un-160*N},maxWidth:new s(Dt/2-(128+2*60+20)*N),fillStyle:"#f00",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:50*N},align:ne.value,baseline:De.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();Zo(e.value0)("title-right")(b)(zo)();var L=Wf({x:Dt/2+60*N,y:0})({width:Dt,height:Un})(82.5)("#fff"),W=Ws(Dt/2)(60*N)({overlayBackground:L,guillotine:u,bodyText:l,author:h,title:b}),J=Xl([ea(Sn(i)),ea(Sn(o)),qp(Ni(m)),wy(tp(W)),ea(Sn(a)),Op(r),Bp(Sn(Ql({x:0,y:0,width:Dt,height:Un})("#f00")))]),it=kp(e.value0)(J)();ve(it)(),Vi(it)();var z=Ji("download-left")("jacobin-titel-links.png")({x:0,y:0,width:Dt/2,height:Un})(it)();if(z instanceof s){var Z=Ji("download-right")("jacobin-titel-rechts.png")({x:Dt/2,y:0,width:Dt/2,height:Un})(it)();if(Z instanceof s)return void 0;throw new Error("Failed pattern match at Jacobin.TitleSlide (line 318, column 3 - line 318, column 173): "+[Z.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 317, column 3 - line 317, column 155): "+[z.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 148, column 3 - line 148, column 84): "+[e.constructor.name])}),Gp=le(xa)(xy)(My);Gp();})();
