/* Generated by Spago v0.93.44 */
(()=>{var gc=function(t){return function(e){for(var n=t.length,r=e.length,u=new Array(n*r),a=0,o=0;o<n;o++)for(var i=t[o],l=0;l<r;l++)u[a++]=i(e[l]);return u}};var ia={compose:function(t){return function(e){return function(n){return t(e(n))}}}};var G=function(t){return t.identity},Q={identity:function(t){return t},Semigroupoid0:function(){return ia}};var kt=!0;var et=function(t){return function(e){return function(n){return t(n)(e)}}},tt=function(t){return function(e){return t}};var hc=function(t){return function(e){for(var n=e.length,r=new Array(n),u=0;u<n;u++)r[u]=t(e[u]);return r}};var B=function(){function t(){}return t.value=new t,t}();var v=function(t){return t.map},ae=function(t){var e=v(t);return function(n){return function(r){return e(r)(n)}}},Nt=function(t){return v(t)(tt(void 0))};var on=function(t){var e=v(t);return function(n){return e(tt(n))}};var St={map:hc};var Rv=G(Q);var fa={apply:gc,Functor0:function(){return St}},dt=function(t){return t.apply},Rc=function(t){var e=dt(t),n=v(t.Functor0());return function(r){return function(u){return e(n(tt)(r))(u)}}},pe=function(t){var e=dt(t),n=v(t.Functor0());return function(r){return function(u){return e(n(tt(Rv))(r))(u)}}};var y=function(t){return t.pure};var to=function(t){var e=dt(t.Apply0()),n=y(t);return function(r){return function(u){return e(n(r))(u)}}};var Dc=typeof Array.prototype.flatMap=="function"?function(t){return function(e){return t.flatMap(e)}}:function(t){return function(e){for(var n=[],r=t.length,u=0;u<r;u++)for(var a=e(t[u]),o=a.length,i=0;i<o;i++)n.push(a[i]);return n}};var He=function(t){return t.discard};var da={bind:Dc,Apply0:function(){return fa}},E=function(t){return t.bind},De=function(t){return et(E(t))};var $e={discard:function(t){return E(t)}};var Fc=function(t){return function(e){return function(n){for(var r=e,u=n.length,a=u-1;a>=0;a--)r=t(n[a])(r);return r}}},wc=function(t){return function(e){return function(n){for(var r=e,u=n.length,a=0;a<u;a++)r=t(r)(n[a]);return r}}};var bc=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var ue=function(t){return t.reflectSymbol};var we=function(t){return function(e){return e[t]}},ve=function(t){return function(e){return function(n){var r={};for(var u in n)({}).hasOwnProperty.call(n,u)&&(r[u]=n[u]);return r[t]=e,r}}};var Oe={append:bc};var q=function(t){return t.append};var Mt=function(t){return t.alt};var Cc="\uFFFF",Ec="\0",Mv=Number.POSITIVE_INFINITY,xv=Number.NEGATIVE_INFINITY;var Ou=function(t){return function(e){return function(n){return function(r){return function(u){return r<u?t:r===u?e:n}}}}};var Mc=Ou,xc=Ou;var Lc=Ou;var Bu=function(t){return function(e){return t===e}};var Ic=Bu,Nc=Bu,Sc=Bu;var Pc={eq:Nc},pa={eq:Ic},va={eq:Sc};var Y=function(t){return t.eq};var k=function(){function t(){}return t.value=new t,t}(),U=function(){function t(){}return t.value=new t,t}(),rt=function(){function t(){}return t.value=new t,t}();var vr={eq:function(t){return function(e){return t instanceof k&&e instanceof k||t instanceof U&&e instanceof U||t instanceof rt&&e instanceof rt}}};var Ac=function(t){return function(e){return t-e|0}},Wc=function(t){return function(e){return t-e}};var Uc=function(t){return function(e){return t+e|0}},Hc=function(t){return function(e){return t*e|0}},$c=function(t){return function(e){return t+e}},qc=function(t){return function(e){return t*e}};var Oc=function(t){return t.zeroRecord},be=function(t){return t.zero};var mr={addRecord:function(t){return function(e){return function(n){return{}}}},mulRecord:function(t){return function(e){return function(n){return{}}}},oneRecord:function(t){return function(e){return{}}},zeroRecord:function(t){return function(e){return{}}}};var Be={add:$c,zero:0,mul:qc,one:1},ma={add:Uc,zero:0,mul:Hc,one:1},Bc=function(t){return t.oneRecord},ke=function(t){return t.one},kc=function(t){return t.mulRecord},le=function(t){return t.mul},zc=function(t){return t.addRecord},_r=function(){return function(t){return{add:zc(t)(B.value),mul:kc(t)(B.value),one:Bc(t)(B.value)(B.value),zero:Oc(t)(B.value)(B.value)}}},me=function(t){return t.add};var Rn=function(t){var e=ue(t);return function(){return function(n){var r=zc(n),u=kc(n),a=Bc(n),o=Oc(n);return function(i){var l=me(i),f=le(i),c=ke(i),p=be(i);return{addRecord:function(m){return function(g){return function(w){var C=r(B.value)(g)(w),W=e(B.value),J=ve(W),st=we(W);return J(l(st(g))(st(w)))(C)}}},mulRecord:function(m){return function(g){return function(w){var C=u(B.value)(g)(w),W=e(B.value),J=ve(W),st=we(W);return J(f(st(g))(st(w)))(C)}}},oneRecord:function(m){return function(g){var w=a(B.value)(B.value),C=e(B.value),W=ve(C);return W(c)(w)}},zeroRecord:function(m){return function(g){var w=o(B.value)(B.value),C=e(B.value),W=ve(C);return W(p)(w)}}}}}}};var Av=_r(),Jc=function(t){return t.subRecord},gr=function(t){return t.sub};var ku={subRecord:function(t){return function(e){return function(n){return{}}}},SemiringRecord0:function(){return mr}},_a=function(t){var e=ue(t),n=Rn(t)();return function(){return function(r){var u=Jc(r),a=n(r.SemiringRecord0());return function(o){var i=gr(o),l=a(o.Semiring0());return{subRecord:function(f){return function(c){return function(p){var m=u(B.value)(c)(p),g=e(B.value),w=ve(g),C=we(g);return w(i(C(c))(C(p)))(m)}}},SemiringRecord0:function(){return l}}}}}},zu=function(){return function(t){var e=Av(t.SemiringRecord0());return{sub:Jc(t)(B.value),Semiring0:function(){return e}}}};var ga={sub:Wc,Semiring0:function(){return Be}},Gc={sub:Ac,Semiring0:function(){return ma}};var ro=function(){return{compare:xc(k.value)(rt.value)(U.value),Eq0:function(){return Pc}}}(),_e=function(){return{compare:Mc(k.value)(rt.value)(U.value),Eq0:function(){return pa}}}(),ha=function(){return{compare:Lc(k.value)(rt.value)(U.value),Eq0:function(){return va}}}();var z=function(t){return t.compare};var an=function(t){return t.top};var oo={top:Cc,bottom:Ec,Ord0:function(){return ha}};var yn=function(t){return t.bottom};var Xc=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"},Yc=function(t){var e=t.charCodeAt(0);if(e<32||e===127){switch(t){case"\x07":return"'\\a'";case"\b":return"'\\b'";case"\f":return"'\\f'";case`
`:return"'\\n'";case"\r":return"'\\r'";case"	":return"'\\t'";case"\v":return"'\\v'"}return"'\\"+e.toString(10)+"'"}return t==="'"||t==="\\"?"'\\"+t+"'":"'"+t+"'"};var Qc=function(t){return function(e){for(var n=[],r=0,u=e.length;r<u;r++)n[r]=t(e[r]);return"["+n.join(",")+"]"}};var Ra={show:Xc};var ya={show:Yc};var M=function(t){return t.show},Gu=function(t){return{show:Qc(M(t))}};var Jv=G(Q),d=function(){function t(){}return t.value=new t,t}(),s=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}();var Te=function(t){return function(e){return function(n){if(n instanceof d)return t;if(n instanceof s)return e(n.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[t.constructor.name,e.constructor.name,n.constructor.name])}}},Dn=Te(!0)(tt(!1));var pt={map:function(t){return function(e){return e instanceof s?new s(t(e.value0)):d.value}}};var Zt=function(t){return Te(t)(Jv)},ze=function(){return function(t){if(t instanceof s)return t.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[t.constructor.name])}};var bt=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),gt=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}();var Bn=function(t){return t.defer};var tf=function(t){return function(e){return t&&e}},ef=function(t){return function(e){return t||e}},nf=function(t){return!t};var wa=function(t){return t.not};var uo=function(t){return t.ff};var yr=function(t){return t.disj},Ce={ff:!1,tt:!0,implies:function(t){return function(e){return yr(Ce)(wa(Ce)(t))(e)}},conj:tf,disj:ef,not:nf};var rf=function(t){return Math.min(Math.abs(t),2147483647)},of=function(t){return function(e){return e===0?0:e>0?Math.floor(t/e):-Math.floor(t/-e)}},af=function(t){return function(e){if(e===0)return 0;var n=Math.abs(e);return(t%n+n)%n}};var uf={Ring0:function(){return Gc}};var lo=function(t){return t.mod};var ba={degree:rf,div:of,mod:af,CommutativeRing0:function(){return uf}};var ht=function(t){return t.mempty};var x=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var ln=function(t){return t.value1};var cn=function(t){return t.value0};var Ma=function(t){return t};var l1=function(t){var e=yr(t);return{append:function(n){return function(r){return e(n)(r)}}}};var tl=function(t){var e=l1(t);return{mempty:uo(t),Semigroup0:function(){return e}}};var _=function(t){return t};var el=function(){return _};var df=el();var kn=function(){return df};var nl=function(){return function(){return function(){return function(){return function(t){return df}}}}};var d1=G(Q),p1=Y(vr);var v1=nl()()()(),Vt=function(t){return t.foldr};var Jn=function(t){var e=pe(t.Apply0()),n=y(t);return function(r){var u=Vt(r);return function(a){return u(function(o){return e(a(o))})(n(void 0))}}},so=function(t){var e=Jn(t);return function(n){return et(e(n))}};var Rt=function(t){return t.foldl};var vf=function(t){var e=Rt(t);return function(n){var r=function(u){return function(a){if(u instanceof d)return new s(a);if(u instanceof s)return new s(function(){var o=p1(n(u.value0)(a))(U.value);return o?u.value0:a}());throw new Error("Failed pattern match at Data.Foldable (line 441, column 3 - line 441, column 27): "+[u.constructor.name,a.constructor.name])}};return e(r)(d.value)}},po=function(t){var e=z(t);return function(n){return vf(n)(e)}};var ol=function(t){var e=Rt(t);return function(n){return e(me(n))(be(n))}};var mf=function(t){var e=Vt(t);return function(n){var r=q(n.Semigroup0()),u=ht(n);return function(a){return e(function(o){return function(i){return r(a(o))(i)}})(u)}}},vt={foldr:Fc,foldl:wc,foldMap:function(t){return mf(vt)(t)}};var Je=function(t){return t.foldMap};var Gn=function(t){var e=Je(t);return function(n){return v1(Ma)(e(tl(n)))}};var Vn=function(t){var e=Gn(t);return function(n){return e(n)(d1)}};var Ia=function(t){return t.toUpperCase()};var jn=function(t){return function(e){return e.join(t)}};var Tr=function(t){return t===""};var _f=function(){function t(u){return[u]}function e(u){return function(a){return[u,a]}}function n(u){return function(a){return function(o){return[u,a,o]}}}function r(u){return function(a){return u.concat(a)}}return function(u){return function(a){return function(o){return function(i){return function(l){function f(c,p){switch(p-c){case 0:return o([]);case 1:return a(t)(i(l[c]));case 2:return u(a(e)(i(l[c])))(i(l[c+1]));case 3:return u(u(a(n)(i(l[c])))(i(l[c+1])))(i(l[c+2]));default:var m=c+Math.floor((p-c)/4)*2;return u(a(r)(f(c,m)))(f(m,p))}}return f(0,l.length)}}}}}}();var Cr=function(t){return t};var ll={map:function(t){return function(e){return t(e)}}};var Rf={apply:function(t){return function(e){return t(e)}},Functor0:function(){return ll}},h1={bind:function(t){return function(e){return e(t)}},Apply0:function(){return Rf}},R1={pure:Cr,Apply0:function(){return Rf}},yf={Applicative0:function(){return R1},Bind1:function(){return h1}};var Z1=G(Q),Wt=function(t){return t.traverse};var tm=function(t){var e=Wt(t);return function(n){return e(n)(Z1)}},te={traverse:function(t){var e=t.Apply0();return _f(dt(e))(v(e.Functor0()))(y(t))},sequence:function(t){return tm(te)(t)},Functor0:function(){return St},Foldable1:function(){return vt}};var xf=function(t){return function(e){var n=Wt(e)(t);return function(r){return function(u){return n(u)(r)}}}};var Lf=function(t){return function(){return t}},If=function(t){return function(e){return function(){return e(t())()}}};var Sf=function(t){var e=E(t.Bind1()),n=y(t.Applicative0());return function(r){return function(u){return e(u)(function(a){return n(r(a))})}}},Yn=function(t){var e=E(t.Bind1()),n=y(t.Applicative0());return function(r){return function(u){return e(r)(function(a){return e(u)(function(o){return n(a(o))})})}}};var Pf=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}},Tt={Applicative0:function(){return Ct},Bind1:function(){return bn}},bn={bind:If,Apply0:function(){return pl(0)}},Ct={pure:Lf,Apply0:function(){return pl(0)}},Af=Pf("functorEffect","Effect",function(){return{map:to(Ct)}}),pl=Pf("applyEffect","Effect",function(){return{apply:Yn(Tt),Functor0:function(){return Af(0)}}}),A=Af(20),Aa=pl(23);var Xt={liftEffect:G(Q),Monad0:function(){return Tt}},Ut=function(t){return t.liftEffect};function Wf(t){return function(e){return function(n){return function(){var r=new Image;r.src=t,r.addEventListener("load",function(){n(r)()},!1),r.addEventListener("error",function(){e()},!1)}}}}function Uf(t,e,n){return function(){var r=document.getElementById(t);return r&&r instanceof HTMLCanvasElement?e(r):n}}function Qn(t){return function(){return t.getContext("2d")}}function _o(t){return function(){return t.width}}function go(t){return function(){return t.height}}function vl(t){return function(e){return function(){t.width=e}}}function ml(t){return function(e){return function(){t.height=e}}}function Wa(t){return function(){return t.toDataURL()}}function Le(t){return function(e){return function(){t.fillStyle=e}}}function _l(t){return function(e){return function(){t.shadowColor=e}}}function gl(t){return function(e){return function(){t.shadowBlur=e}}}function hl(t){return function(e){return function(){t.shadowOffsetX=e}}}function Rl(t){return function(e){return function(){t.shadowOffsetY=e}}}function Hf(t){return function(e){return function(){t.globalCompositeOperation=e}}}function ho(t){return function(){t.beginPath()}}function Ro(t){return function(){t.fill()}}function yo(t){return function(e){return function(n){return function(){t.lineTo(e,n)}}}}function yl(t){return function(e){return function(n){return function(){t.moveTo(e,n)}}}}function Dl(t){return function(){t.closePath()}}function Fl(t){return function(e){return function(){t.rect(e.x,e.y,e.width,e.height)}}}function wl(t){return function(e){return function(){t.clearRect(e.x,e.y,e.width,e.height)}}}function bl(t){return function(e){return function(){t.translate(e.translateX,e.translateY)}}}function $f(t){return function(e){return function(){t.textAlign=e}}}function qf(t){return function(e){return function(){t.textBaseline=e}}}function Er(t){return function(e){return function(){t.font=e}}}function Do(t){return function(e){return function(n){return function(r){return function(){t.fillText(e,n,r)}}}}}function Tl(t){return function(){t.save()}}function Cl(t){return function(){t.restore()}}function El(t){return function(e){return function(n){return function(r){return function(u){return function(a){return function(){t.drawImage(e,n,r,u,a)}}}}}}}function Ml(t){return function(e){return function(n){return function(r){return function(u){return function(a){return function(o){return function(i){return function(l){return function(f){return function(){t.drawImage(e,n,r,u,a,o,i,l,f)}}}}}}}}}}}var fm=pe(Aa),Ee=function(){function t(){}return t.value=new t,t}(),sm=function(){function t(){}return t.value=new t,t}(),dm=function(){function t(){}return t.value=new t,t}(),pm=function(){function t(){}return t.value=new t,t}(),vm=function(){function t(){}return t.value=new t,t}(),Ie=function(){function t(){}return t.value=new t,t}(),ie=function(){function t(){}return t.value=new t,t}(),Tn=function(){function t(){}return t.value=new t,t}(),Mr=function(){function t(){}return t.value=new t,t}(),xr=function(){function t(){}return t.value=new t,t}(),Lr=function(){function t(){}return t.value=new t,t}();var Ne=function(){function t(){}return t.value=new t,t}(),mm=function(){function t(){}return t.value=new t,t}(),_m=function(){function t(){}return t.value=new t,t}(),gm=function(){function t(){}return t.value=new t,t}(),hm=function(){function t(){}return t.value=new t,t}(),Rm=function(){function t(){}return t.value=new t,t}(),ym=function(){function t(){}return t.value=new t,t}(),Dm=function(){function t(){}return t.value=new t,t}(),Fm=function(){function t(){}return t.value=new t,t}(),wm=function(){function t(){}return t.value=new t,t}(),bm=function(){function t(){}return t.value=new t,t}(),Tm=function(){function t(){}return t.value=new t,t}(),Cm=function(){function t(){}return t.value=new t,t}(),Em=function(){function t(){}return t.value=new t,t}(),Mm=function(){function t(){}return t.value=new t,t}(),xm=function(){function t(){}return t.value=new t,t}(),Lm=function(){function t(){}return t.value=new t,t}(),Im=function(){function t(){}return t.value=new t,t}(),Nm=function(){function t(){}return t.value=new t,t}(),Sm=function(){function t(){}return t.value=new t,t}(),Pm=function(){function t(){}return t.value=new t,t}(),Am=function(){function t(){}return t.value=new t,t}(),Wm=function(){function t(){}return t.value=new t,t}(),Um=function(){function t(){}return t.value=new t,t}(),Hm=function(){function t(){}return t.value=new t,t}(),$m=function(){function t(){}return t.value=new t,t}(),yt=function(t){return function(e){return function(){Tl(t)();var r=e();return Cl(t)(),r}}},Ll=function(t){return function(e){return Wf(t)(e(d.value))(function(n){return e(s.create(n))})}};var Ir=function(t){return function(e){var n=function(r){if(r instanceof Ee)return"top";if(r instanceof sm)return"hanging";if(r instanceof dm)return"middle";if(r instanceof pm)return"alphabetic";if(r instanceof vm)return"ideographic";if(r instanceof Ie)return"bottom";throw new Error("Failed pattern match at Graphics.Canvas (line 577, column 5 - line 577, column 33): "+[r.constructor.name])};return qf(t)(n(e))}},Nr=function(t){return function(e){var n=function(r){if(r instanceof ie)return"left";if(r instanceof Tn)return"right";if(r instanceof Mr)return"center";if(r instanceof xr)return"start";if(r instanceof Lr)return"end";throw new Error("Failed pattern match at Graphics.Canvas (line 531, column 5 - line 531, column 32): "+[r.constructor.name])};return $f(t)(n(e))}};var zf=function(t){return function(e){var n=function(r){if(r instanceof Ne)return"source-over";if(r instanceof mm)return"source-in";if(r instanceof _m)return"source-out";if(r instanceof gm)return"source-atop";if(r instanceof hm)return"destination-over";if(r instanceof Rm)return"destination-in";if(r instanceof ym)return"destination-out";if(r instanceof Dm)return"destination-atop";if(r instanceof Fm)return"lighter";if(r instanceof wm)return"copy";if(r instanceof bm)return"xor";if(r instanceof Tm)return"multiply";if(r instanceof Cm)return"screen";if(r instanceof Em)return"overlay";if(r instanceof Mm)return"darken";if(r instanceof xm)return"lighten";if(r instanceof Lm)return"color-dodge";if(r instanceof Im)return"color-burn";if(r instanceof Nm)return"hard-light";if(r instanceof Sm)return"soft-light";if(r instanceof Pm)return"difference";if(r instanceof Am)return"exclusion";if(r instanceof Wm)return"hue";if(r instanceof Um)return"saturation";if(r instanceof Hm)return"color";if(r instanceof $m)return"luminosity";throw new Error("Failed pattern match at Graphics.Canvas (line 326, column 5 - line 326, column 45): "+[r.constructor.name])};return Hf(t)(n(e))}},Il=function(t){return function(e){return fm(ml(t)(e.height))(vl(t)(e.width))}},Nl=function(t){return Uf(t,s.create,d.value)},Jf=function(t){return function(){var n=_o(t)(),r=go(t)();return{width:n,height:r}}},Gf=function(t){return function(e){return function(){ho(t)();var r=e();return Ro(t)(),r}}};var Ua=isFinite;function Vf(t,e,n,r){var u=parseFloat(t);return e(u)?n(u):r}var Sr=Math.round;var Ha=Math.tan;var jf=3.141592653589793;var $a=function(t){return Vf(t,Ua,s.create,d.value)};var qa=function(t){return function(e){return e(function(n){return t(n)})}},Ge=function(t){return function(e){return{x:e.x+t.translateX,y:e.y+t.translateY}}};var Dt=function(t){return t.translate},Xf=function(t){return function(e){return{width:e.width*t.scaleX,height:e.height*t.scaleY}}},Sl=function(t){return t.scale},Yf=function(t){var e=Sl(t);return function(n){return e({scaleX:n,scaleY:n})}},Ft=function(t){return t.position},Ht=function(t){return function(e){return function(n){return n(t)(e)}}},Gm=function(t){var e=v(t);return function(n){return qa(function(r){var u=e(Ht(r)),a=n(r);return function(o){return u(a(o))}})}};var sn=function(t){return t.mapLayerWrapper},wt=function(t){return t.draw},Qf=function(t){var e=Dt(t);return function(n){return function(r){return function(u){var a={translateX:r.translateX-n.offsetX,translateY:r.translateY-n.offsetY};return e(a)(u)}}}},ee=function(t){var e=y(t);return function(n){var r=Qf(n);return function(u){return function(a){return function(o){if(u instanceof d)return e(o);if(u instanceof s)return r(u.value0)(a)(o);throw new Error("Failed pattern match at Template.Layer (line 61, column 1 - line 61, column 115): "+[u.constructor.name,a.constructor.name,o.constructor.name])}}}}},$t=function(t){return t.dragStart},qt=function(t){return t.dragEnd},ne=function(t){return t.drag},Lt=function(t){return t.containsPoint},Cn=function(t){var e=Gm(t);return{position:qa(function(n){return Ft(n)}),translate:function(n){return e(function(r){return Dt(r)(n)})},containsPoint:function(n){return qa(function(r){return Lt(r)(n)})},draw:function(n){return qa(function(r){return wt(r)(n)})},dragStart:function(n){return e(function(r){return $t(r)(n)})},drag:function(n){return e(function(r){return ne(r)(n)})},dragEnd:e(function(n){return qt(n)})}};var Zf=function(t){return function(e){return function(n){return function(r){return{position:t,dimensions:e,angle:n,fillStyle:r,dragOffset:d.value}}}}},Kf=function(t){return t*jf/180},Pl=function(t){var e=t.Applicative0(),n=y(e),r=ee(e);return{position:function(u){return n(u.position)},translate:function(u){return function(a){return n({dimensions:a.dimensions,angle:a.angle,fillStyle:a.fillStyle,dragOffset:a.dragOffset,position:Ge(u)(a.position)})}},containsPoint:function(u){return function(a){var o=(a.dimensions.height-u.y)/Ha(Kf(a.angle));return n(a.position.x+o<=u.x&&u.x<=a.position.x+a.dimensions.width&&a.position.y<=u.y&&u.y<=a.position.y+a.dimensions.height)}},draw:function(u){return function(a){return yt(u)(function(){return Le(u)(a.fillStyle)(),ho(u)(),yl(u)(a.position.x)(a.position.y+a.dimensions.height)(),yo(u)(a.position.x+a.dimensions.width)(a.position.y+a.dimensions.height)(),yo(u)(a.position.x+a.dimensions.width)(a.position.y)(),yo(u)(a.position.x+a.dimensions.height/Ha(Kf(a.angle)))(a.position.y)(),Dl(u)(),Ro(u)()})}},dragStart:function(u){return function(a){return n({position:a.position,dimensions:a.dimensions,angle:a.angle,fillStyle:a.fillStyle,dragOffset:new s(u)})}},drag:function(u){return function(a){return r(Pl(t))(a.dragOffset)(u)(a)}},dragEnd:function(u){return n({position:u.position,dimensions:u.dimensions,angle:u.angle,fillStyle:u.fillStyle,dragOffset:d.value})}}};var ts=function(t,e){for(var n=t>e?-1:1,r=new Array(n*(e-t)+1),u=t,a=0;u!==e;)r[a++]=u,u+=n;return r[a]=u,r},jm=function(t,e){if(t<1)return[];var n=new Array(t);return n.fill(e)},Xm=function(t,e){for(var n=[],r=0,u=0;u<t;u++)n[r++]=e;return n},Ym=typeof Array.prototype.fill=="function"?jm:Xm,es=function(){function t(u,a){this.head=u,this.tail=a}var e={};function n(u){return function(a){return new t(u,a)}}function r(u){for(var a=[],o=0,i=u;i!==e;)a[o++]=i.head,i=i.tail;return a}return function(u,a){return r(u(n)(e)(a))}}(),It=function(t){return t.length};var ns=function(t,e,n,r){return r<0||r>=n.length?e:t(n[r])};var rs=function(t,e,n,r){for(var u=0,a=r.length;u<a;u++)if(n(r[u]))return t(u);return e};var os=function(t,e,n,r,u){if(n<0||n>=u.length)return e;var a=u.slice();return a[n]=r,t(a)},En=function(t){return t.slice().reverse()},Mn=function(t){if(t.length<=1e4)return Array.prototype.concat.apply([],t);for(var e=[],n=0,r=t.length;n<r;n++)for(var u=t[n],a=0,o=u.length;a<o;a++)e.push(u[a]);return e};var as=function(t,e,n){for(var r=n.length,u=e,a=new Array(r),o=0;o<r;o++)u=t(u)(n[o]),a[o]=u;return a};var us=function(t,e,n){return n.slice(t,e)},ls=function(t,e,n){for(var r=e.length<n.length?e.length:n.length,u=new Array(r),a=0;a<r;a++)u[a]=t(e[a])(n[a]);return u},is=function(t,e){for(var n=e.length,r=0;r<n;r++)if(t(e[r]))return!0;return!1},cs=function(t,e){for(var n=e.length,r=0;r<n;r++)if(!t(e[r]))return!1;return!0};var fs=function(t){return function(){return{value:t}}};var ce=function(t){return function(){return t.value}},ss=function(t){return function(e){return function(){var n=t(e.value);return e.value=n.state,n.value}}},Ar=function(t){return function(e){return function(){e.value=t}}};var Zm=Nt(A),xn=fs,t_=ss,Al=function(t){return t_(function(e){var n=t(e);return{state:n,value:n}})},Wl=function(t){return function(e){return Zm(Al(t)(e))}};var fe=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),se=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),dn=function(t){return t.tailRecM};var r_=function(t){var e=function(n){var r=!1,u;function a(o){if(o instanceof fe){n=t(o.value0);return}if(o instanceof se)return r=!0,o.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 103, column 3 - line 103, column 25): "+[o.constructor.name])}for(;!r;)u=a(n);return u};return function(n){return e(t(n))}};var ds={tailRecM:function(t){var e=function(r){return r},n=r_(function(r){return e(t(r))});return function(r){return Cr(n(r))}},Monad0:function(){return yf}};function i_(t){return t}var _s=i_;function c_(t){return t.slice()}var gs=c_;var hs=function(t,e){return e.push(t)};var Ba=function(e){return function(n){return function(){return e(n)}}},Ul=function(e){return function(n){return function(r){return function(){return e(n,r)}}}};var Rs=Ba(_s);var __=Ba(gs),ys=function(t){return function(e){return function(){var r=__(e)();return t(r)(),Rs(r)()}}};var Hl=Ul(hs);var wo=function(t){return function(e,n,r,u,a){return t(e)(n)(r)(u)(a)}};var Ln=function(t){return function(e){return function(n){return t(e,n)}}},bo=function(t){return function(e){return function(n){return function(r){return t(e,n,r)}}}},ka=function(t){return function(e){return function(n){return function(r){return function(u){return t(e,n,r,u)}}}}},$l=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){return t(e,n,r,u,a)}}}}}};var ws=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){for(var o=[],i=a;;){var l=u(i);if(t(l))return o;var f=e(l);o.push(n(f)),i=r(f)}}}}}}};var bs=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){for(var o=[],i=a;;){var l=u(i);o.push(n(l));var f=r(l);if(t(f))return o;i=e(f)}}}}}}};var x_=ze();var ql={unfoldr1:bs(Dn)(x_)(cn)(ln)};var N_=ze(),pn=function(t){return t.unfoldr};var Bl={unfoldr:ws(Dn)(N_)(cn)(ln),Unfoldable10:function(){return ql}};var S_=q(Oe);var xs=bo(ls);var je=function(){return xs(x.create)}();var Ls=function(){return $l(os)(s.create)(d.value)}();var Ot=function(t){return function(e){return ys(Hl(e))(t)()}},kl=bo(us),Eo=function(t){return function(e){return t<=0?{before:[],after:e}:{before:kl(0)(t)(e),after:kl(t)(It(e))(e)}}};var Jl=function(t){return[t]};var Ur=bo(as);var Gl=Ln(ts);var Xe=function(){return ka(ns)(s.create)(d.value)}();var Vl=function(t){return function(e){return function(n){var r=function(u){return Ls(t)(e(u))(n)};return Te(d.value)(r)(Xe(n)(t))}}};var jl=function(t){return Ln(es)(Vt(t))};var Mo=function(){return ka(rs)(s.create)(d.value)}();var Xl=function(t){var e=Y(t);return function(n){return Mo(function(r){return e(r)(n)})}},Yl=function(t){var e=Xl(t);return function(n){return function(r){return Dn(e(n)(r))}}};var Zn=function(t){return function(e){return S_([t])(e)}};var Is=et(E(da));var xo=Ln(is);var Va=Ln(cs);var P_=Vn(vt)(Ce),A_=Wt(te),W_=gr(zu()(_a({reflectSymbol:function(){return"x"}})()(_a({reflectSymbol:function(){return"y"}})()(ku)(ga))(ga))),U_=Jn(Ct)(vt);var Ql=function(t){var e=t.Applicative0(),n=y(e),r=t.Bind1().Apply0().Functor0(),u=v(r),a=A_(e),o=Cn(r),i=Lt(o),l=wt(o),f=ee(e);return{position:function(c){return n(c.position)},translate:function(c){return function(p){return n({layers:p.layers,dragOffset:p.dragOffset,position:Ge(c)(p.position)})}},containsPoint:function(c){return function(p){return u(P_)(a(i(W_(c)(p.position)))(p.layers))}},draw:function(c){return function(p){return yt(c)(function(){return bl(c)({translateX:p.position.x,translateY:p.position.y})(),U_(function(){var g=yt(c),w=l(c);return function(C){return g(w(C))}}())(En(p.layers))()})}},dragStart:function(c){return function(p){return n({layers:p.layers,position:p.position,dragOffset:new s(c)})}},drag:function(c){return function(p){return f(Ql(t))(p.dragOffset)(c)(p)}},dragEnd:function(c){return n({layers:c.layers,position:c.position,dragOffset:d.value})}}},Kl=function(t){return{layers:t,position:{x:0,y:0},dragOffset:d.value}};var Lo=t=>t.width,Io=t=>t.height;var tr=t=>e=>()=>t.letterSpacing=e;var Ns=function(t){return function(e){return function(n){return function(r){return El(t)(e)(n.x)(n.y)(r.width)(r.height)}}}};var Zl=function(t){return{width:Lo(t),height:Io(t)}};var q_=le(_r()(Rn({reflectSymbol:function(){return"scaleX"}})()(Rn({reflectSymbol:function(){return"scaleY"}})()(mr)(Be))(Be))),O_=He($e),B_=v(pt);var Ss=function(t){var e=y(t.Monad0().Applicative0());return{scale:function(n){return function(r){return e({image:r.image,position:r.position,composite:r.composite,dragOffset:r.dragOffset,scale:q_(n)(r.scale)})}}}},ja=function(t){var e=t.Monad0(),n=e.Applicative0(),r=y(n),u=E(e.Bind1()),a=Ut(t),o=ee(n);return{position:function(i){return r(i.position)},translate:function(i){return function(l){return r({image:l.image,scale:l.scale,composite:l.composite,dragOffset:l.dragOffset,position:Ge(i)(l.position)})}},containsPoint:function(i){return function(l){return u(a(ce(l.image)))(function(f){if(f instanceof d)return r(!1);if(f instanceof s)return r(l.position.x<=i.x&&i.x<=l.position.x+Lo(f.value0)*l.scale.scaleX&&l.position.y<=i.y&&i.y<=l.position.y+Io(f.value0)*l.scale.scaleY);throw new Error("Failed pattern match at Template.Layer.Image (line 74, column 5 - line 80, column 90): "+[f.constructor.name])})}},dragStart:function(i){return function(l){return r({image:l.image,position:l.position,scale:l.scale,composite:l.composite,dragOffset:new s(i)})}},drag:function(i){return function(l){return o(ja(t))(l.dragOffset)(i)(l)}},dragEnd:function(i){return r({image:i.image,position:i.position,scale:i.scale,composite:i.composite,dragOffset:d.value})},draw:function(i){return function(l){return function(){var c=ce(l.image)();if(c instanceof d)return void 0;if(c instanceof s)return yt(i)(function(){return zf(i)(l.composite)(),Ns(i)(c.value0)(l.position)(Xf(l.scale)(Zl(c.value0)))()})();throw new Error("Failed pattern match at Template.Layer.Image (line 88, column 5 - line 94, column 54): "+[c.constructor.name])}}}}},Ps=function(t){return function(e){return{image:e.image,position:e.position,composite:e.composite,dragOffset:e.dragOffset,scale:t}}},ei=function(t){var e=Ut(t);return function(n){return function(r){return function(u){return function(a){return e(function(){var i=xn(d.value)();return Ll(n)(function(){var l=et(Wl)(i);return function(f){return l(tt(f))}}())(),{image:i,position:r,scale:u,composite:a,dragOffset:d.value}})}}}}},As=function(t){var e=Ut(t);return function(n){return function(r){return function(u){return e(function(){var o=xn(d.value)();return{image:o,position:n,scale:r,composite:u,dragOffset:d.value}})}}}},Ws=function(t){var e=t.Monad0(),n=O_(e.Bind1()),r=Ut(t),u=y(e.Applicative0());return function(a){return function(o){return n(r(Ll(a)(function(){var i=et(Wl)(o.image);return function(l){return i(tt(l))}}())))(function(){return u(o)})}}},Us=function(t){return t.scale},Hs=function(t){var e=t.Monad0(),n=E(e.Bind1()),r=Ut(t),u=y(e.Applicative0());return function(a){return n(r(ce(a.image)))(function(o){return u(B_(Zl)(o))})}};var er=function(t){return t.throwError};var Pe=function(t){return t.lift};var Y_=v(pt);var Ya=function(t){return t},In=function(t){return t};var $r={lift:function(t){var e=Sf(t)(s.create);return function(n){return Ya(e(n))}}};var Q_=function(t){var e=v(t);return{map:function(n){return function(r){return e(Y_(n))(r)}}}},K_=function(t){return{Applicative0:function(){return So(t)},Bind1:function(){return nr(t)}}},nr=function(t){var e=E(t.Bind1()),n=y(t.Applicative0());return{bind:function(r){return function(u){return e(r)(function(a){if(a instanceof d)return n(d.value);if(a instanceof s){var o=u(a.value0);return o}throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 55, column 11 - line 57, column 42): "+[a.constructor.name])})}},Apply0:function(){return Js(t)}}},Js=function(t){var e=Q_(t.Bind1().Apply0().Functor0());return{apply:Yn(K_(t)),Functor0:function(){return e}}},So=function(t){return{pure:function(){var e=y(t.Applicative0());return function(n){return Ya(e(s.create(n)))}}(),Apply0:function(){return Js(t)}}};var qr=function(t){var e=y(t.Applicative0());return function(n){return Ya(e(n))}};var Z_=Pe($r);var Gs=function(t){var e=E(nr(t)),n=qr(t),r=Z_(t);return function(u){return function(a){return function(o){return e(n(Xe(o)(u)))(function(i){return e(r(a(i)))(function(l){return n(Vl(u)(tt(l))(o))})})}}}};var ui=function(t){return je(Gl(0)(It(t)))(t)};var tg=Wt(te),eg=Vn(vt)(Ce),ng=Jn(Ct)(vt),rg=Pe($r),og=G(Q);var js=function(t){var e=t.Applicative0(),n=t.Bind1().Apply0().Functor0(),r=ae(n),u=tg(e),a=Cn(n),o=Dt(a),i=v(n),l=Lt(a),f=wt(a),c=E(nr(t)),p=rg(t),m=qr(t),g=Ft(a),w=Gs(t),C=$t(a),W=y(So(t)),J=ne(a),st=qt(a);return{position:tt(y(e)({x:0,y:0})),translate:function($){return function(Z){return r(u(o($))(Z.layers))(function(_t){return{dragIndex:Z.dragIndex,layers:_t}})}},containsPoint:function($){return function(Z){return i(eg)(u(l($))(Z.layers))}},draw:function($){return function(Z){return ng(function(){var _t=yt($),ct=f($);return function(rn){return _t(ct(rn))}}())(En(Z.layers))}},dragStart:function($){return function(Z){return i(Zt(Z))(In(c(p(u(l({x:$.offsetX,y:$.offsetY}))(Z.layers)))(function(_t){return c(m(Mo(og)(_t)))(function(ct){return c(m(Xe(Z.layers)(ct)))(function(rn){return c(p(g(rn)))(function(On){return c(w(ct)(C({offsetX:$.offsetX-On.x,offsetY:$.offsetY-On.y}))(Z.layers))(function(pr){return W({dragIndex:new s(ct),layers:pr})})})})})})))}},drag:function($){return function(Z){return i(Zt(Z))(In(c(m(Z.dragIndex))(function(_t){return c(m(Xe(Z.layers)(_t)))(function(ct){return c(p(g(ct)))(function(rn){return c(w(_t)(J({translateX:$.translateX-rn.x,translateY:$.translateY-rn.y}))(Z.layers))(function(On){return W({dragIndex:Z.dragIndex,layers:On})})})})})))}},dragEnd:function($){return i(Zt({layers:$.layers,dragIndex:d.value}))(In(c(m($.dragIndex))(function(Z){return c(w(Z)(st)($.layers))(function(_t){return W({dragIndex:d.value,layers:_t})})})))}}},Po=function(t){return{layers:t,dragIndex:d.value}};var li=function(t){var e=y(t),n=ee(t);return{position:function(r){return e({x:r.rect.x,y:r.rect.y})},translate:function(r){return function(u){return e({fillStyle:u.fillStyle,dragOffset:u.dragOffset,rect:{width:u.rect.width,height:u.rect.height,x:u.rect.x+r.translateX,y:u.rect.y+r.translateY}})}},containsPoint:function(r){return function(u){return e(u.rect.x<=r.x&&r.x<=u.rect.x+u.rect.width&&u.rect.y<=r.y&&r.y<=u.rect.y+u.rect.height)}},draw:function(r){return function(u){return function(){return Le(r)(u.fillStyle)(),Gf(r)(Fl(r)(u.rect))()}}},dragStart:function(r){return function(u){return e({rect:u.rect,fillStyle:u.fillStyle,dragOffset:new s(r)})}},drag:function(r){return function(u){return n(li(t))(u.dragOffset)(r)(u)}},dragEnd:function(r){return e({rect:r.rect,fillStyle:r.fillStyle,dragOffset:d.value})}}},ii=function(t){return function(e){return{rect:t,fillStyle:e,dragOffset:d.value}}};var lg=He($e),ci=function(t){var e=t.Monad0(),n=e.Bind1(),r=E(n),u=Ut(t),a=lg(n),o=y(e.Applicative0());return function(i){return function(l){return r(u(ce(l)))(function(f){return r(i(f))(function(c){return a(u(Ar(c)(l)))(function(){return o(c)})})})}}},Xs=function(t){var e=on(t.Monad0().Bind1().Apply0().Functor0()),n=ci(t);return function(r){return function(u){return e(void 0)(n(r)(u))}}};var cg=De(bn),fg=function(t){return t};var Ao=function(t){var e=t.Monad0().Bind1(),n=De(e),r=Ut(t),u=on(e.Apply0().Functor0()),a=ci(t);return function(o){var i=Ft(o),l=Dt(o),f=Lt(o),c=$t(o),p=ne(o),m=qt(o),g=wt(o);return{position:function(w){return n(i)(r(ce(w)))},translate:function(w){return function(C){return u(C)(a(l(w))(C))}},containsPoint:function(w){return function(C){return n(f(w))(r(ce(C)))}},dragStart:function(w){return function(C){return u(C)(a(c(w))(C))}},drag:function(w){return function(C){return u(C)(a(p(w))(C))}},dragEnd:function(w){return u(w)(a(m)(w))},draw:function(w){return function(C){return cg(g(w))(ce(C))}}}}};var Ys=function(t){var e=Xs(t);return function(n){return function(r){return e(n)(r)}}};var sg=function(t){var e=Ut(t);return function(n){return function(r){return e(Al(n)(r))}}},Qs=function(t){var e=on(t.Monad0().Bind1().Apply0().Functor0()),n=sg(t);return function(r){return function(u){return e(void 0)(n(r)(u))}}},Ka=function(t){var e=v(t.Monad0().Bind1().Apply0().Functor0()),n=Ut(t);return function(r){return e(fg)(n(xn(r)))}};var dg={mapLayerWrapper:function(t){return function(e){var n=ae(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(r(u.layer))(function(a){return{offset:u.offset,color:u.color,blur:u.blur,layer:a}})}}}}},pg=sn(dg),Zs=function(t){var e=Ft(t),n=pg(t),r=Dt(t),u=Lt(t),a=$t(t),o=ne(t),i=qt(t),l=wt(t);return function(f){var c=n(f);return{position:function(p){return e(p.layer)},translate:function(p){return c(r(p))},containsPoint:function(p){return function(m){return u(p)(m.layer)}},dragStart:function(p){return c(a(p))},drag:function(p){return c(o(p))},dragEnd:c(i),draw:function(p){return function(m){return yt(p)(function(){return gl(p)(m.blur)(),hl(p)(m.offset.offsetX)(),Rl(p)(m.offset.offsetY)(),_l(p)(m.color)(),l(p)(m.layer)()})}}}}};var fi=function(t){return function(e){return{layer:e.layer,offset:e.offset,blur:e.blur,color:t}}},si=function(t){return function(e){return function(n){return function(r){return{layer:r,offset:t,color:e,blur:n}}}}};var mg={mapLayerWrapper:function(t){return function(e){var n=ae(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(r(u.layer))(function(a){return{offsetY:u.offsetY,gridSizeY:u.gridSizeY,layer:a}})}}}}},_g=sn(mg),gg={mapLayerWrapper:function(t){return function(e){var n=ae(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(r(u.layer))(function(a){return{offsetX:u.offsetX,gridSizeX:u.gridSizeX,layer:a}})}}}}},hg=sn(gg);var di=function(t){return function(e){return function(n){return{layer:n,gridSizeY:e,offsetY:t}}}},td=function(t){return function(e){return function(n){return{layer:n,gridSizeX:e,offsetX:t}}}};var Rg=function(t){var e=Ft(t),n=ne(t);return function(r){var u=E(r.Bind1());return function(a){return function(o){return function(i){return function(l){return u(e(l))(function(f){var c=a+o*Sr((f.y+i.translateY-a)/o);return n({translateX:i.translateX,translateY:c-f.y})(l)})}}}}}},ed=function(t){var e=Ft(t),n=_g(t),r=Dt(t),u=Lt(t),a=$t(t),o=Rg(t),i=qt(t),l=wt(t);return function(f){var c=n(f),p=o(f);return{position:function(m){return e(m.layer)},translate:function(m){return c(r(m))},containsPoint:function(m){return function(g){return u(m)(g.layer)}},dragStart:function(m){return c(a(m))},drag:function(m){return function(g){return c(p(g.offsetY)(g.gridSizeY)(m))(g)}},dragEnd:c(i),draw:function(m){return function(g){return l(m)(g.layer)}}}}},yg=function(t){var e=Ft(t),n=ne(t);return function(r){var u=E(r.Bind1());return function(a){return function(o){return function(i){return function(l){return u(e(l))(function(f){var c=a+o*Sr((f.x+i.translateX-a)/o);return n({translateX:c-f.x,translateY:i.translateY})(l)})}}}}}},nd=function(t){var e=Ft(t),n=hg(t),r=Dt(t),u=Lt(t),a=$t(t),o=yg(t),i=qt(t),l=wt(t);return function(f){var c=n(f),p=o(f);return{position:function(m){return e(m.layer)},translate:function(m){return c(r(m))},containsPoint:function(m){return function(g){return u(m)(g.layer)}},dragStart:function(m){return c(a(m))},drag:function(m){return function(g){return c(p(g.offsetX)(g.gridSizeX)(m))(g)}},dragEnd:c(i),draw:function(m){return function(g){return l(m)(g.layer)}}}}};var lt=function(t){return t};function rd(t){return t.split(/\r\n|[\n\v\f\r\u0085\u2028\u2029]/)}function od(t){return t.split(/[\u000a-\u000d\u0085\u2028\u2029\u0009\u0020\u00a0\u1680\u2000-\u200a\u202f\u205f\u3000]+/)}var bF=typeof Array.from=="function",Cg=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",TF=typeof String.prototype.fromCodePoint=="function",Eg=typeof String.prototype.codePointAt=="function",ad=function(t){return Eg?function(e){return e.codePointAt(0)}:t},ud=function(t){return function(e){return function(n){return function(r){return function(u){return function(a){var o=a.length;if(u<0||u>=o)return n;if(Cg)for(var i=a[Symbol.iterator](),l=u;;--l){var f=i.next();if(f.done)return n;if(l===0)return e(r(f.value))}return t(u)(a)}}}}}};function Sn(t){return t.charCodeAt(0)}function ld(t){return String.fromCharCode(t)}var fd=yn(oo),sd=an(oo);var mn=function(t){return t.toEnum};var Pn=function(t){return t.fromEnum};var rr=function(t){return function(e){return function(n){return t(e(n)+1|0)}}},or=function(t){return function(e){return function(n){return t(e(n)-1|0)}}};var pi=function(t){return t>=Sn(fd)&&t<=Sn(sd)?new s(ld(t)):d.value},Pg={succ:rr(pi)(Sn),pred:or(pi)(Sn),Ord0:function(){return ha}};var Uo=function(){return{cardinality:Sn(sd)-Sn(fd)|0,toEnum:pi,fromEnum:Sn,Bounded0:function(){return oo},Enum1:function(){return Pg}}}();var vi=function(t){return t.join("")};var An=function(t){return t.length};var ar=function(t){return function(e){return e.substring(t)}};var Wn=function(t){return function(e){if(t>=0&&t<e.length)return e.charAt(t);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var Og=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}},Ho=Pn(Uo);var Bg=z(_e);var vd=function(t){return function(e){return(((t-55296|0)*1024|0)+(e-56320|0)|0)+65536|0}};var md=function(t){return 56320<=t&&t<=57343},_d=function(t){return 55296<=t&&t<=56319},Za=function(t){var e=An(t);if(e===0)return d.value;if(e===1)return new s({head:Ho(Wn(0)(t)),tail:""});var n=Ho(Wn(1)(t)),r=Ho(Wn(0)(t)),u=_d(r)&&md(n);return u?new s({head:vd(r)(n),tail:ar(2)(t)}):new s({head:r,tail:ar(1)(t)})};var kg=function(t){var e=Ho(Wn(0)(t)),n=_d(e)&&An(t)>1;if(n){var r=Ho(Wn(1)(t)),u=md(r);return u?vd(e)(r):e}return e},pd=ad(kg);var _i={eq:function(t){return function(e){return t===e}}},gi={compare:function(t){return function(e){return Bg(t)(e)}},Eq0:function(){return _i}};var zg=function(t){return function(e){var n=t,r=!1,u;function a(o,i){var l=Za(i);if(l instanceof s){var f=o===0;if(f)return r=!0,new s(l.value0.head);n=o-1|0,e=l.value0.tail;return}return r=!0,d.value}for(;!r;)u=a(n,e);return u}},gd=function(t){return function(e){return t<0?d.value:t===0&&e===""?d.value:t===0?new s(pd(e)):ud(zg)(s.create)(d.value)(pd)(t)(e)}},Jg={bottom:0,top:1114111,Ord0:function(){return gi}},ur=function(){return{cardinality:1114112,fromEnum:function(t){return t},toEnum:function(t){if(t>=0&&t<=1114111)return new s(t);if(kt)return d.value;throw new Error("Failed pattern match at Data.String.CodePoints (line 63, column 1 - line 68, column 26): "+[t.constructor.name])},Bounded0:function(){return Jg},Enum1:function(){return Gg(0)}}}(),Gg=Og("enumCodePoint","Data.String.CodePoints",function(){return{succ:rr(mn(ur))(Pn(ur)),pred:or(mn(ur))(Pn(ur)),Ord0:function(){return gi}}});var eu=function(t){return od(t)};var Br=function(t){return rd(t)};var nu=t=>e=>()=>t.measureText(e);var ru=Wt(te)(Ct),oh=Rt(vt),ah=v(St),wd=v(A),uh=po(ro)(vt),yd=M(Ra),lh=so(Ct)(vt);var ou=function(t){return function(e){return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,fontName:e.fontName,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:t}}};var Di=function(t){return function(e){return{text:e.text,position:e.position,maxWidth:e.maxWidth,fontName:e.fontName,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,fillStyle:t}}},$o=function(t){return function(e){return function(){var r=nu(t)(e)();return r.width}}},ih=function(t){return function(e){return function(n){var r=eu(n);return function(){var a=ru($o(t))(r)(),o=$o(t)(" ")(),i=function(c){return function(p){if(c.value1.value0.length===0)return new x(c.value0,new x([p.value0],p.value1));var m=c.value1.value1+o+p.value1>e;return m?new x(Ot(c.value0)(c.value1.value0),new x([p.value0],p.value1)):new x(c.value0,new x(Ot(c.value1.value0)(p.value0),c.value1.value1+o+p.value1))}},l=oh(i)(new x([],new x([],0)))(je(r)(a)),f=ah(jn(" "))(l.value0);return l.value1.value0.length===0?f:Ot(f)(jn(" ")(l.value1.value0))}}}},Dd=function(t){return function(e){return function(n){return wd(Mn)(ru(ih(t)(e))(Br(n)))}}},Fi=function(t){return function(e){return function(){var r=nu(t)(e)();return r.actualBoundingBoxAscent+r.actualBoundingBoxDescent}}};var Fd=function(t){return function(e){return wd(function(){var n=Zt(0);return function(r){return n(uh(r))}}())(ru(Fi(t))(e))}},au=function(t){var e=t.Monad0().Applicative0(),n=y(e),r=Ut(t),u=ee(e);return{position:function(a){return n(a.position)},translate:function(a){return function(o){return n({text:o.text,maxWidth:o.maxWidth,fillStyle:o.fillStyle,fontName:o.fontName,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,letterSpacing:o.letterSpacing,dragOffset:o.dragOffset,context:o.context,position:Ge(a)(o.position)})}},containsPoint:function(a){return function(o){return r(yt(o.context)(function(){Le(o.context)(o.fillStyle)(),Er(o.context)(o.fontStyle+(" "+(o.fontWeight+(" "+(yd(o.fontSize)+("px "+o.fontName))))))(),Ir(o.context)(o.baseline)(),Nr(o.context)(o.align)(),tr(o.context)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return Dd(o.context)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return Br(o.text);throw new Error("Failed pattern match at Template.Layer.Text (line 75, column 14 - line 77, column 44): "+[o.maxWidth.constructor.name])}(),f=ru($o(o.context))(l)(),c=Fd(o.context)(l)();return et(xo)(ui(f))(function(p){var m=function(){return o.baseline instanceof Ee?o.position.y+c*o.lineHeight*lt(p.value0):o.baseline instanceof Ie?o.position.y-c-lt((It(l)-p.value0|0)-1|0)*c*o.lineHeight:o.position.y+c*o.lineHeight*lt(p.value0)}();if(o.align instanceof xr||o.align instanceof ie)return o.position.x<=a.x&&a.x<=o.position.x+p.value1&&m<=a.y&&a.y<=m+c;if(o.align instanceof Lr||o.align instanceof Tn)return o.position.x-p.value1<=a.x&&a.x<=o.position.x&&m<=a.y&&a.y<=m+c;if(o.align instanceof Mr)return o.position.x-p.value1/2<=a.x&&a.x<=o.position.x+p.value1/2&&m<=a.y&&a.y<=m+c;throw new Error("Failed pattern match at Template.Layer.Text (line 89, column 7 - line 104, column 41): "+[o.align.constructor.name])})}))}},dragStart:function(a){return function(o){return n({text:o.text,position:o.position,maxWidth:o.maxWidth,fillStyle:o.fillStyle,fontName:o.fontName,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,letterSpacing:o.letterSpacing,context:o.context,dragOffset:new s(a)})}},drag:function(a){return function(o){return u(au(t))(o.dragOffset)(a)(o)}},dragEnd:function(a){return n({text:a.text,position:a.position,maxWidth:a.maxWidth,fillStyle:a.fillStyle,fontName:a.fontName,fontSize:a.fontSize,fontStyle:a.fontStyle,fontWeight:a.fontWeight,align:a.align,baseline:a.baseline,lineHeight:a.lineHeight,letterSpacing:a.letterSpacing,context:a.context,dragOffset:d.value})},draw:function(a){return function(o){return yt(a)(function(){Le(a)(o.fillStyle)(),Er(a)(o.fontStyle+(" "+(o.fontWeight+(" "+(yd(o.fontSize)+("px "+o.fontName))))))(),Ir(a)(o.baseline)(),Nr(a)(o.align)(),tr(a)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return Dd(a)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return Br(o.text);throw new Error("Failed pattern match at Template.Layer.Text (line 117, column 14 - line 119, column 44): "+[o.maxWidth.constructor.name])}(),f=Fd(a)(l)();return lh(ui(l))(function(c){var p=function(){return o.baseline instanceof Ee?o.position.y+lt(c.value0)*f*o.lineHeight:o.baseline instanceof Ie?o.position.y-lt((It(l)-c.value0|0)-1|0)*f*o.lineHeight:o.position.y+lt(c.value0)*f*o.lineHeight}();return Do(a)(c.value1)(o.position.x)(p)})()})}}}};var bd=function(t){return t};var hh=bd;var bi=function(t){return t};var xd=function(t){if(It(t)>0)return new s(hh(t));if(kt)return d.value;throw new Error("Failed pattern match at Data.Array.NonEmpty (line 161, column 1 - line 161, column 58): "+[t.constructor.name])};var zr=function(t){var e=null;return function(){return t===void 0||(e=t(),t=void 0),e}},Bo=function(t){return t()};var Ch=function(t,e,n){var r=0,u;return function(a){if(r===2)return u;if(r===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+e+", line "+a+")",e,a);return r=1,u=n(),r=2,u}};var Eh=kn();var _n=function(){function t(e,n,r){this.value0=e,this.value1=n,this.value2=r}return t.create=function(e){return function(n){return function(r){return new t(e,n,r)}}},t}(),gn=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var Ld=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),Id=function(){function t(e){this.value0=e}return t.create=function(e){return new t(e)},t}(),Ei=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var Nd={defer:function(t){var e=zr(t);return function(n,r,u,a,o){var i=Bo(e);return i(n,r,u,a,o)}}};var lr={map:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return e(n,r,u,a,function(l,f){return r(function(c){return o(l,t(f))})})})}}}};var Un={alt:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return t(new _n(n.value0,n.value1,!1),r,u,function(l,f){return r(function(c){return l.value2?a(l,f):e(n,r,u,a,o)})},o)})}}},Functor0:function(){return lr}},Mh=function(t){return function(e,n,r,u,a){var o=t(e);return a(o.value1,o.value0)}};var xh=function(t){var e=t.Monad0(),n=v(e.Bind1().Apply0().Functor0()),r=y(e.Applicative0()),u=dn(t);return function(a){return function(o){var i=function(l){var f=!1,c;function p(m){var g=m(void 0);if(g instanceof Ld){l=g.value0;return}if(g instanceof Id)return f=!0,n(fe.create)(g.value0);if(g instanceof Ei)return f=!0,r(new se(new x(g.value1,g.value0)));throw new Error("Failed pattern match at Parsing (line 160, column 13 - line 166, column 32): "+[g.constructor.name])}for(;!f;)c=p(l);return c};return u(i)(function(l){return o(a,Ld.create,Id.create,function(f,c){return new Ei(f,new bt(c))},function(f,c){return new Ei(f,new gt(c))})})}}},Sd=Mh(function(t){return new x(t.value1,t)});var Lh={index:0,line:1,column:1},Ih=function(t){var e=v(t.Monad0().Bind1().Apply0().Functor0()),n=xh(t);return function(r){return function(u){var a=new _n(r,Lh,!1);return e(cn)(n(a)(u))}}},Nh=Ih(ds),Pd=function(t){var e=Nh(t);return function(n){return Eh(e(n))}};var lu=function(t){return function(e){return t.value2&&!e.value2?new _n(e.value0,e.value1,!0):e}},Hn={apply:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return t(n,r,u,a,function(l,f){return r(function(c){var p=lu(n)(l);return e(p,r,u,a,function(m,g){return r(function(w){return o(lu(p)(m),f(g))})})})})})}}},Functor0:function(){return lr}};var Jr={pure:function(t){return function(e,n,r,u,a){return a(e,t)}},Apply0:function(){return Hn}};var ir={bind:function(t){return function(e){return function(n,r,u,a,o){return r(function(i){return t(n,r,u,a,function(l,f){return r(function(c){var p=e(f);return p(lu(n)(l),r,u,a,o)})})})}}},Apply0:function(){return Hn}},Sh=De(ir);var Ad={Applicative0:function(){return Jr},Bind1:function(){return ir}};var xi={throwError:function(t){return function(e,n,r,u,a){return u(e,t)}},Monad0:function(){return Ad}},Ph=er(xi),Ah=function(t){return function(e){return Ph(new gn(t,e))}},Gr=function(t){return Sh(Ah(t))(Sd)};var iu={tailRecM:function(t){return function(e){return function(n,r,u,a,o){var i=Ch("loop","Parsing",function(){return function(f,c,p){var m=t(c);return m(f,r,u,a,function(g,w){var C=lu(f)(g);if(w instanceof fe){var W=p===0;return W?r(function(J){return i(288)(C,w.value0,30)}):i(290)(C,w.value0,p-1|0)}if(w instanceof se)return o(C,w.value0);throw new Error("Failed pattern match at Parsing (line 284, column 19 - line 292, column 46): "+[w.constructor.name])})}}),l=i(279);return l(n,e,30)}}},Monad0:function(){return Ad}};var Ye=function(){function t(){}return t.value=new t,t}(),Qe=function(){function t(e,n){this.value0=e,this.value1=n}return t.create=function(e){return function(n){return new t(e,n)}},t}();var Vr={foldr:function(t){return function(e){var n=function(){var u=function(a){return function(o){var i=a,l=!1,f;function c(p,m){if(m instanceof Ye)return l=!0,p;if(m instanceof Qe){i=new Qe(m.value0,p),o=m.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[p.constructor.name,m.constructor.name])}for(;!l;)f=c(i,o);return f}};return u(Ye.value)}(),r=Rt(Vr)(et(t))(e);return function(u){return r(n(u))}}},foldl:function(t){var e=function(n){return function(r){var u=n,a=!1,o;function i(l,f){if(f instanceof Ye)return a=!0,l;if(f instanceof Qe){u=t(l)(f.value0),r=f.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[f.constructor.name])}for(;!a;)o=i(u,r);return o}};return e},foldMap:function(t){var e=q(t.Semigroup0()),n=ht(t);return function(r){return Rt(Vr)(function(u){var a=e(u);return function(o){return a(r(o))}})(n)}}};var Bd=Mt(Un),s0=Bn(Nd);var d0=pe(Hn);var p0=Rc(Hn);var kd=function(t){return function(e){return Bd(t)(s0(function(n){return Gr("Expected "+e(void 0))}))}},Li=function(t){return function(e){return Bd(t)(Gr("Expected "+e))}};var jr=function(t){return function(e,n,r,u,a){return t(e,n,r,function(o,i){return u(new _n(o.value0,o.value1,e.value2),i)},a)}};var Jo=function(t){return function(e){return function(n){return p0(d0(t)(n))(e)}}};var Ni=E(ir),v0=dn(iu),m0=Mt(Un),cu=y(Jr),_0=jl(Vr);var g0=function(t){return Ni(et(v0)(Ye.value)(function(e){return m0(Ni(t)(function(n){return cu(new fe(new Qe(n,e)))}))(cu(new se(e)))}))(function(e){return cu(En(_0(e)))})},Si=function(t){return Ni(g0(t))(function(e){var n=xd(e);if(n instanceof d)return Gr("Expected at least 1");if(n instanceof s)return cu(n.value0);throw new Error("Failed pattern match at Parsing.Combinators.Array (line 55, column 3 - line 57, column 25): "+[n.constructor.name])})};var Pi=Pn(ur),R0=lo(ba),y0=ze(),D0=mn(Uo);var F0=M(ya);var Ai=function(t){return function(e){return function(n){var r=Pi(e);if(r===10)return{index:t.index+1|0,line:t.line+1|0,column:1};if(r===13){var u=gd(0)(n);return u instanceof s&&Pi(u.value0)===10?{index:t.index+1|0,line:t.line,column:t.column}:{index:t.index+1|0,line:t.line+1|0,column:1}}return r===9?{index:t.index+1|0,line:t.line,column:(t.column+8|0)-R0(t.column-1|0)(8)|0}:{index:t.index+1|0,line:t.line,column:t.column+1|0}}}},w0=function(t){return function(e){return function(n){var r=t,u=e,a=!1,o;function i(l,f,c){var p=Za(f);if(p instanceof d)return a=!0,l;if(p instanceof s){var m=function(){if(Tr(p.value0.tail))return Ai(l)(p.value0.head)(c);if(kt)return Ai(l)(p.value0.head)(p.value0.tail);throw new Error("Failed pattern match at Parsing.String (line 165, column 7 - line 167, column 52): ")}();r=m,u=p.value0.tail,n=c;return}throw new Error("Failed pattern match at Parsing.String (line 161, column 36 - line 168, column 38): "+[p.constructor.name])}for(;!a;)o=i(r,u,n);return o}}};var Wi=function(t){return wo(function(e){return function(n){return function(r){return function(u){return function(a){var o=Za(e.value0);if(o instanceof d)return u(e,new gn("Unexpected EOF",e.value1));if(o instanceof s){var i=Pi(o.value0.head),l=i<0||i>65535;if(l)return u(e,new gn("Expected Char",e.value1));var f=y0(D0(i)),c=t(f);return c?a(new _n(o.value0.tail,Ai(e.value1)(o.value0.head)(o.value0.tail),!0),f):u(e,new gn("Predicate unsatisfied",e.value1))}throw new Error("Failed pattern match at Parsing.String (line 114, column 7 - line 129, column 75): "+[o.constructor.name])}}}}})};var Ui=wo(function(t){return function(e){return function(n){return function(r){return function(u){var a=Tr(t.value0);return a?u(new _n(t.value0,t.value1,!0),void 0):r(t,new gn("Expected EOF",t.value1))}}}}}),Jd=function(t){return wo(function(e){return function(n){return function(r){return function(u){return function(a){var o=t(e.value0);if(o instanceof bt)return u(e,new gn(o.value0,e.value1));if(o instanceof gt)return a(new _n(o.value0.remainder,w0(e.value1)(o.value0.consumed)(o.value0.remainder),!Tr(o.value0.consumed)),o.value0.value);throw new Error("Failed pattern match at Parsing.String (line 286, column 7 - line 290, column 121): "+[o.constructor.name])}}}}})};var Hi=Jd(function(t){return new gt({value:t,consumed:t,remainder:""})});var he=function(t){return Li(Wi(function(e){return e===t}))(F0(t))};var L0=M(Gu(ya));var I0=Yl(va);var jd=function(t){return kd(Wi(et(I0)(t)))(function(e){return"none of "+L0(t)})};function fu(t,e){var n={};for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r]);for(var u in t)({}).hasOwnProperty.call(t,u)&&(n[u]=t[u]);return n}var su=function(){return function(){return function(t){return function(e){return fu(t,e)}}}};var A0=M(Ra),du=q(Oe),Go=ae(St),ep=Rt(vt),Oi=v(A),W0=po(ro)(vt),cr=Wt(te)(Ct),pu=ol(vt)(Be),Ke=v(St),U0=y(Ct),H0=v(pt),Me=v(lr),Ze=Mt(Un),_u=pe(Hn),$0=su()(),q0=xf(Ct)(te),O0=G(Q),$i=so(Ct)(vt),np=on(lr);var gu=function(){function t(){}return t.value=new t,t}(),rp=function(){function t(){}return t.value=new t,t}(),hu=function(){function t(){}return t.value=new t,t}(),op=function(){function t(){}return t.value=new t,t}();var ap=function(t){return t.text},B0=function(t){return function(e){return function(n){return{line:Ot(e.line)(n),width:e.width+t+n.width}}}},Bi=function(t){return function(e){return function(n){var r=function(){if(n.weight instanceof gu)return e.weight.normal;if(n.weight instanceof rp)return e.weight.bold;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 300, column 14 - line 302, column 37): "+[n.weight.constructor.name])}(),u=function(){if(n.style instanceof hu)return e.style.normal;if(n.style instanceof op)return e.style.italic;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 297, column 13 - line 299, column 39): "+[n.style.constructor.name])}();return Er(t)(u+(" "+(r+(" "+(A0(e.size)+("px "+e.name))))))}}},up=function(t){return function(e){return{text:e.text,position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,font:{name:e.font.name,style:e.font.style,weight:e.font.weight,size:t}}}},ki=function(t){return function(e){return{text:e.text,position:e.position,maxWidth:e.maxWidth,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,fillStyle:t}}},k0=function(t){return Tr(ap(t.fragment))},z0=function(t){return Va(k0)(t.word)},J0=function(t){return Va(z0)(t.line)};var lp=function(t){return function(e){var n=function(u){return function(a){var o=Eo(1)(t(a.text));if(o.before.length===1&&o.before[0]===""&&o.after.length===0)return{splits:u.splits,split:u.split};if(o.before.length===1&&o.after.length===0)return{splits:u.splits,split:Ot(u.split)({style:a.style,weight:a.weight,text:o.before[0]})};if(o.before.length===1&&o.before[0]===""){var i=Eo(It(o.after)-1|0)(o.after);return i.after.length===1&&i.after[0]===""?{splits:du(Ot(u.splits)(u.split))(Go(i.before)(function(l){return[{style:a.style,weight:a.weight,text:l}]})),split:[]}:i.after.length===1?{splits:du(Ot(u.splits)(u.split))(Go(i.before)(function(l){return[{style:a.style,weight:a.weight,text:l}]})),split:[{style:a.style,weight:a.weight,text:i.after[0]}]}:{splits:u.splits,split:u.split}}if(o.before.length===1){var i=Eo(It(o.after)-1|0)(o.after);return i.after.length===1&&i.after[0]===""?{splits:du(Ot(u.splits)(Ot(u.split)({style:a.style,weight:a.weight,text:o.before[0]})))(Go(i.before)(function(f){return[{style:a.style,weight:a.weight,text:f}]})),split:[]}:i.after.length===1?{splits:du(Ot(u.splits)(Ot(u.split)({style:a.style,weight:a.weight,text:o.before[0]})))(Go(i.before)(function(f){return[{style:a.style,weight:a.weight,text:f}]})),split:[{style:a.style,weight:a.weight,text:i.after[0]}]}:{splits:u.splits,split:u.split}}return{splits:u.splits,split:u.split}}},r=ep(n)({splits:[],split:[]})(e);return Ot(r.splits)(r.split)}},ip=lp(eu),zi=function(t){return{text:t,style:hu.value,weight:gu.value}};var G0=function(t){return function(e){return{fragment:t,width:e}}},cp=function(t){return function(e){return function(n){return yt(t)(function(){return Bi(t)(e)(n)(),$o(t)(n.text)()})}}},Ji=function(t){return function(e){return cp(t)(e)({style:hu.value,weight:gu.value,text:" "})}},V0=function(t){return function(e){return function(n){return yt(t)(function(){return Bi(t)(e)(n)(),Fi(t)(n.text)()})}}},j0=function(t){return function(e){return function(n){return Oi(function(){var r=Zt(0);return function(u){return r(W0(u))}}())(cr(V0(t)(e))(n))}}},X0=function(t){return function(e){return function(n){return Oi(G0(n))(cp(t)(e)(n))}}},fp=function(t){return function(e){return function(n){return function(){var u=cr(X0(t)(e))(n)(),a=pu(Ke(function(o){return o.width})(u));return{word:u,width:a}}}}},Yd=function(t){return function(e){return function(n){var r=ip(n);return function(){var a=cr(fp(t)(e))(r)(),o=Ji(t)(e)(),i=o*lt(It(a)-1|0)+pu(Ke(function(l){return l.width})(a));return{line:a,width:i}}}}},Y0=function(t){return function(e){return function(n){return function(r){var u=ip(r);return function(){var o=cr(fp(t)(e))(u)(),i=Ji(t)(e)(),l=function(c){return function(p){if(c.value1.line.length===0)return new x(c.value0,{line:[p],width:p.width});var m=c.value1.width+i+p.width>n;return m?new x(Ot(c.value0)(c.value1),{line:[p],width:p.width}):new x(c.value0,B0(i)(c.value1)(p))}},f=ep(l)(new x([],{line:[],width:0}))(o);return f.value1.line.length===0?f.value0:Ot(f.value0)(f.value1)}}}}},Gi=function(t){return function(e){return{text:e.text,position:e.position,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,maxWidth:H0(t)(e.maxWidth)}}},Vo=function(){var t=Me(bi);return function(e){return t(Si(e))}}(),jo=Me(function(t){return zi(vi(t))})(Vo(jd(["_","*"]))),qi=lp(Br),Qd=function(t){return function(e){return function(n){return function(r){return Oi(Mn)(cr(Y0(t)(e)(n))(qi(r)))}}}},vu=function(t){return{text:t.text,weight:t.weight,style:op.value}},Kd=Ze(jr(Jo(he("_"))(he("_"))(Me(vu)(jo))))(Ze(jo)(_u(he("_"))(Me(function(t){return vu(zi(t))})(Hi)))),Q0=function(t){return t.fragment},K0=function(t){return Ke(Q0)(t.word)},Z0=function(t){return Ke(K0)(t.line)},Zd=function(t){return function(e){return function(n){return function(r){return function(){var a=j0(t)(e)(Mn(Is(Z0)(r)))();return Go(r)(function(o){return $0(o)({height:function(){var i=J0(o);return i?n*e.size:a}()})})}}}}},Ru=function(t){var e=t.Monad0().Applicative0(),n=y(e),r=Ut(t),u=ee(e);return{position:function(a){return n(a.position)},translate:function(a){return function(o){return n({text:o.text,maxWidth:o.maxWidth,fillStyle:o.fillStyle,font:o.font,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,emptyLineHeight:o.emptyLineHeight,letterSpacing:o.letterSpacing,dragOffset:o.dragOffset,context:o.context,position:Ge(a)(o.position)})}},containsPoint:function(a){return function(o){return r(yt(o.context)(function(){Le(o.context)(o.fillStyle)(),Ir(o.context)(o.baseline)(),Nr(o.context)(o.align)(),tr(o.context)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return Qd(o.context)(o.font)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return cr(Yd(o.context)(o.font))(qi(o.text))();throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 204, column 15 - line 206, column 89): "+[o.maxWidth.constructor.name])}(),f=Zd(o.context)(o.font)(o.emptyLineHeight)(l)(),c=pu(Ke(function(g){return g.height})(f))+(o.lineHeight-1)*o.font.size*lt(It(f)-1|0),p=Zn(0)(Ur(function(g){return function(w){return g+w.height+(o.lineHeight-1)*o.font.size}})(0)(f)),m=q0(je(f)(p))(function(g){var w=function(){return o.baseline instanceof Ee?o.position.y+g.value1:o.baseline instanceof Ie?o.position.y+g.value1-c:o.position.y+g.value1}();return U0(function(){if(o.align instanceof xr||o.align instanceof ie)return o.position.x<=a.x&&a.x<=o.position.x+g.value0.width&&w<=a.y&&a.y<=w+g.value0.height;if(o.align instanceof Lr||o.align instanceof Tn)return o.position.x-g.value0.width<=a.x&&a.x<=o.position.x&&w<=a.y&&a.y<=w+g.value0.height;if(o.align instanceof Mr)return o.position.x-g.value0.width/2<=a.x&&a.x<=o.position.x+g.value0.width/2&&w<=a.y&&a.y<=w+g.value0.height;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 222, column 14 - line 242, column 33): "+[o.align.constructor.name])}())})();return xo(O0)(m)}))}},dragStart:function(a){return function(o){return n({text:o.text,position:o.position,maxWidth:o.maxWidth,fillStyle:o.fillStyle,font:o.font,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,emptyLineHeight:o.emptyLineHeight,letterSpacing:o.letterSpacing,context:o.context,dragOffset:new s(a)})}},drag:function(a){return function(o){return u(Ru(t))(o.dragOffset)(a)(o)}},dragEnd:function(a){return n({text:a.text,position:a.position,maxWidth:a.maxWidth,fillStyle:a.fillStyle,font:a.font,align:a.align,baseline:a.baseline,lineHeight:a.lineHeight,emptyLineHeight:a.emptyLineHeight,letterSpacing:a.letterSpacing,context:a.context,dragOffset:d.value})},draw:function(a){return function(o){return yt(a)(function(){Le(a)(o.fillStyle)(),Ir(a)(o.baseline)(),Nr(a)(ie.value)(),tr(a)(o.letterSpacing)();var l=function(){if(o.maxWidth instanceof s)return Qd(a)(o.font)(o.maxWidth.value0)(o.text)();if(o.maxWidth instanceof d)return cr(Yd(a)(o.font))(qi(o.text))();throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 257, column 15 - line 259, column 83): "+[o.maxWidth.constructor.name])}(),f=Zd(a)(o.font)(o.emptyLineHeight)(l)(),c=pu(Ke(function(m){return m.height})(f))+(o.lineHeight-1)*o.font.size*lt(It(f)-1|0),p=Zn(0)(Ur(function(m){return function(g){return m+g.height+(o.lineHeight-1)*o.font.size}})(0)(f));return $i(je(f)(p))(function(m){var g=function(){return o.baseline instanceof Ee?o.position.y+m.value1:o.baseline instanceof Ie?o.position.y+m.value1-c+m.value0.height:o.position.y+m.value1}(),w=function(){if(o.align instanceof xr||o.align instanceof ie)return o.position.x;if(o.align instanceof Lr||o.align instanceof Tn)return o.position.x-m.value0.width;if(o.align instanceof Mr)return o.position.x-m.value0.width/2;throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 278, column 16 - line 283, column 57): "+[o.align.constructor.name])}();return function(){var W=Ji(a)(o.font)(),J=Zn(0)(Ur(function(st){return function($){return st+W+$.width}})(0)(m.value0.line));return $i(je(m.value0.line)(J))(function(st){var $=Zn(0)(Ur(function(Z){return function(_t){return Z+_t.width}})(0)(st.value0.word));return $i(je(st.value0.word)($))(function(Z){return function(){return Bi(a)(o.font)(Z.value0.fragment)(),Do(a)(ap(Z.value0.fragment))(w+st.value1+Z.value1)(g)()}})})()}})()})}}}},mu=function(t){return{text:t.text,style:t.style,weight:rp.value}},t2=Ze(jr(Jo(he("*"))(he("*"))(Me(Ke(mu))(Vo(Kd)))))(_u(he("*"))(Ze(np([])(Ui))(Me(Ke(mu))(Vo(Kd))))),tp=Ze(jr(Jo(he("*"))(he("*"))(Me(mu)(jo))))(Ze(jo)(_u(he("*"))(Me(function(t){return mu(zi(t))})(Hi)))),e2=Ze(jr(Jo(he("_"))(he("_"))(Me(Ke(vu))(Vo(tp)))))(_u(he("_"))(Ze(np([])(Ui))(Me(Ke(vu))(Vo(tp))))),n2=Me(function(t){return Mn(bi(t))})(Si(Ze(e2)(Ze(t2)(Me(Jl)(jo)))));var Xo=function(t){return function(e){var n=Pd(t)(n2);if(n instanceof gt)return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:n.value0};if(n instanceof bt)return{position:e.position,maxWidth:e.maxWidth,fillStyle:e.fillStyle,font:e.font,align:e.align,baseline:e.baseline,lineHeight:e.lineHeight,emptyLineHeight:e.emptyLineHeight,letterSpacing:e.letterSpacing,dragOffset:e.dragOffset,context:e.context,text:[{text:t,style:hu.value,weight:gu.value}]};throw new Error("Failed pattern match at Template.Layer.Text.Markup (line 179, column 37 - line 181, column 106): "+[n.constructor.name])}};var dp=function(t){return t},pp=function(t){return t},vp=function(t){return t},r2={mapLayerWrapper:function(t){return function(e){var n=v(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(dp)(r(u))}}}}},o2=sn(r2);var a2={mapLayerWrapper:function(t){return function(e){var n=v(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(pp)(r(u))}}}}},u2=sn(a2);var l2={mapLayerWrapper:function(t){return function(e){var n=v(e.Bind1().Apply0().Functor0());return function(r){return function(u){return n(vp)(r(u))}}}}},i2=sn(l2);var mp=function(t){return function(e){var n=Ft(e),r=o2(e)(t),u=Lt(e),a=$t(e),o=ne(e),i=wt(e);return{position:function(l){return n(l)},translate:function(){var l=Dt(e);return function(f){return r(l(f))}}(),containsPoint:function(l){return function(f){return u(l)(f)}},dragStart:function(l){return r(a({offsetX:l.offsetX,offsetY:0}))},drag:function(l){return r(o({translateX:l.translateX,translateY:0}))},dragEnd:r(qt(e)),draw:function(l){return function(f){return i(l)(f)}}}}},_p=function(t){return function(e){var n=Ft(e),r=u2(e)(t),u=Lt(e),a=$t(e),o=ne(e),i=wt(e);return{position:function(l){return n(l)},translate:function(){var l=Dt(e);return function(f){return r(l(f))}}(),containsPoint:function(l){return function(f){return u(l)(f)}},dragStart:function(l){return r(a({offsetX:0,offsetY:l.offsetY}))},drag:function(l){return r(o({translateX:0,translateY:l.translateY}))},dragEnd:r(qt(e)),draw:function(l){return function(f){return i(l)(f)}}}}},gp=function(t){var e=y(t.Applicative0());return function(n){var r=Ft(n),u=Lt(n),a=wt(n);return{position:function(o){return r(o)},translate:function(){var o=i2(n)(t),i=Dt(n);return function(l){return o(i(l))}}(),containsPoint:function(o){return function(i){return u(o)(i)}},dragStart:tt(e),drag:tt(e),dragEnd:e,draw:function(o){return function(i){return a(o)(i)}}}}};var hp=dp,Vi=pp,hn=vp;var fr=function(t){return function(e){return function(){return e[t]}}},f2=fr("URL"),s2=fr("documentURI"),d2=fr("origin"),p2=fr("compatMode"),v2=fr("characterSet"),m2=fr("contentType");var _2=fr("documentElement");function Yo(t){return function(e){return function(){return e.createElement(t)}}}function Rp(t,e,n){return t==null?e:n(t)}var at=function(t){return Rp(t,d.value,s.create)};function yp(t,e,n,r){if(typeof window<"u"){var u=window[n];if(u!=null&&r instanceof u)return e(r)}for(var a=r;a!=null;){var o=Object.getPrototypeOf(a),i=o.constructor.name;if(i===n)return e(r);if(i==="Object")return t;a=o}return t}var F=function(t){return function(e){return yp(d.value,s.create,t,e)}};var yu=function(t){return function(e){return e[t]}},w2=yu("namespaceURI"),b2=yu("prefix"),T2=yu("localName"),C2=yu("tagName");function sr(t){return function(e){return function(n){return function(){n.setAttribute(t,e)}}}}function ji(t){return function(){var e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}}var Du=function(t){return function(e){return function(){return e[t]}}},M2=Du("children"),x2=Du("firstElementChild"),L2=Du("lastElementChild"),I2=Du("childElementCount");var Fp=_,re=_;var We=function(t){return function(e){return function(){return e[t]}}};var W2=We("baseURI"),U2=We("ownerDocument"),H2=We("parentNode"),$2=We("parentElement");var q2=We("childNodes"),O2=We("firstChild"),B2=We("lastChild"),k2=We("previousSibling"),z2=We("nextSibling"),J2=We("nodeValue");var G2=We("textContent");function Xi(t){return function(e){return function(){e.appendChild(t)}}}function wp(t){return function(e){return function(){return e.getElementById(t)}}}var K2=v(A),tn=function(t){var e=K2(at),n=wp(t);return function(r){return e(n(r))}};function Jt(t){return function(){return function(e){return t(e)()}}}function Gt(t){return function(e){return function(n){return function(r){return function(){return r.addEventListener(t,e,n)}}}}}var bp=_;function Tp(t){return function(e){return e.item(t)}}var lR=v(pt),iR=function(t){var e=Tp(t);return function(n){return at(e(n))}},Cp=function(t){var e=pn(t);return function(n){return e(function(r){return lR(et(x.create)(r+1|0))(iR(r)(n))})(0)}};function Yi(t){return function(){return URL.createObjectURL(t)}}var Qi=function(){return window};function Ep(t){return t.body}var _R=v(A);var en=_;var Mp=_,Fu=_;var xp=function(t){return _R(at)(function(){return Ep(t)})};function Lp(t,e,n){var r=Object.prototype.toString.call(n);return r.indexOf("[object HTML")===0&&r.indexOf("Element]")===r.length-8?e(n):t}function wu(t){return function(){return t.click()}}function Ki(t){return function(){return t.offsetWidth}}function Zi(t){return function(){return t.offsetHeight}}var Ip=_;var Np=_;var bu=function(t){return Lp(d.value,s.create,t)};function Tu(t){return function(){return t.checked}}function Ap(t){return function(){return t.files}}function Xr(t){return function(){return t.value}}var jR=v(A);var Qo=F("HTMLInputElement");var tc=function(){var t=jR(at);return function(e){return t(Ap(e))}}();function Cu(t){return function(){return t.value}}var Up=F("HTMLSelectElement");function Eu(t){return function(){return t.value}}var Hp=F("HTMLTextAreaElement");function ec(t){return function(){return t.document}}function Ko(t){return t.clientX}function Zo(t){return t.clientY}function ta(t){return t.touches}var Mu=F("TouchEvent");function $p(t,e){return e.item(t)}var xu=function(t){return function(e){return at($p(t,e))}};function ea(t){return t.clientX}function na(t){return t.clientY}var Lu=F("MouseEvent");var Re=y(Ct),by=He($e),oa=Ao(Xt)(Cn(A)),Ty=wt(oa),Yr=Ft(oa),qp=$t(oa),Nu=ne(oa),Op=qt(oa),nc=nr(Tt),$n=E(nc),Iu=De(nc),ra=qr(Tt),nn=Pe($r)(Tt),rc=by(nc),Bp=De(bn),oc=y(So(Tt)),Cy=Ka(Xt),Ey=su()(),Ue=Ys(Xt),My=Cp(Bl),Qr=function(t){return function(e){return function(n){return function(){var u=ji(Np(e))(),a=Ki(e)(),o=Zi(e)(),i=_o(t)(),l=go(t)();return{x:(n.x-u.left)*i/a,y:(n.y-u.top)*l/o}}}}},ye=function(t){return function(){var n=Qn(t.canvas)(),r=Jf(t.canvas)();return wl(n)({x:0,y:0,width:r.width,height:r.height})(),yt(n)(Ty(n)(t.layer))()}},xy=function(t){return Jt(function(e){var n=Mu(e);if(n instanceof d)return Re(void 0);if(n instanceof s){var r=xu(0)(ta(n.value0));if(r instanceof d)return ye(t);if(r instanceof s)return function(){var a=Yr(t.layer)(),o=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(Ko(r.value0)),y:lt(Zo(r.value0))})(),i={offsetX:o.x-a.x,offsetY:o.y-a.y};return qp(i)(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 199, column 22 - line 209, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 197, column 63 - line 209, column 22): "+[n.constructor.name])})},Ly=function(t){return Jt(function(e){var n=Mu(e);if(n instanceof d)return Re(void 0);if(n instanceof s){var r=xu(0)(ta(n.value0));if(r instanceof d)return ye(t);if(r instanceof s)return function(){var a=Yr(t.layer)(),o=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(Ko(r.value0)),y:lt(Zo(r.value0))})(),i={translateX:o.x-a.x,translateY:o.y-a.y};return Nu(i)(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 227, column 22 - line 237, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 225, column 62 - line 237, column 22): "+[n.constructor.name])})},Iy=function(t){return Jt(function(e){var n=Mu(e);if(n instanceof d)return Re(void 0);if(n instanceof s){var r=xu(0)(ta(n.value0));if(r instanceof d)return ye(t);if(r instanceof s)return function(){var a=Yr(t.layer)(),o=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(Ko(r.value0)),y:lt(Zo(r.value0))})(),i={translateX:o.x-a.x,translateY:o.y-a.y};return Nu(i)(t.layer)(),Op(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 256, column 22 - line 267, column 22): "+[r.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 254, column 61 - line 267, column 22): "+[n.constructor.name])})},ac=function(t){return function(e){return In($n(Iu(ra)(nn(Nl(t))))(function(n){return rc(nn(Il(n)(e)))(function(){return $n(nn(Bp(ec)(Qi)))(function(r){return $n(Iu(ra)(nn(tn(t)(en(r)))))(function(u){return $n(ra(bu(u)))(function(a){return oc({canvas:n,canvasElement:u,canvasHtmlElement:a,document:r})})})})})}))}},kp=function(t){var e=Ht(t);return function(n){return function(r){return function(){var a=Cy(e(r))();return Ey(n)({layer:a})}}}},Ny=function(t){return Jt(function(e){var n=Lu(e);if(n instanceof d)return Re(void 0);if(n instanceof s)return function(){var u=Yr(t.layer)(),a=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(ea(n.value0)),y:lt(na(n.value0))})(),o={translateX:a.x-u.x,translateY:a.y-u.y};return Nu(o)(t.layer)(),Op(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 240, column 60 - line 251, column 20): "+[n.constructor.name])})},Sy=function(t){return Jt(function(e){var n=Lu(e);if(n instanceof d)return Re(void 0);if(n instanceof s)return function(){var u=Yr(t.layer)(),a=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(ea(n.value0)),y:lt(na(n.value0))})(),o={translateX:a.x-u.x,translateY:a.y-u.y};return Nu(o)(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 212, column 62 - line 222, column 20): "+[n.constructor.name])})},Py=function(t){return Jt(function(e){var n=Lu(e);if(n instanceof d)return Re(void 0);if(n instanceof s)return function(){var u=Yr(t.layer)(),a=Qr(t.canvas)(t.canvasHtmlElement)({x:lt(ea(n.value0)),y:lt(na(n.value0))})(),o={offsetX:a.x-u.x,offsetY:a.y-u.y};return qp(o)(t.layer)(),ye(t)()};throw new Error("Failed pattern match at Template.Main (line 184, column 62 - line 194, column 20): "+[n.constructor.name])})},Ay=function(t){return Jt(function(e){return ye(t)})},uc=function(t){return function(e){return function(n){return function(r){return In(function(){var u=en(r.document);return $n(Iu(ra)(nn(tn(t)(u))))(function(a){return $n(nn(Jt(function(o){return function(){var l=Yo("canvas")(Fu(r.document))();sr("id")("hidden-clip-canvas")(l)();var f=xp(r.document)();if(f instanceof s){Xi(Fp(l))(Ip(f.value0))();var c=Nl("hidden-clip-canvas")();if(c instanceof s){Il(c.value0)({width:n.width,height:n.height})();var p=Qn(c.value0)(),m=r.canvas;Ml(p)(m)(n.x)(n.y)(n.width)(n.height)(0)(0)(n.width)(n.height)();var g=Wa(c.value0)(),w=Yo("a")(Fu(r.document))();sr("href")(g)(w)(),sr("download")(e)(w)();var C=bu(w);if(C instanceof s)return wu(C.value0)();throw new Error("Failed pattern match at Template.Main (line 178, column 9 - line 178, column 53): "+[C.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 167, column 5 - line 167, column 64): "+[c.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 164, column 5 - line 164, column 53): "+[f.constructor.name])}})))(function(o){return rc(nn(Gt("click")(o)(!1)(re(a))))(function(){return oc(a)})})})}())}}}},zp=function(t){return function(e){return function(n){return In(function(){var r=en(n.document);return $n(Iu(ra)(nn(tn(t)(r))))(function(u){return $n(nn(Jt(function(a){return function(){var i=Wa(n.canvas)(),l=Yo("a")(Fu(n.document))();sr("href")(i)(l)(),sr("download")(e)(l)();var f=bu(l);if(f instanceof s)return wu(f.value0)();throw new Error("Failed pattern match at Template.Main (line 149, column 9 - line 149, column 53): "+[f.constructor.name])}})))(function(a){return rc(nn(Gt("click")(a)(!1)(re(u))))(function(){return oc(u)})})})}())}}},Wy=function(t){return function(e){return function(n){return function(r){return function(){var a=tn(e)(en(t.document))();if(a instanceof s){var o=Hp(a.value0);if(o instanceof s){var i=Eu(o.value0)();Ue(r(i))(n)();var l=Jt(function(f){return function(){var p=Eu(o.value0)();return Ue(r(p))(n)()}})();return Gt("input")(l)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 303, column 7 - line 303, column 55): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 302, column 3 - line 302, column 79): "+[a.constructor.name])}}}}},aa=function(t){return function(e){return function(n){return function(r){return Wy(t)(e)(n)(function(u){return function(a){return function(o){return Re(a(o))}}(r(u))})}}}},Kr=function(t){return function(e){return function(n){return function(r){return function(){var a=tn(e)(en(t.document))();if(a instanceof s){var o=Up(a.value0);if(o instanceof s){var i=Cu(o.value0)();Ue(r(i))(n)();var l=Jt(function(f){return function(){var p=Cu(o.value0)();return Ue(r(p))(n)()}})();return Gt("input")(l)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 335, column 7 - line 335, column 54): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 334, column 3 - line 334, column 79): "+[a.constructor.name])}}}}},ua=function(t){return function(e){return function(n){return function(r){return Kr(t)(e)(n)(function(u){return function(a){return function(o){return Re(a(o))}}(r(u))})}}}},Jp=function(t){return function(e){return function(n){return function(r){return function(){var a=tn(e)(en(t.document))();if(a instanceof s){var o=Qo(a.value0);if(o instanceof s){var i=Xr(o.value0)();(function(){var f=$a(i);if(f instanceof s)return Ue(r(f.value0))(n)();if(f instanceof d)return void 0;throw new Error("Failed pattern match at Template.Main (line 354, column 3 - line 356, column 25): "+[f.constructor.name])})();var l=Jt(function(f){return function(){var p=Xr(o.value0)(),m=$a(p);if(m instanceof s)return Ue(r(m.value0))(n)();if(m instanceof d)return void 0;throw new Error("Failed pattern match at Template.Main (line 360, column 5 - line 362, column 27): "+[m.constructor.name])}})();return Gt("input")(l)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 351, column 7 - line 351, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 350, column 3 - line 350, column 79): "+[a.constructor.name])}}}}},Uy=function(t){return function(e){return function(n){return function(r){return Jp(t)(e)(n)(function(u){return function(a){return function(o){return Re(a(o))}}(r(u))})}}}};var Gp=function(t){var e=Yf(t);return function(n){return function(r){return function(u){return function(){var o=xn(1)();return Jp(n)(r)(u)(function(i){return function(l){return function(){var c=ce(o)();return Ar(i)(o)(),e(i/c)(l)()}}})()}}}}},Su=function(t){return function(e){return function(n){return Uy(t)(e)(n)(up)}}},Hy=function(t){return function(e){return function(n){return function(r){return function(){var a=tn(e)(en(t.document))();if(a instanceof s){var o=Qo(a.value0);if(o instanceof s){var i=Xr(o.value0)();Ue(r(i))(n)();var l=Jt(function(f){return function(){var p=Xr(o.value0)();return Ue(r(p))(n)()}})();return Gt("input")(l)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 287, column 7 - line 287, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 286, column 3 - line 286, column 79): "+[a.constructor.name])}}}}},Pu=function(t){return function(e){return function(n){return function(r){return Hy(t)(e)(n)(function(u){return function(a){return function(o){return Re(a(o))}}(r(u))})}}}},$y=function(t){return function(e){return function(n){return function(r){return function(){var a=tn(e)(en(t.document))();if(a instanceof s){var o=Qo(a.value0);if(o instanceof s){var i=function(c){if(c instanceof d)return Re(void 0);if(c instanceof s){var p=Xe(My(c.value0))(0);if(p instanceof d)return Re(void 0);if(p instanceof s)return Ue(r(p.value0))(n);throw new Error("Failed pattern match at Template.Main (line 390, column 24 - line 392, column 54): "+[p.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 388, column 26 - line 392, column 54): "+[c.constructor.name])},l=tc(o.value0)();i(l)();var f=Jt(function(c){return Bp(i)(tc(o.value0))})();return Gt("change")(f)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 385, column 7 - line 385, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 384, column 3 - line 384, column 79): "+[a.constructor.name])}}}}};var qy=function(t){return function(e){return function(n){return function(r){return function(){var a=tn(e)(en(t.document))();if(a instanceof s){var o=Qo(a.value0);if(o instanceof s){var i=Tu(o.value0)();Ue(r(i))(n)();var l=Jt(function(f){return function(){var p=Tu(o.value0)();return Ue(r(p))(n)()}})();return Gt("input")(l)(!1)(re(a.value0))()}throw new Error("Failed pattern match at Template.Main (line 319, column 7 - line 319, column 52): "+[o.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 318, column 3 - line 318, column 79): "+[a.constructor.name])}}}}},lc=function(t){return function(e){return function(n){return function(r){return qy(t)(e)(n)(function(u){return function(a){return function(o){return Re(a(o))}}(r(u))})}}}},Oy=function(t){return function(e){return function(n){return function(r){return $y(t)(e)(n)(function(u){return r(bp(u))})}}}};var ic=function(t){return function(e){return function(n){return function(r){return Oy(t)(e)(n)(function(u){return function(a){return function(){var i=Yi(u)();return r(i)(a)()}}})}}}},cc=function(t){return function(){var n=Py(t)(),r=Sy(t)(),u=Ny(t)(),a=xy(t)(),o=Ly(t)(),i=Iy(t)(),l=Ay(t)();return Gt("mousedown")(n)(!1)(re(t.canvasElement))(),Gt("mousemove")(r)(!1)(re(t.canvasElement))(),Gt("mouseup")(u)(!1)(re(t.canvasElement))(),Gt("touchstart")(a)(!1)(re(t.canvasElement))(),Gt("touchmove")(o)(!1)(re(t.canvasElement))(),Gt("touchend")(i)(!1)(re(t.canvasElement))(),Gt("input")(l)(!1)(Mp(t.document))()}};var ky=He($e),zy=Vn(vt)(Ce),jp=Wt(te),sc=Nt(A),Jy=jp(Ct),Xp=le(_r()(Rn({reflectSymbol:function(){return"height"}})()(Rn({reflectSymbol:function(){return"width"}})()(mr)(Be))(Be))),dr=De(bn),Yt=Ka(Xt),Yp=As(Xt),Bt=Ws(Xt),Qp=Gp(Ss(Xt)),Zr=ei(Xt),Au=Ao(Xt),Kp=Ht(Au(Ru(Xt))),Zp=Ht(Au(au(Xt))),dc=gp(Tt),tv=ja(Xt),ev=Au(tv),la=Ht(dc(ev)),nv=Ht(_p(Tt)(ed(Ql(Tt))(Tt))),rv=js(Tt),ov=Ht(Au(Zs(rv)(Tt))),av=Ht(ev),uv=Ht(dc(li(Ct))),lv=kp(rv),Gy=Ht(dc(tv));var iv=function(t){var e=ja(t),n=Ft(e),r=t.Monad0(),u=r.Bind1(),a=E(u),o=v(u.Apply0().Functor0()),i=Hs(t),l=Dt(e),f=r.Applicative0(),c=y(f),p=Lt(e),m=wt(e),g=$t(e),w=ee(f),C=qt(e);return{position:function(W){return n(W.guillotine)},translate:function(W){return function(J){return a(o(function(st){return function($){return $+W.translateX}(function($){return $.x}(st))})(n(J.guillotine)))(function(st){return a(i(J.guillotine))(function($){var Z=Us(J.guillotine).scaleY,_t=function(){return $ instanceof s&&$.value0.width!==0?Ps({scaleX:(J.xMax-st)/$.value0.width,scaleY:Z})(J.guillotine):J.guillotine}();return a(l(W)(_t))(function(ct){return c({xMax:J.xMax,guillotine:ct})})})})}},containsPoint:function(W){return function(J){return p(W)(J.guillotine)}},draw:function(W){return function(J){return m(W)(J.guillotine)}},dragStart:function(W){return function(J){return a(g(W)(J.guillotine))(function(st){return c({xMax:J.xMax,guillotine:st})})}},drag:function(W){return function(J){return w(iv(t))(J.guillotine.dragOffset)(W)(J)}},dragEnd:function(W){return a(C(W.guillotine))(function(J){return c({xMax:W.xMax,guillotine:J})})}}},cv=function(t){var e=t.Monad0(),n=Pl(e),r=Ft(n),u=e.Bind1(),a=E(u),o=Dt(n),i=iv(t),l=Dt(i),f=Ao(t),c=f(au(t)),p=Dt(c),m=f(Ru(t)),g=Dt(m),w=ky(u),C=Qs(t),W=e.Applicative0(),J=y(W),st=u.Apply0().Functor0(),$=v(st),Z=jp(W),_t=Cn(st),ct=Lt(_t),rn=Ht(n),On=Ht(i),pr=Ht(m),mc=Ht(c),sv=wt(_t),dv=$t(n),pv=ee(W),vv=qt(n);return{position:function(mt){return r(mt.overlayBackground)},translate:function(mt){return function(ut){return a(o(mt)(ut.overlayBackground))(function(Wu){return a(l(mt)(ut.guillotine))(function(mv){return a(p(mt)(ut.author))(function(_v){return a(g(mt)(ut.title))(function(_c){return w(C(Gi(function(Uu){return Uu-mt.translateX}))(_c))(function(){return w(C(Gi(function(Uu){return Uu-mt.translateX}))(ut.bodyText))(function(){return J({overlayBackground:Wu,guillotine:mv,author:_v,bodyText:ut.bodyText,title:_c})})})})})})})}},containsPoint:function(mt){return function(ut){return $(zy)(Z(ct(mt))([rn(ut.overlayBackground),On(ut.guillotine),pr(ut.bodyText),mc(ut.author),pr(ut.title)]))}},draw:function(mt){return function(ut){return sc(Jy(sv(mt))([rn(ut.overlayBackground),On(ut.guillotine),pr(ut.bodyText),mc(ut.author),pr(ut.title)]))}},dragStart:function(mt){return function(ut){return a(dv(mt)(ut.overlayBackground))(function(Wu){return J({guillotine:ut.guillotine,bodyText:ut.bodyText,author:ut.author,title:ut.title,overlayBackground:Wu})})}},drag:function(mt){return function(ut){return pv(cv(t))(ut.overlayBackground.dragOffset)(mt)(ut)}},dragEnd:function(mt){return a(vv(mt.overlayBackground))(function(ut){return J({guillotine:mt.guillotine,bodyText:mt.bodyText,author:mt.author,title:mt.title,overlayBackground:ut})})}}},Vy=Ht(mp(Tt)(nd(cv(Xt))(Tt))),I=2;var jy={width:1080,height:1920},pc=Xp({width:I,height:I})(jy),fc=function(){return pc.height}(),Vp=function(){return pc.width}();var Xy=function(t){var e=t.Monad0(),n=E(e.Bind1()),r=ei(t),u=y(e.Applicative0());return function(a){return function(o){return function(i){return function(l){return n(r(a)(o)(i)(Ne.value))(function(f){return u({guillotine:f,xMax:l})})}}}}},Yy=Xy(Xt),Qy=function(){return{width:1080,height:1080*5/4}}(),vc=function(){return Xp({width:2*I,height:I})(Qy)}(),qn=function(){return vc.height}(),Et=function(){return vc.width}(),Ky=sc(function(){var e=ac("canvas-story")(pc)();if(e instanceof s){var n=Qn(e.value0.canvas)(),r=dr(Yt)(Yp({x:0,y:120*I})({scaleX:1,scaleY:1})(Ne.value))();ic(e.value0)("image")(r)(Bt)(),Qp(e.value0)("image-size")(r)();var u=dr(Yt)(Zr("./img/guillotinewit2x.png")({x:60*I,y:180*I})({scaleX:1,scaleY:1})(Ne.value))(),a=dr(Yt)(Zr("./img/jacobinlogowit80x200.png")({x:Et/2-100*I,y:fc-610*I})({scaleX:1,scaleY:1})(Ne.value))(),o=dr(Yt)(Zr("./img/story-overlay.svg")({x:0,y:0})({scaleX:2,scaleY:2})(Ne.value))(),i={x:60*I,y:fc-2*60*I},l=Yt({text:[],lineHeight:.9,position:i,maxWidth:new s(Vp-2*60*I),fillStyle:"#fff",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:100*I},align:ie.value,baseline:Ie.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();aa(e.value0)("title-left")(l)(Xo)(),Su(e.value0)("title-size-story")(l)();var f=Yt({text:"AUTEUR",lineHeight:.95,position:i,fillStyle:"#fff",fontName:"Oswald",fontStyle:"normal",fontWeight:"500",fontSize:I*50,align:ie.value,baseline:Ee.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();Pu(e.value0)("author")(f)(ou)(),ua(e.value0)("color")(l)(ki)(),ua(e.value0)("color")(f)(Di)(),Kr(e.value0)("color")(a)(function(C){if(C==="#fff")return Bt("./img/jacobinlogowit80x200.png");if(C==="#f00")return Bt("./img/jacobinlogo80x200.png");if(C==="#000")return Bt("./img/jacobinlogozwart80x200.png");if(C==="#fff")return Bt("./img/jacobinlogowit80x200.png");throw new Error("Failed pattern match at Jacobin.TitleSlide (line 416, column 56 - line 420, column 68): "+[C.constructor.name])})(),Kr(e.value0)("color")(u)(function(C){return Bt(C==="#fff"?"./img/guillotinewit2x.png":C==="#f00"?"./img/guillotine2x.png":C==="#000"?"./img/guillotinezwart2x.png":"./img/guillotinewit2x.png")})();var c=di(i.y)(50*I)(Kl([Kp(l),Zp(f)])),p=Yt(si({offsetX:0,offsetY:0})("#555")(15)(Po([la(hn(a)),nv(Vi(c)),la(hn(u))])))();lc(e.value0)("shadow")(p)(function(C){return fi(function(){return C?"#555":"#0000"}())})();var m=Po([ov(p),la(hn(o)),av(r),uv(hn(ii({x:0,y:0,width:Vp,height:fc})("#f00")))]),g=lv(e.value0)(m)();ye(g)(),cc(g)();var w=zp("download-story")("jacobin-story.png")(g)();if(w instanceof s)return void 0;throw new Error("Failed pattern match at Jacobin.TitleSlide (line 455, column 3 - line 455, column 75): "+[w.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 348, column 3 - line 348, column 83): "+[e.constructor.name])}),Zy=sc(function(){var e=ac("canvas-title-slide")(vc)();if(e instanceof s){var n=Qn(e.value0.canvas)(),r=dr(Yt)(Yp({x:0,y:0})({scaleX:1,scaleY:1})(Ne.value))();ic(e.value0)("image")(r)(Bt)(),Qp(e.value0)("image-size")(r)();var u=Yy("./img/guillotine2x.png")({x:Et/2+285*I,y:60*I})({scaleX:(Et-180*I-(Et/2+285*I))/1560,scaleY:1})(Et-180*I)(),a=dr(Yt)(Zr("./img/guillotinewit2x.png")({x:60*I,y:60*I})({scaleX:1,scaleY:1})(Ne.value))(),o=Zr("./img/jacobinlogo80x200.png")({x:Et-100*I,y:qn-160*I})({scaleX:1,scaleY:1})(Ne.value)(),i=dr(Yt)(Zr("./img/jacobinlogowit80x200.png")({x:Et/2-100*I,y:qn-160*I})({scaleX:1,scaleY:1})(Ne.value))(),l=Yt({text:[],lineHeight:1.1,position:{x:Et-I*60,y:I*150},fillStyle:"#f00",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"500",bold:"700"},size:90*I},align:Tn.value,baseline:Ee.value,letterSpacing:"-3px",emptyLineHeight:.25,dragOffset:d.value,maxWidth:new s(Et/2-2*60*I),context:n})();aa(e.value0)("bodytext")(l)(Xo)(),Su(e.value0)("bodytext-size")(l)();var f={x:60*I,y:250*I},c=Yt({text:[],lineHeight:.9,position:f,maxWidth:new s(Et/2-2*60*I),fillStyle:"#fff",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:100*I},align:ie.value,baseline:Ie.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();aa(e.value0)("title-left")(c)(Xo)(),Su(e.value0)("title-size")(c)();var p=Yt({text:"AUTEUR",lineHeight:.95,position:f,fillStyle:"#fff",fontName:"Oswald",fontStyle:"normal",fontWeight:"500",fontSize:I*50,align:ie.value,baseline:Ee.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();Pu(e.value0)("author")(p)(ou)();var m=di(f.y)(50*I)(Kl([Kp(c),Zp(p)])),g=Yt({text:"AUTEUR",lineHeight:.95,position:{x:Et/2+128*I,y:qn-160*I},fillStyle:"#f00",fontName:"Oswald",fontStyle:"normal",fontWeight:"400",fontSize:2*50,align:ie.value,baseline:Ie.value,letterSpacing:"-3px",dragOffset:d.value,maxWidth:d.value,context:n})();Pu(e.value0)("author")(g)(function(ct){return ou(Ia(ct))})();var w=Yt({text:[],lineHeight:.9,position:{x:Et/2+128*I,y:qn-160*I},maxWidth:new s(Et/2-(128+2*60+20)*I),fillStyle:"#f00",font:{name:"Oswald",style:{normal:"normal",italic:"italic"},weight:{normal:"700",bold:"700"},size:50*I},align:ie.value,baseline:Ee.value,letterSpacing:"-2px",emptyLineHeight:.25,dragOffset:d.value,context:n})();aa(e.value0)("title-right")(w)(Xo)(),ua(e.value0)("color")(c)(ki)(),ua(e.value0)("color")(p)(Di)(),Kr(e.value0)("color")(i)(function(ct){if(ct==="#fff")return Bt("./img/jacobinlogowit80x200.png");if(ct==="#f00")return Bt("./img/jacobinlogo80x200.png");if(ct==="#000")return Bt("./img/jacobinlogozwart80x200.png");if(ct==="#fff")return Bt("./img/jacobinlogowit80x200.png");throw new Error("Failed pattern match at Jacobin.TitleSlide (line 292, column 61 - line 296, column 68): "+[ct.constructor.name])})(),Kr(e.value0)("color")(a)(function(ct){return Bt(ct==="#fff"?"./img/guillotinewit2x.png":ct==="#f00"?"./img/guillotine2x.png":ct==="#000"?"./img/guillotinezwart2x.png":"./img/guillotinewit2x.png")})();var C=Zf({x:Et/2+60*I,y:0})({width:Et,height:qn})(82.5)("#fff"),W=td(Et/2)(60*I)({overlayBackground:C,guillotine:u,bodyText:l,author:g,title:w}),J=Yt(si({offsetX:0,offsetY:0})("#555")(15)(Po([la(hn(i)),nv(Vi(m)),la(hn(a))])))();lc(e.value0)("shadow")(J)(function(ct){return fi(function(){return ct?"#555":"#0000"}())})();var st=Po([Gy(hn(o)),Vy(hp(W)),ov(J),av(r),uv(hn(ii({x:0,y:0,width:Et,height:qn})("#f00")))]),$=lv(e.value0)(st)();ye($)(),cc($)();var Z=uc("download-left")("jacobin-titel-links.png")({x:0,y:0,width:Et/2,height:qn})($)();if(Z instanceof s){var _t=uc("download-right")("jacobin-titel-rechts.png")({x:Et/2,y:0,width:Et/2,height:qn})($)();if(_t instanceof s)return void 0;throw new Error("Failed pattern match at Jacobin.TitleSlide (line 343, column 3 - line 343, column 173): "+[_t.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 342, column 3 - line 342, column 155): "+[Z.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 153, column 3 - line 153, column 84): "+[e.constructor.name])}),fv=pe(Aa)(Zy)(Ky);fv();})();
