/* Generated by Spago v0.93.44 */
(()=>{var Qe={compose:function(n){return function(r){return function(e){return n(r(e))}}}};var V=function(n){return n.identity},Z={identity:function(n){return n},Semigroupoid0:function(){return Qe}};var mn=function(n){return function(r){return function(e){return n(e)(r)}}},k=function(n){return function(r){return n}};var Ha=function(n){return function(r){for(var e=r.length,t=new Array(e),a=0;a<e;a++)t[a]=n(r[a]);return t}};var I=function(){function n(){}return n.value=new n,n}();var m=function(n){return n.map},kt=function(n){var r=m(n);return function(e){return function(t){return r(t)(e)}}},dn=function(n){return m(n)(k(void 0))};var wr=function(n){var r=m(n);return function(e){return r(k(e))}};var Wn={map:Ha};var nc=V(Z);var bn=function(n){return n.apply};var ve=function(n){var r=bn(n),e=m(n.Functor0());return function(t){return function(a){return r(e(k(nc))(t))(a)}}};var T=function(n){return n.pure};var ge=function(n){var r=bn(n.Apply0()),e=T(n);return function(t){return function(a){return r(e(t))(a)}}};var tc=typeof Array.prototype.flatMap=="function"?function(n){return function(r){return n.flatMap(r)}}:function(n){return function(r){for(var e=[],t=n.length,a=0;a<t;a++)for(var o=r(n[a]),u=o.length,f=0;f<u;f++)e.push(o[f]);return e}};var Qn=function(n){return n.discard};var N=function(n){return n.bind},Xn=function(n){return mn(N(n))};var Yn={discard:function(n){return N(n)}};var Wa=function(n){return function(r){return function(e){for(var t=r,a=e.length,o=a-1;o>=0;o--)t=n(e[o])(t);return t}}},Ua=function(n){return function(r){return function(e){for(var t=r,a=e.length,o=0;o<a;o++)t=n(t)(e[o]);return t}}};var wn=function(n){return n.reflectSymbol};var Un=function(n){return function(r){return r[n]}},Sn=function(n){return function(r){return function(e){var t={};for(var a in e)({}).hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t[n]=r,t}}};var tn=function(n){return n.append};var lc=Number.POSITIVE_INFINITY,sc=Number.NEGATIVE_INFINITY;var pc=function(n){return function(r){return function(e){return function(t){return function(a){return t<a?n:t===a?r:e}}}}};var qa=pc;var _c=function(n){return function(r){return n===r}};var Oa=_c;var Ba={eq:Oa};var rn=function(n){return n.eq};var $=function(){function n(){}return n.value=new n,n}(),H=function(){function n(){}return n.value=new n,n}(),X=function(){function n(){}return n.value=new n,n}();var ye={eq:function(n){return function(r){return n instanceof $&&r instanceof $||n instanceof H&&r instanceof H||n instanceof X&&r instanceof X}}};var ka=function(n){return function(r){return n-r}};var Ja=function(n){return function(r){return n+r}},Ga=function(n){return function(r){return n*r}};var Va=function(n){return n.zeroRecord},Zn=function(n){return n.zero};var Yr={addRecord:function(n){return function(r){return function(e){return{}}}},mulRecord:function(n){return function(r){return function(e){return{}}}},oneRecord:function(n){return function(r){return{}}},zeroRecord:function(n){return function(r){return{}}}};var dr={add:Ja,zero:0,mul:Ga,one:1};var za=function(n){return n.oneRecord},or=function(n){return n.one},ja=function(n){return n.mulRecord},Nn=function(n){return n.mul},Qa=function(n){return n.addRecord},Kr=function(){return function(n){return{add:Qa(n)(I.value),mul:ja(n)(I.value),one:za(n)(I.value)(I.value),zero:Va(n)(I.value)(I.value)}}},ar=function(n){return n.add};var _r=function(n){var r=wn(n);return function(){return function(e){var t=Qa(e),a=ja(e),o=za(e),u=Va(e);return function(f){var i=ar(f),_=Nn(f),c=or(f),v=Zn(f);return{addRecord:function(h){return function(W){return function(C){var M=t(I.value)(W)(C),L=r(I.value),w=Sn(L),an=Un(L);return w(i(an(W))(an(C)))(M)}}},mulRecord:function(h){return function(W){return function(C){var M=a(I.value)(W)(C),L=r(I.value),w=Sn(L),an=Un(L);return w(_(an(W))(an(C)))(M)}}},oneRecord:function(h){return function(W){var C=o(I.value)(I.value),M=r(I.value),L=Sn(M);return L(c)(C)}},zeroRecord:function(h){return function(W){var C=u(I.value)(I.value),M=r(I.value),L=Sn(M);return L(v)(C)}}}}}}};var Dc=Kr(),Xa=function(n){return n.subRecord},De=function(n){return n.sub};var jt={subRecord:function(n){return function(r){return function(e){return{}}}},SemiringRecord0:function(){return Yr}},Ke=function(n){var r=wn(n),e=_r(n)();return function(){return function(t){var a=Xa(t),o=e(t.SemiringRecord0());return function(u){var f=De(u),i=o(u.Semiring0());return{subRecord:function(_){return function(c){return function(v){var h=a(I.value)(c)(v),W=r(I.value),C=Sn(W),M=Un(W);return C(f(M(c))(M(v)))(h)}}},SemiringRecord0:function(){return i}}}}}},Qt=function(){return function(n){var r=Dc(n.SemiringRecord0());return{sub:Xa(n)(I.value),Semiring0:function(){return r}}}};var Ze={sub:ka,Semiring0:function(){return dr}};var Yt=function(){return{compare:qa($.value)(X.value)(H.value),Eq0:function(){return Ba}}}();var Y=function(n){return n.compare};var Ya=function(n){var r=n.toString();return isNaN(r+".0")?r:r+".0"};var Ka={show:Ya};var G=function(n){return n.show};var Pc=V(Z),s=function(){function n(){}return n.value=new n,n}(),l=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var gr=function(n){return function(r){return function(e){if(e instanceof s)return n;if(e instanceof l)return r(e.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,r.constructor.name,e.constructor.name])}}},re=gr(!0)(k(!1));var vn={map:function(n){return function(r){return r instanceof l?new l(n(r.value0)):s.value}}};var Jn=function(n){return gr(n)(Pc)},Sr=function(){return function(n){if(n instanceof l)return n.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])}};var nu=function(n){return function(r){return n&&r}},ru=function(n){return function(r){return n||r}},eu=function(n){return!n};var Zt=function(n){return n.not};var et=function(n){return n.ff};var he=function(n){return n.disj},nr={ff:!1,tt:!0,implies:function(n){return function(r){return he(nr)(Zt(nr)(n))(r)}},conj:nu,disj:ru,not:eu};var Rn=function(n){return n.mempty};var Q=function(){function n(r,e){this.value0=r,this.value1=e}return n.create=function(r){return function(e){return new n(r,e)}},n}();var ee=function(n){return n.value1};var te=function(n){return n.value0};var fo=function(n){return n};var Zc=function(n){var r=he(n);return{append:function(e){return function(t){return r(e)(t)}}}};var lu=function(n){var r=Zc(n);return{mempty:et(n),Semigroup0:function(){return r}}};var p=function(n){return n};var su=function(){return p};var el=su();var lo=function(){return function(){return function(){return function(){return function(n){return el}}}}};var ul=V(Z),il=rn(ye);var fl=lo()()()(),ot=function(n){return n.foldr};var Nr=function(n){var r=ve(n.Apply0()),e=T(n);return function(t){var a=ot(t);return function(o){return a(function(u){return r(o(u))})(e(void 0))}}},_o=function(n){var r=Nr(n);return function(e){return mn(r(e))}};var Ee=function(n){return n.foldl};var mu=function(n){var r=Ee(n);return function(e){var t=function(a){return function(o){if(a instanceof s)return new l(o);if(a instanceof l)return new l(function(){var u=il(e(a.value0)(o))(H.value);return u?a.value0:o}());throw new Error("Failed pattern match at Data.Foldable (line 441, column 3 - line 441, column 27): "+[a.constructor.name,o.constructor.name])}};return r(t)(s.value)}},vo=function(n){var r=Y(n);return function(e){return mu(e)(r)}};var pu=function(n){var r=ot(n);return function(e){var t=tn(e.Semigroup0()),a=Rn(e);return function(o){return r(function(u){return function(f){return t(o(u))(f)}})(a)}}},yn={foldr:Wa,foldl:Ua,foldMap:function(n){return pu(yn)(n)}};var go=function(n){return n.foldMap};var du=function(n){var r=go(n);return function(e){return fl(fo)(r(lu(e)))}};var Rr=function(n){var r=du(n);return function(e){return r(e)(ul)}};var at=function(n){return n.toUpperCase()};var oe=function(n){return function(r){return r.join(n)}};var _u=function(){function n(a){return[a]}function r(a){return function(o){return[a,o]}}function e(a){return function(o){return function(u){return[a,o,u]}}}function t(a){return function(o){return a.concat(o)}}return function(a){return function(o){return function(u){return function(f){return function(i){function _(c,v){switch(v-c){case 0:return u([]);case 1:return o(n)(f(i[c]));case 2:return a(o(r)(f(i[c])))(f(i[c+1]));case 3:return a(a(o(e)(f(i[c])))(f(i[c+1])))(f(i[c+2]));default:var h=c+Math.floor((v-c)/4)*2;return a(o(t)(_(c,h)))(_(h,v))}}return _(0,i.length)}}}}}}();var Al=V(Z),rr=function(n){return n.traverse};var Wl=function(n){var r=rr(n);return function(e){return r(e)(Al)}},er={traverse:function(n){var r=n.Apply0();return _u(bn(r))(m(r.Functor0()))(T(n))},sequence:function(n){return Wl(er)(n)},Functor0:function(){return Wn},Foldable1:function(){return yn}};var hu=function(n){return function(){return n}},Cu=function(n){return function(r){return function(){return r(n())()}}};var Eu=function(n){var r=N(n.Bind1()),e=T(n.Applicative0());return function(t){return function(a){return r(a)(function(o){return e(t(o))})}}},Fe=function(n){var r=N(n.Bind1()),e=T(n.Applicative0());return function(t){return function(a){return r(t)(function(o){return r(a)(function(u){return e(o(u))})})}}};var Mu=function(n,r,e){var t=0,a;return function(o){if(t===2)return a;if(t===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return t=1,a=e(),t=2,a}},Dn={Applicative0:function(){return hn},Bind1:function(){return Dr}},Dr={bind:Cu,Apply0:function(){return To(0)}},hn={pure:hu,Apply0:function(){return To(0)}},Fu=Mu("functorEffect","Effect",function(){return{map:ge(hn)}}),To=Mu("applyEffect","Effect",function(){return{apply:Fe(Dn),Functor0:function(){return Fu(0)}}}),F=Fu(20),xu=To(23);var Cn={liftEffect:V(Z),Monad0:function(){return Dn}},En=function(n){return n.liftEffect};function Iu(n){return function(r){return function(e){return function(){var t=new Image;t.src=n,t.addEventListener("load",function(){e(t)()},!1),t.addEventListener("error",function(){r()},!1)}}}}function Lu(n,r,e){return function(){var t=document.getElementById(n);return t&&t instanceof HTMLCanvasElement?r(t):e}}function ae(n){return function(){return n.getContext("2d")}}function Ie(n){return function(){return n.width}}function Le(n){return function(){return n.height}}function bo(n){return function(r){return function(){n.width=r}}}function ho(n){return function(r){return function(){n.height=r}}}function Co(n){return function(){return n.toDataURL()}}function Tr(n){return function(r){return function(){n.fillStyle=r}}}function wu(n){return function(r){return function(){n.globalCompositeOperation=r}}}function we(n){return function(){n.beginPath()}}function Se(n){return function(){n.fill()}}function Ne(n){return function(r){return function(e){return function(){n.lineTo(r,e)}}}}function Eo(n){return function(r){return function(e){return function(){n.moveTo(r,e)}}}}function Mo(n){return function(){n.closePath()}}function Fo(n){return function(r){return function(){n.rect(r.x,r.y,r.width,r.height)}}}function xo(n){return function(r){return function(){n.clearRect(r.x,r.y,r.width,r.height)}}}function Io(n){return function(r){return function(){n.translate(r.translateX,r.translateY)}}}function Su(n){return function(r){return function(){n.textAlign=r}}}function Nu(n){return function(r){return function(){n.textBaseline=r}}}function ft(n){return function(r){return function(){n.font=r}}}function Lo(n){return function(r){return function(e){return function(t){return function(){n.fillText(r,e,t)}}}}}function wo(n){return function(){n.save()}}function So(n){return function(){n.restore()}}function No(n){return function(r){return function(e){return function(t){return function(a){return function(o){return function(){n.drawImage(r,e,t,a,o)}}}}}}}function Ro(n){return function(r){return function(e){return function(t){return function(a){return function(o){return function(u){return function(f){return function(i){return function(_){return function(){n.drawImage(r,e,t,a,o,u,f,i,_)}}}}}}}}}}}var Ql=ve(xu),fr=function(){function n(){}return n.value=new n,n}(),Xl=function(){function n(){}return n.value=new n,n}(),Yl=function(){function n(){}return n.value=new n,n}(),Kl=function(){function n(){}return n.value=new n,n}(),Zl=function(){function n(){}return n.value=new n,n}(),ue=function(){function n(){}return n.value=new n,n}(),br=function(){function n(){}return n.value=new n,n}(),Re=function(){function n(){}return n.value=new n,n}(),Ho=function(){function n(){}return n.value=new n,n}(),Ao=function(){function n(){}return n.value=new n,n}(),Wo=function(){function n(){}return n.value=new n,n}();var ie=function(){function n(){}return n.value=new n,n}(),ns=function(){function n(){}return n.value=new n,n}(),rs=function(){function n(){}return n.value=new n,n}(),es=function(){function n(){}return n.value=new n,n}(),ts=function(){function n(){}return n.value=new n,n}(),os=function(){function n(){}return n.value=new n,n}(),as=function(){function n(){}return n.value=new n,n}(),us=function(){function n(){}return n.value=new n,n}(),is=function(){function n(){}return n.value=new n,n}(),fs=function(){function n(){}return n.value=new n,n}(),cs=function(){function n(){}return n.value=new n,n}(),ls=function(){function n(){}return n.value=new n,n}(),ss=function(){function n(){}return n.value=new n,n}(),ms=function(){function n(){}return n.value=new n,n}(),ps=function(){function n(){}return n.value=new n,n}(),ds=function(){function n(){}return n.value=new n,n}(),_s=function(){function n(){}return n.value=new n,n}(),vs=function(){function n(){}return n.value=new n,n}(),gs=function(){function n(){}return n.value=new n,n}(),ys=function(){function n(){}return n.value=new n,n}(),Ds=function(){function n(){}return n.value=new n,n}(),Ts=function(){function n(){}return n.value=new n,n}(),bs=function(){function n(){}return n.value=new n,n}(),hs=function(){function n(){}return n.value=new n,n}(),Cs=function(){function n(){}return n.value=new n,n}(),Es=function(){function n(){}return n.value=new n,n}(),Fn=function(n){return function(r){return function(){wo(n)();var t=r();return So(n)(),t}}},Uo=function(n){return function(r){return Iu(n)(r(s.value))(function(e){return r(l.create(e))})}};var $o=function(n){return function(r){var e=function(t){if(t instanceof fr)return"top";if(t instanceof Xl)return"hanging";if(t instanceof Yl)return"middle";if(t instanceof Kl)return"alphabetic";if(t instanceof Zl)return"ideographic";if(t instanceof ue)return"bottom";throw new Error("Failed pattern match at Graphics.Canvas (line 577, column 5 - line 577, column 33): "+[t.constructor.name])};return Nu(n)(e(r))}},qo=function(n){return function(r){var e=function(t){if(t instanceof br)return"left";if(t instanceof Re)return"right";if(t instanceof Ho)return"center";if(t instanceof Ao)return"start";if(t instanceof Wo)return"end";throw new Error("Failed pattern match at Graphics.Canvas (line 531, column 5 - line 531, column 32): "+[t.constructor.name])};return Su(n)(e(r))}};var Au=function(n){return function(r){var e=function(t){if(t instanceof ie)return"source-over";if(t instanceof ns)return"source-in";if(t instanceof rs)return"source-out";if(t instanceof es)return"source-atop";if(t instanceof ts)return"destination-over";if(t instanceof os)return"destination-in";if(t instanceof as)return"destination-out";if(t instanceof us)return"destination-atop";if(t instanceof is)return"lighter";if(t instanceof fs)return"copy";if(t instanceof cs)return"xor";if(t instanceof ls)return"multiply";if(t instanceof ss)return"screen";if(t instanceof ms)return"overlay";if(t instanceof ps)return"darken";if(t instanceof ds)return"lighten";if(t instanceof _s)return"color-dodge";if(t instanceof vs)return"color-burn";if(t instanceof gs)return"hard-light";if(t instanceof ys)return"soft-light";if(t instanceof Ds)return"difference";if(t instanceof Ts)return"exclusion";if(t instanceof bs)return"hue";if(t instanceof hs)return"saturation";if(t instanceof Cs)return"color";if(t instanceof Es)return"luminosity";throw new Error("Failed pattern match at Graphics.Canvas (line 326, column 5 - line 326, column 45): "+[t.constructor.name])};return wu(n)(e(r))}},Oo=function(n){return function(r){return Ql(ho(n)(r.height))(bo(n)(r.width))}},Bo=function(n){return Lu(n,l.create,s.value)},Wu=function(n){return function(){var e=Ie(n)(),t=Le(n)();return{width:e,height:t}}},Uu=function(n){return function(r){return function(){we(n)();var t=r();return Se(n)(),t}}};var ct=isFinite;function $u(n,r,e,t){var a=parseFloat(n);return r(a)?e(a):t}var lt=Math.tan;var Ou=3.141592653589793;var ko=function(n){return $u(n,ct,l.create,s.value)};var mt=function(n){return function(r){return r(function(e){return n(e)})}},hr=function(n){return function(r){return{x:r.x+n.translateX,y:r.y+n.translateY}}};var xn=function(n){return n.translate},Bu=function(n){return function(r){return{width:r.width*n.scaleX,height:r.height*n.scaleY}}},Jo=function(n){return n.scale},ku=function(n){var r=Jo(n);return function(e){return r({scaleX:e,scaleY:e})}},Pn=function(n){return n.position},In=function(n){return function(r){return function(e){return e(n)(r)}}},Ls=function(n){var r=m(n);return function(e){return mt(function(t){var a=r(In(t)),o=e(t);return function(u){return a(o(u))}})}};var Go=function(n){return n.mapLayerWrapper},Mn=function(n){return n.draw},ws=function(n){var r=xn(n);return function(e){return function(t){return function(a){var o={translateX:t.translateX-e.offsetX,translateY:t.translateY-e.offsetY};return r(o)(a)}}}},Hn=function(n){var r=T(n);return function(e){var t=ws(e);return function(a){return function(o){return function(u){if(a instanceof s)return r(u);if(a instanceof l)return t(a.value0)(o)(u);throw new Error("Failed pattern match at Template.Layer (line 59, column 1 - line 59, column 115): "+[a.constructor.name,o.constructor.name,u.constructor.name])}}}}},qn=function(n){return n.dragStart},On=function(n){return n.dragEnd},lr=function(n){return n.drag},An=function(n){return n.containsPoint},Cr=function(n){var r=Ls(n);return{position:mt(function(e){return Pn(e)}),translate:function(e){return r(function(t){return xn(t)(e)})},containsPoint:function(e){return mt(function(t){return An(t)(e)})},draw:function(e){return mt(function(t){return Mn(t)(e)})},dragStart:function(e){return r(function(t){return qn(t)(e)})},drag:function(e){return r(function(t){return lr(t)(e)})},dragEnd:r(function(e){return On(e)})}};var Gu=function(n){return function(r){return function(e){return function(t){return{position:n,dimensions:r,angle:e,fillStyle:t,dragOffset:s.value}}}}},Ju=function(n){return n*Ou/180},Vo=function(n){var r=n.Applicative0(),e=T(r),t=Hn(r);return{position:function(a){return e(a.position)},translate:function(a){return function(o){return e({dimensions:o.dimensions,angle:o.angle,fillStyle:o.fillStyle,dragOffset:o.dragOffset,position:hr(a)(o.position)})}},containsPoint:function(a){return function(o){var u=(o.dimensions.height-a.y)/lt(Ju(o.angle));return e(o.position.x+u<=a.x&&a.x<=o.position.x+o.dimensions.width&&o.position.y<=a.y&&a.y<=o.position.y+o.dimensions.height)}},draw:function(a){return function(o){return Fn(a)(function(){return Tr(a)(o.fillStyle)(),we(a)(),Eo(a)(o.position.x)(o.position.y+o.dimensions.height)(),Ne(a)(o.position.x+o.dimensions.width)(o.position.y+o.dimensions.height)(),Ne(a)(o.position.x+o.dimensions.width)(o.position.y)(),Ne(a)(o.position.x+o.dimensions.height/lt(Ju(o.angle)))(o.position.y)(),Mo(a)(),Se(a)()})}},dragStart:function(a){return function(o){return e({position:o.position,dimensions:o.dimensions,angle:o.angle,fillStyle:o.fillStyle,dragOffset:new l(a)})}},drag:function(a){return function(o){return t(Vo(n))(o.dragOffset)(a)(o)}},dragEnd:function(a){return e({position:a.position,dimensions:a.dimensions,angle:a.angle,fillStyle:a.fillStyle,dragOffset:s.value})}}};var Vu=function(n,r){for(var e=n>r?-1:1,t=new Array(e*(r-n)+1),a=n,o=0;a!==r;)t[o++]=a,a+=e;return t[o]=a,t},Ns=function(n,r){if(n<1)return[];var e=new Array(n);return e.fill(r)},Rs=function(n,r){for(var e=[],t=0,a=0;a<n;a++)e[t++]=r;return e},Ps=typeof Array.prototype.fill=="function"?Ns:Rs;var Er=function(n){return n.length};var zu=function(n,r,e,t){return t<0||t>=e.length?r:n(e[t])};var ju=function(n,r,e,t){for(var a=0,o=t.length;a<o;a++)if(e(t[a]))return n(a);return r};var Qu=function(n,r,e,t,a){if(e<0||e>=a.length)return r;var o=a.slice();return o[e]=t,n(o)},Pe=function(n){return n.slice().reverse()},zo=function(n){if(n.length<=1e4)return Array.prototype.concat.apply([],n);for(var r=[],e=0,t=n.length;e<t;e++)for(var a=n[e],o=0,u=a.length;o<u;o++)r.push(a[o]);return r};var Xu=function(n,r,e){for(var t=r.length<e.length?r.length:e.length,a=new Array(t),o=0;o<t;o++)a[o]=n(r[o])(e[o]);return a},Yu=function(n,r){for(var e=r.length,t=0;t<e;t++)if(n(r[t]))return!0;return!1};var Ku=function(n){return function(){return{value:n}}};var Ln=function(n){return function(){return n.value}},Zu=function(n){return function(r){return function(){var e=n(r.value);return r.value=e.state,e.value}}},fe=function(n){return function(r){return function(){r.value=n}}};var Ws=dn(F),Mr=Ku,Us=Zu,jo=function(n){return Us(function(r){var e=n(r);return{state:e,value:e}})},Qo=function(n){return function(r){return Ws(jo(n)(r))}};function Gs(n){return n}var ai=Gs;function Vs(n){return n.slice()}var ui=Vs;var ii=function(n,r){return r.push(n)};var dt=function(r){return function(e){return function(){return r(e)}}},Yo=function(r){return function(e){return function(t){return function(){return r(e,t)}}}};var fi=dt(ai);var Zs=dt(ui),ci=function(n){return function(r){return function(){var t=Zs(r)();return n(t)(),fi(t)()}}};var Ko=Yo(ii);var Ae=function(n){return function(r){return function(e){return n(r,e)}}},Zo=function(n){return function(r){return function(e){return function(t){return n(r,e,t)}}}},_t=function(n){return function(r){return function(e){return function(t){return function(a){return n(r,e,t,a)}}}}},na=function(n){return function(r){return function(e){return function(t){return function(a){return function(o){return n(r,e,t,a,o)}}}}}};var mi=function(n){return function(r){return function(e){return function(t){return function(a){return function(o){for(var u=[],f=o;;){var i=a(f);if(n(i))return u;var _=r(i);u.push(e(_)),f=t(_)}}}}}}};var pi=function(n){return function(r){return function(e){return function(t){return function(a){return function(o){for(var u=[],f=o;;){var i=a(f);u.push(e(i));var _=t(i);if(n(_))return u;f=r(_)}}}}}}};var lm=Sr();var di={unfoldr1:pi(re)(lm)(te)(ee)};var dm=Sr(),We=function(n){return n.unfoldr};var ra={unfoldr:mi(re)(dm)(te)(ee),Unfoldable10:function(){return di}};var vm=Zo(Xu);var vt=function(){return vm(Q.create)}();var gm=function(){return na(Qu)(l.create)(s.value)}();var $e=function(n){return function(r){return ci(Ko(r))(n)()}};var vi=Ae(Vu);var sr=function(){return _t(zu)(l.create)(s.value)}();var gi=function(n){return function(r){return function(e){var t=function(a){return gm(n)(r(a))(e)};return gr(s.value)(t)(sr(e)(n))}}};var ea=function(){return _t(ju)(l.create)(s.value)}();var yi=Ae(Yu);var ym=Rr(yn)(nr),Dm=rr(er),Tm=De(Qt()(Ke({reflectSymbol:function(){return"x"}})()(Ke({reflectSymbol:function(){return"y"}})()(jt)(Ze))(Ze))),bm=Nr(hn)(yn);var ta=function(n){var r=n.Applicative0(),e=T(r),t=n.Bind1().Apply0().Functor0(),a=m(t),o=Dm(r),u=Cr(t),f=An(u),i=Mn(u),_=Hn(r);return{position:function(c){return e(c.position)},translate:function(c){return function(v){return e({layers:v.layers,dragOffset:v.dragOffset,position:hr(c)(v.position)})}},containsPoint:function(c){return function(v){return a(ym)(o(f(Tm(c)(v.position)))(v.layers))}},draw:function(c){return function(v){return Fn(c)(function(){return Io(c)({translateX:v.position.x,translateY:v.position.y})(),bm(function(){var W=Fn(c),C=i(c);return function(M){return W(C(M))}}())(Pe(v.layers))()})}},dragStart:function(c){return function(v){return e({layers:v.layers,position:v.position,dragOffset:new l(c)})}},drag:function(c){return function(v){return _(ta(n))(v.dragOffset)(c)(v)}},dragEnd:function(c){return e({layers:c.layers,position:c.position,dragOffset:s.value})}}},Di=function(n){return{layers:n,position:{x:0,y:0},dragOffset:s.value}};var qe=n=>n.width,Oe=n=>n.height;var gt=n=>r=>()=>n.letterSpacing=r;var Ti=function(n){return function(r){return function(e){return function(t){return No(n)(r)(e.x)(e.y)(t.width)(t.height)}}}};var oa=function(n){return{width:qe(n),height:Oe(n)}};var Em=Nn(Kr()(_r({reflectSymbol:function(){return"scaleX"}})()(_r({reflectSymbol:function(){return"scaleY"}})()(Yr)(dr))(dr))),Mm=Qn(Yn),Fm=m(vn);var hi=function(n){var r=T(n.Monad0().Applicative0());return{scale:function(e){return function(t){return r({image:t.image,position:t.position,composite:t.composite,dragOffset:t.dragOffset,scale:Em(e)(t.scale)})}}}},yt=function(n){var r=n.Monad0(),e=r.Applicative0(),t=T(e),a=N(r.Bind1()),o=En(n),u=Hn(e);return{position:function(f){return t(f.position)},translate:function(f){return function(i){return t({image:i.image,scale:i.scale,composite:i.composite,dragOffset:i.dragOffset,position:hr(f)(i.position)})}},containsPoint:function(f){return function(i){return a(o(Ln(i.image)))(function(_){if(_ instanceof s)return t(!1);if(_ instanceof l)return t(i.position.x<=f.x&&f.x<=i.position.x+qe(_.value0)*i.scale.scaleX&&i.position.y<=f.y&&f.y<=i.position.y+Oe(_.value0)*i.scale.scaleY);throw new Error("Failed pattern match at Template.Layer.Image (line 74, column 5 - line 78, column 107): "+[_.constructor.name])})}},dragStart:function(f){return function(i){return t({image:i.image,position:i.position,scale:i.scale,composite:i.composite,dragOffset:new l(f)})}},drag:function(f){return function(i){return u(yt(n))(i.dragOffset)(f)(i)}},dragEnd:function(f){return t({image:f.image,position:f.position,scale:f.scale,composite:f.composite,dragOffset:s.value})},draw:function(f){return function(i){return function(){var c=Ln(i.image)();if(c instanceof s)return void 0;if(c instanceof l)return Fn(f)(function(){return Au(f)(i.composite)(),Ti(f)(c.value0)(i.position)(Bu(i.scale)(oa(c.value0)))()})();throw new Error("Failed pattern match at Template.Layer.Image (line 86, column 5 - line 91, column 78): "+[c.constructor.name])}}}}},Ci=function(n){return function(r){return{image:r.image,position:r.position,composite:r.composite,dragOffset:r.dragOffset,scale:n}}},aa=function(n){var r=En(n);return function(e){return function(t){return function(a){return function(o){return r(function(){var f=Mr(s.value)();return Uo(e)(function(){var i=mn(Qo)(f);return function(_){return i(k(_))}}())(),{image:f,position:t,scale:a,composite:o,dragOffset:s.value}})}}}}},Ei=function(n){var r=En(n);return function(e){return function(t){return function(a){return r(function(){var u=Mr(s.value)();return{image:u,position:e,scale:t,composite:a,dragOffset:s.value}})}}}},Mi=function(n){var r=n.Monad0(),e=Mm(r.Bind1()),t=En(n),a=T(r.Applicative0());return function(o){return function(u){return e(t(Uo(o)(function(){var f=mn(Qo)(u.image);return function(i){return f(k(i))}}())))(function(){return a(u)})}}},Fi=function(n){return n.scale},xi=function(n){var r=n.Monad0(),e=N(r.Bind1()),t=En(n),a=T(r.Applicative0());return function(o){return e(t(Ln(o.image)))(function(u){return a(Fm(oa)(u))})}};var Fr=function(n){return n.lift};var Am=m(vn);var Tt=function(n){return n},Ur=function(n){return n};var ce={lift:function(n){var r=Eu(n)(l.create);return function(e){return Tt(r(e))}}};var Wm=function(n){var r=m(n);return{map:function(e){return function(t){return r(Am(e))(t)}}}},Um=function(n){return{Applicative0:function(){return Be(n)},Bind1:function(){return $r(n)}}},$r=function(n){var r=N(n.Bind1()),e=T(n.Applicative0());return{bind:function(t){return function(a){return r(t)(function(o){if(o instanceof s)return e(s.value);if(o instanceof l){var u=a(o.value0);return u}throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 55, column 11 - line 57, column 42): "+[o.constructor.name])})}},Apply0:function(){return Ii(n)}}},Ii=function(n){var r=Wm(n.Bind1().Apply0().Functor0());return{apply:Fe(Um(n)),Functor0:function(){return r}}},Be=function(n){return{pure:function(){var r=T(n.Applicative0());return function(e){return Tt(r(l.create(e)))}}(),Apply0:function(){return Ii(n)}}};var le=function(n){var r=T(n.Applicative0());return function(e){return Tt(r(e))}};var $m=Fr(ce);var Li=function(n){var r=N($r(n)),e=le(n),t=$m(n);return function(a){return function(o){return function(u){return r(e(sr(u)(a)))(function(f){return r(t(o(f)))(function(i){return e(gi(a)(k(i))(u))})})}}}};var ia=function(n){return vt(vi(0)(Er(n)))(n)};var qm=rr(er),Om=Rr(yn)(nr),Bm=Nr(hn)(yn),km=Fr(ce),Jm=V(Z);var Si=function(n){var r=n.Applicative0(),e=n.Bind1().Apply0().Functor0(),t=kt(e),a=qm(r),o=Cr(e),u=xn(o),f=m(e),i=An(o),_=Mn(o),c=N($r(n)),v=km(n),h=le(n),W=Pn(o),C=Li(n),M=qn(o),L=T(Be(n)),w=lr(o),an=On(o);return{position:k(T(r)({x:0,y:0})),translate:function(S){return function(B){return t(a(u(S))(B.layers))(function(Tn){return{dragIndex:B.dragIndex,layers:Tn}})}},containsPoint:function(S){return function(B){return f(Om)(a(i(S))(B.layers))}},draw:function(S){return function(B){return Bm(function(){var Tn=Fn(S),sn=_(S);return function(pr){return Tn(sn(pr))}}())(Pe(B.layers))}},dragStart:function(S){return function(B){return f(Jn(B))(Ur(c(v(a(i({x:S.offsetX,y:S.offsetY}))(B.layers)))(function(Tn){return c(h(ea(Jm)(Tn)))(function(sn){return c(h(sr(B.layers)(sn)))(function(pr){return c(v(W(pr)))(function(zr){return c(C(sn)(M({offsetX:S.offsetX-zr.x,offsetY:S.offsetY-zr.y}))(B.layers))(function($t){return L({dragIndex:new l(sn),layers:$t})})})})})})))}},drag:function(S){return function(B){return f(Jn(B))(Ur(c(h(B.dragIndex))(function(Tn){return c(h(sr(B.layers)(Tn)))(function(sn){return c(v(W(sn)))(function(pr){return c(C(Tn)(w({translateX:S.translateX-pr.x,translateY:S.translateY-pr.y}))(B.layers))(function(zr){return L({dragIndex:B.dragIndex,layers:zr})})})})})))}},dragEnd:function(S){return f(Jn({layers:S.layers,dragIndex:s.value}))(Ur(c(h(S.dragIndex))(function(B){return c(C(B)(an)(S.layers))(function(Tn){return L({dragIndex:s.value,layers:Tn})})})))}}},Ni=function(n){return{layers:n,dragIndex:s.value}};var fa=function(n){var r=T(n),e=Hn(n);return{position:function(t){return r({x:t.rect.x,y:t.rect.y})},translate:function(t){return function(a){return r({fillStyle:a.fillStyle,dragOffset:a.dragOffset,rect:{width:a.rect.width,height:a.rect.height,x:a.rect.x+t.translateX,y:a.rect.y+t.translateY}})}},containsPoint:function(t){return function(a){return r(a.rect.x<=t.x&&t.x<=a.rect.x+a.rect.width&&a.rect.y<=t.y&&t.y<=a.rect.y+a.rect.height)}},draw:function(t){return function(a){return function(){return Tr(t)(a.fillStyle)(),Uu(t)(Fo(t)(a.rect))()}}},dragStart:function(t){return function(a){return r({rect:a.rect,fillStyle:a.fillStyle,dragOffset:new l(t)})}},drag:function(t){return function(a){return e(fa(n))(a.dragOffset)(t)(a)}},dragEnd:function(t){return r({rect:t.rect,fillStyle:t.fillStyle,dragOffset:s.value})}}},ca=function(n){return function(r){return{rect:n,fillStyle:r,dragOffset:s.value}}};var zm=Qn(Yn),la=function(n){var r=n.Monad0(),e=r.Bind1(),t=N(e),a=En(n),o=zm(e),u=T(r.Applicative0());return function(f){return function(i){return t(a(Ln(i)))(function(_){return t(f(_))(function(c){return o(a(fe(c)(i)))(function(){return u(c)})})})}}},Ri=function(n){var r=wr(n.Monad0().Bind1().Apply0().Functor0()),e=la(n);return function(t){return function(a){return r(void 0)(e(t)(a))}}};var Qm=Xn(Dr),Xm=function(n){return n};var ke=function(n){var r=n.Monad0().Bind1(),e=Xn(r),t=En(n),a=wr(r.Apply0().Functor0()),o=la(n);return function(u){var f=Pn(u),i=xn(u),_=An(u),c=qn(u),v=lr(u),h=On(u),W=Mn(u);return{position:function(C){return e(f)(t(Ln(C)))},translate:function(C){return function(M){return a(M)(o(i(C))(M))}},containsPoint:function(C){return function(M){return e(_(C))(t(Ln(M)))}},dragStart:function(C){return function(M){return a(M)(o(c(C))(M))}},drag:function(C){return function(M){return a(M)(o(v(C))(M))}},dragEnd:function(C){return a(C)(o(h)(C))},draw:function(C){return function(M){return Qm(W(C))(Ln(M))}}}}};var Pi=function(n){var r=Ri(n);return function(e){return function(t){return r(e)(t)}}};var Ym=function(n){var r=En(n);return function(e){return function(t){return r(jo(e)(t))}}},Hi=function(n){var r=wr(n.Monad0().Bind1().Apply0().Functor0()),e=Ym(n);return function(t){return function(a){return r(void 0)(e(t)(a))}}},ht=function(n){var r=m(n.Monad0().Bind1().Apply0().Functor0()),e=En(n);return function(t){return r(Xm)(e(Mr(t)))}};var cn=function(n){return n};function Wi(n){return n.split(/\r\n|[\n\v\f\r\u0085\u2028\u2029]/)}function Ui(n){return n.split(/[\u000a-\u000d\u0085\u2028\u2029\u0009\u0020\u00a0\u1680\u2000-\u200a\u202f\u205f\u3000]+/)}var IC=typeof Array.from=="function",LC=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",wC=typeof String.prototype.fromCodePoint=="function",SC=typeof String.prototype.codePointAt=="function";var Vi=function(n){return Ui(n)};var Ft=function(n){return Wi(n)};var xt=n=>r=>()=>n.measureText(r);var It=rr(er)(hn),hp=Ee(yn),Cp=m(Wn),Xi=m(F),Ep=vo(Yt)(yn),zi=G(Ka),Mp=_o(hn)(yn),Fp=m(vn);var se=function(n){return function(r){return{position:r.position,maxWidth:r.maxWidth,fillStyle:r.fillStyle,fontName:r.fontName,fontSize:r.fontSize,fontStyle:r.fontStyle,fontWeight:r.fontWeight,align:r.align,baseline:r.baseline,lineHeight:r.lineHeight,letterSpacing:r.letterSpacing,dragOffset:r.dragOffset,context:r.context,text:n}}},Yi=function(n){return function(r){return{text:r.text,position:r.position,maxWidth:r.maxWidth,fillStyle:r.fillStyle,fontName:r.fontName,fontStyle:r.fontStyle,fontWeight:r.fontWeight,align:r.align,baseline:r.baseline,lineHeight:r.lineHeight,letterSpacing:r.letterSpacing,dragOffset:r.dragOffset,context:r.context,fontSize:n}}},da=function(n){return function(r){return function(){var t=xt(n)(r)();return t.width}}},xp=function(n){return function(r){return function(e){var t=Vi(e);return function(){var o=It(da(n))(t)(),u=da(n)(" ")(),f=function(c){return function(v){if(c.value1.value0.length===0)return new Q(c.value0,new Q([v.value0],v.value1));var h=c.value1.value1+u+v.value1>r;return h?new Q($e(c.value0)(c.value1.value0),new Q([v.value0],v.value1)):new Q(c.value0,new Q($e(c.value1.value0)(v.value0),c.value1.value1+u+v.value1))}},i=hp(f)(new Q([],new Q([],0)))(vt(t)(o)),_=Cp(oe(" "))(i.value0);return i.value1.value0.length===0?_:$e(_)(oe(" ")(i.value1.value0))}}}},ji=function(n){return function(r){return function(e){return Xi(zo)(It(xp(n)(r))(Ft(e)))}}},Ip=function(n){return function(r){return function(){var t=xt(n)(r)();return t.actualBoundingBoxAscent+t.actualBoundingBoxDescent}}};var Qi=function(n){return function(r){return Xi(function(){var e=Jn(0);return function(t){return e(Ep(t))}}())(It(Ip(n))(r))}},Lt=function(n){var r=n.Monad0().Applicative0(),e=T(r),t=En(n),a=Hn(r);return{position:function(o){return e(o.position)},translate:function(o){return function(u){return e({text:u.text,maxWidth:u.maxWidth,fillStyle:u.fillStyle,fontName:u.fontName,fontSize:u.fontSize,fontStyle:u.fontStyle,fontWeight:u.fontWeight,align:u.align,baseline:u.baseline,lineHeight:u.lineHeight,letterSpacing:u.letterSpacing,dragOffset:u.dragOffset,context:u.context,position:hr(o)(u.position)})}},containsPoint:function(o){return function(u){return t(Fn(u.context)(function(){Tr(u.context)(u.fillStyle)(),ft(u.context)(u.fontStyle+(" "+(u.fontWeight+(" "+(zi(u.fontSize)+("px "+u.fontName))))))(),$o(u.context)(u.baseline)(),qo(u.context)(u.align)(),gt(u.context)(u.letterSpacing)();var i=function(){if(u.maxWidth instanceof l)return ji(u.context)(u.maxWidth.value0)(u.text)();if(u.maxWidth instanceof s)return Ft(u.text);throw new Error("Failed pattern match at Template.Layer.Text (line 66, column 14 - line 68, column 44): "+[u.maxWidth.constructor.name])}(),_=It(da(u.context))(i)(),c=Qi(u.context)(i)();return mn(yi)(ia(_))(function(v){var h=function(){return u.baseline instanceof fr?u.position.y+c*u.lineHeight*cn(v.value0):u.baseline instanceof ue?u.position.y-c-cn((Er(i)-v.value0|0)-1|0)*c*u.lineHeight:u.position.y+c*u.lineHeight*cn(v.value0)}();if(u.align instanceof Ao||u.align instanceof br)return u.position.x<=o.x&&o.x<=u.position.x+v.value1&&h<=o.y&&o.y<=h+c;if(u.align instanceof Wo||u.align instanceof Re)return u.position.x-v.value1<=o.x&&o.x<=u.position.x&&h<=o.y&&o.y<=h+c;if(u.align instanceof Ho)return u.position.x-v.value1/2<=o.x&&o.x<=u.position.x+v.value1/2&&h<=o.y&&o.y<=h+c;throw new Error("Failed pattern match at Template.Layer.Text (line 79, column 7 - line 89, column 65): "+[u.align.constructor.name])})}))}},dragStart:function(o){return function(u){return e({text:u.text,position:u.position,maxWidth:u.maxWidth,fillStyle:u.fillStyle,fontName:u.fontName,fontSize:u.fontSize,fontStyle:u.fontStyle,fontWeight:u.fontWeight,align:u.align,baseline:u.baseline,lineHeight:u.lineHeight,letterSpacing:u.letterSpacing,context:u.context,dragOffset:new l(o)})}},drag:function(o){return function(u){return a(Lt(n))(u.dragOffset)(o)(u)}},dragEnd:function(o){return e({text:o.text,position:o.position,maxWidth:o.maxWidth,fillStyle:o.fillStyle,fontName:o.fontName,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,align:o.align,baseline:o.baseline,lineHeight:o.lineHeight,letterSpacing:o.letterSpacing,context:o.context,dragOffset:s.value})},draw:function(o){return function(u){return Fn(o)(function(){Tr(o)(u.fillStyle)(),ft(o)(u.fontStyle+(" "+(u.fontWeight+(" "+(zi(u.fontSize)+("px "+u.fontName))))))(),$o(o)(u.baseline)(),qo(o)(u.align)(),gt(o)(u.letterSpacing)();var i=function(){if(u.maxWidth instanceof l)return ji(o)(u.maxWidth.value0)(u.text)();if(u.maxWidth instanceof s)return Ft(u.text);throw new Error("Failed pattern match at Template.Layer.Text (line 102, column 14 - line 104, column 44): "+[u.maxWidth.constructor.name])}(),_=Qi(o)(i)();return Mp(ia(i))(function(c){var v=function(){return u.baseline instanceof fr?u.position.y+cn(c.value0)*_*u.lineHeight:u.baseline instanceof ue?u.position.y-cn((Er(i)-c.value0|0)-1|0)*_*u.lineHeight:u.position.y+cn(c.value0)*_*u.lineHeight}();return Lo(o)(c.value1)(u.position.x)(v)})()})}}}},_a=function(n){return function(r){return{text:r.text,position:r.position,fillStyle:r.fillStyle,fontName:r.fontName,fontSize:r.fontSize,fontStyle:r.fontStyle,fontWeight:r.fontWeight,align:r.align,baseline:r.baseline,lineHeight:r.lineHeight,letterSpacing:r.letterSpacing,dragOffset:r.dragOffset,context:r.context,maxWidth:Fp(n)(r.maxWidth)}}};var Zi=function(n){return n};var nf=function(n){return n},Lp={mapLayerWrapper:function(n){return function(r){var e=m(r.Bind1().Apply0().Functor0());return function(t){return function(a){return e(Zi)(t(a))}}}}},wp=Go(Lp);var Sp={mapLayerWrapper:function(n){return function(r){var e=m(r.Bind1().Apply0().Functor0());return function(t){return function(a){return e(nf)(t(a))}}}}},Np=Go(Sp);var rf=function(n){return function(r){var e=Pn(r),t=wp(r)(n),a=An(r),o=qn(r),u=lr(r),f=Mn(r);return{position:function(i){return e(i)},translate:function(){var i=xn(r);return function(_){return t(i(_))}}(),containsPoint:function(i){return function(_){return a(i)(_)}},dragStart:function(i){return t(o({offsetX:i.offsetX,offsetY:0}))},drag:function(i){return t(u({translateX:i.translateX,translateY:0}))},dragEnd:t(On(r)),draw:function(i){return function(_){return f(i)(_)}}}}};var ef=function(n){var r=T(n.Applicative0());return function(e){var t=Pn(e),a=An(e),o=Mn(e);return{position:function(u){return t(u)},translate:function(){var u=Np(e)(n),f=xn(e);return function(i){return u(f(i))}}(),containsPoint:function(u){return function(f){return a(u)(f)}},dragStart:k(r),drag:k(r),dragEnd:r,draw:function(u){return function(f){return o(u)(f)}}}}};var tf=Zi;var Je=nf;function wt(n,r){var e={};for(var t in r)({}).hasOwnProperty.call(r,t)&&(e[t]=r[t]);for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}var of=function(){return function(){return function(n){return function(r){return wt(n,r)}}}};var qr=function(n){return function(r){return function(){return r[n]}}},Wp=qr("URL"),Up=qr("documentURI"),$p=qr("origin"),qp=qr("compatMode"),Op=qr("characterSet"),Bp=qr("contentType");var kp=qr("documentElement");function St(n){return function(r){return function(){return r.createElement(n)}}}function af(n,r,e){return n==null?r:e(n)}var q=function(n){return af(n,s.value,l.create)};function uf(n,r,e,t){if(typeof window<"u"){var a=window[e];if(a!=null&&t instanceof a)return r(t)}for(var o=t;o!=null;){var u=Object.getPrototypeOf(o),f=u.constructor.name;if(f===e)return r(t);if(f==="Object")return n;o=u}return n}var g=function(n){return function(r){return uf(s.value,l.create,n,r)}};var Nt=function(n){return function(r){return r[n]}},Xp=Nt("namespaceURI"),Yp=Nt("prefix"),Kp=Nt("localName"),Zp=Nt("tagName");function Ge(n){return function(r){return function(e){return function(){e.setAttribute(n,r)}}}}function va(n){return function(){var r=n.getBoundingClientRect();return{top:r.top,right:r.right,bottom:r.bottom,left:r.left,width:r.width,height:r.height,x:r.x,y:r.y}}}var Rt=function(n){return function(r){return function(){return r[n]}}},rd=Rt("children"),ed=Rt("firstElementChild"),td=Rt("lastElementChild"),od=Rt("childElementCount");var lf=p,mr=p;var Vn=function(n){return function(r){return function(){return r[n]}}};var cd=Vn("baseURI"),ld=Vn("ownerDocument"),sd=Vn("parentNode"),md=Vn("parentElement");var pd=Vn("childNodes"),dd=Vn("firstChild"),_d=Vn("lastChild"),vd=Vn("previousSibling"),gd=Vn("nextSibling"),yd=Vn("nodeValue");var Dd=Vn("textContent");function ga(n){return function(r){return function(){r.appendChild(n)}}}function sf(n){return function(r){return function(){return r.getElementById(n)}}}var Md=m(F),Or=function(n){var r=Md(q),e=sf(n);return function(t){return r(e(t))}};function zn(n){return function(){return function(r){return n(r)()}}}function jn(n){return function(r){return function(e){return function(t){return function(){return t.addEventListener(n,r,e)}}}}}var mf=p;function pf(n){return function(r){return r.item(n)}}var Pd=m(vn),Hd=function(n){var r=pf(n);return function(e){return q(r(e))}},df=function(n){var r=We(n);return function(e){return r(function(t){return Pd(mn(Q.create)(t+1|0))(Hd(t)(e))})(0)}};function ya(n){return function(){return URL.createObjectURL(n)}}var Da=function(){return window};function _f(n){return n.body}var kd=m(F);var Br=p;var vf=p,Ta=p;var gf=function(n){return kd(q)(function(){return _f(n)})};function yf(n,r,e){var t=Object.prototype.toString.call(e);return t.indexOf("[object HTML")===0&&t.indexOf("Element]")===t.length-8?r(e):n}function ba(n){return function(){return n.click()}}function ha(n){return function(){return n.offsetWidth}}function Ca(n){return function(){return n.offsetHeight}}var Df=p;var Tf=p;var Ea=function(n){return yf(s.value,l.create,n)};function Cf(n){return function(){return n.files}}function me(n){return function(){return n.value}}var b_=m(F);var Pt=g("HTMLInputElement");var Ma=function(){var n=b_(q);return function(r){return n(Cf(r))}}();function Ht(n){return function(){return n.value}}var Mf=g("HTMLTextAreaElement");function Fa(n){return function(){return n.document}}function Ve(n){return n.clientX}function ze(n){return n.clientY}var At=g("MouseEvent");var Ir=T(hn),V_=Qn(Yn),je=ke(Cn)(Cr(F)),z_=Mn(je),Ia=$r(Dn),pe=N(Ia),xa=Xn(Ia),Wt=le(Dn),kr=Fr(ce)(Dn),Ff=V_(Ia),xf=Xn(Dr),If=T(Be(Dn)),j_=ht(Cn),Q_=of()(),La=Pn(je),Lf=lr(je),X_=On(je),Y_=qn(je),Jr=Pi(Cn),K_=df(ra),wa=function(n){return function(r){return function(e){return function(){var a=va(Tf(r))(),o=ha(r)(),u=Ca(r)(),f=Ie(n)(),i=Le(n)();return{x:(e.x-a.left)*f/o,y:(e.y-a.top)*i/u}}}}},de=function(n){return function(){var e=ae(n.canvas)(),t=Wu(n.canvas)();return xo(e)({x:0,y:0,width:t.width,height:t.height})(),Fn(e)(z_(e)(n.layer))()}},wf=function(n){return function(r){return Ur(pe(xa(Wt)(kr(Bo(n))))(function(e){return Ff(kr(Oo(e)(r)))(function(){return pe(kr(xf(Fa)(Da)))(function(t){return pe(xa(Wt)(kr(Or("canvas")(Br(t)))))(function(a){return pe(Wt(Ea(a)))(function(o){return If({canvas:e,canvasElement:a,canvasHtmlElement:o,document:t})})})})})}))}},Sf=function(n){var r=In(n);return function(e){return function(t){return function(){var o=j_(r(t))();return Q_(e)({layer:o})}}}},Z_=function(n){return zn(function(r){var e=At(r);if(e instanceof s)return Ir(void 0);if(e instanceof l)return function(){var a=La(n.layer)(),o=wa(n.canvas)(n.canvasHtmlElement)({x:cn(Ve(e.value0)),y:cn(ze(e.value0))})(),u={translateX:o.x-a.x,translateY:o.y-a.y};return Lf(u)(n.layer)(),X_(n.layer)(),de(n)()};throw new Error("Failed pattern match at Template.Main (line 194, column 60 - line 205, column 22): "+[e.constructor.name])})},nv=function(n){return zn(function(r){var e=At(r);if(e instanceof s)return Ir(void 0);if(e instanceof l)return function(){var a=La(n.layer)(),o=wa(n.canvas)(n.canvasHtmlElement)({x:cn(Ve(e.value0)),y:cn(ze(e.value0))})(),u={translateX:o.x-a.x,translateY:o.y-a.y};return Lf(u)(n.layer)(),de(n)()};throw new Error("Failed pattern match at Template.Main (line 181, column 62 - line 191, column 22): "+[e.constructor.name])})},rv=function(n){return zn(function(r){var e=At(r);if(e instanceof s)return Ir(void 0);if(e instanceof l)return function(){var a=La(n.layer)(),o=wa(n.canvas)(n.canvasHtmlElement)({x:cn(Ve(e.value0)),y:cn(ze(e.value0))})(),u={offsetX:o.x-a.x,offsetY:o.y-a.y};return Y_(u)(n.layer)(),de(n)()};throw new Error("Failed pattern match at Template.Main (line 168, column 62 - line 178, column 22): "+[e.constructor.name])})},ev=function(n){return zn(function(r){return de(n)})},Sa=function(n){return function(r){return function(e){return function(t){return Ur(function(){var a=Br(t.document);return pe(xa(Wt)(kr(Or(n)(a))))(function(o){return pe(kr(zn(function(u){return function(){var i=St("canvas")(Ta(t.document))();Ge("id")("hidden-clip-canvas")(i)();var _=gf(t.document)();if(_ instanceof l){ga(lf(i))(Df(_.value0))();var c=Bo("hidden-clip-canvas")();if(c instanceof l){Oo(c.value0)({width:e.width,height:e.height})();var v=ae(c.value0)(),h=t.canvas;Ro(v)(h)(e.x)(e.y)(e.width)(e.height)(0)(0)(e.width)(e.height)();var W=Co(c.value0)(),C=St("a")(Ta(t.document))();Ge("href")(W)(C)(),Ge("download")(r)(C)();var M=Ea(C);if(M instanceof l)return ba(M.value0)();throw new Error("Failed pattern match at Template.Main (line 162, column 9 - line 162, column 53): "+[M.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 151, column 5 - line 151, column 64): "+[c.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 148, column 5 - line 148, column 53): "+[_.constructor.name])}})))(function(u){return Ff(kr(jn("click")(u)(!1)(mr(o))))(function(){return If(o)})})})}())}}}};var tv=function(n){return function(r){return function(e){return function(t){return function(){var o=Or(r)(Br(n.document))();if(o instanceof l){var u=Mf(o.value0);if(u instanceof l){var f=Ht(u.value0)();Jr(t(f))(e)();var i=zn(function(_){return function(){var v=Ht(u.value0)();return Jr(t(v))(e)()}})();return jn("input")(i)(!1)(mr(o.value0))()}throw new Error("Failed pattern match at Template.Main (line 241, column 7 - line 241, column 55): "+[u.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 240, column 3 - line 240, column 79): "+[o.constructor.name])}}}}},Ut=function(n){return function(r){return function(e){return function(t){return tv(n)(r)(e)(function(a){return function(o){return function(u){return Ir(o(u))}}(t(a))})}}}},Nf=function(n){return function(r){return function(e){return function(t){return function(){var o=Or(r)(Br(n.document))();if(o instanceof l){var u=Pt(o.value0);if(u instanceof l){var f=me(u.value0)();(function(){var _=ko(f);if(_ instanceof l)return Jr(t(_.value0))(e)();if(_ instanceof s)return void 0;throw new Error("Failed pattern match at Template.Main (line 260, column 3 - line 262, column 25): "+[_.constructor.name])})();var i=zn(function(_){return function(){var v=me(u.value0)(),h=ko(v);if(h instanceof l)return Jr(t(h.value0))(e)();if(h instanceof s)return void 0;throw new Error("Failed pattern match at Template.Main (line 266, column 5 - line 268, column 27): "+[h.constructor.name])}})();return jn("input")(i)(!1)(mr(o.value0))()}throw new Error("Failed pattern match at Template.Main (line 257, column 7 - line 257, column 52): "+[u.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 256, column 3 - line 256, column 79): "+[o.constructor.name])}}}}},ov=function(n){return function(r){return function(e){return function(t){return Nf(n)(r)(e)(function(a){return function(o){return function(u){return Ir(o(u))}}(t(a))})}}}},Na=function(n){return function(r){return function(e){return ov(n)(r)(e)(Yi)}}},Rf=function(n){var r=ku(n);return function(e){return function(t){return function(a){return function(){var u=Mr(1)();return Nf(e)(t)(a)(function(f){return function(i){return function(){var c=Ln(u)();return fe(f)(u)(),r(f/c)(i)()}}})()}}}}},av=function(n){return function(r){return function(e){return function(t){return function(){var o=Or(r)(Br(n.document))();if(o instanceof l){var u=Pt(o.value0);if(u instanceof l){var f=me(u.value0)();Jr(t(f))(e)();var i=zn(function(_){return function(){var v=me(u.value0)();return Jr(t(v))(e)()}})();return jn("input")(i)(!1)(mr(o.value0))()}throw new Error("Failed pattern match at Template.Main (line 225, column 7 - line 225, column 52): "+[u.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 224, column 3 - line 224, column 79): "+[o.constructor.name])}}}}},Ra=function(n){return function(r){return function(e){return function(t){return av(n)(r)(e)(function(a){return function(o){return function(u){return Ir(o(u))}}(t(a))})}}}},uv=function(n){return function(r){return function(e){return function(t){return function(){var o=Or(r)(Br(n.document))();if(o instanceof l){var u=Pt(o.value0);if(u instanceof l){var f=function(c){if(c instanceof s)return Ir(void 0);if(c instanceof l){var v=sr(K_(c.value0))(0);if(v instanceof s)return Ir(void 0);if(v instanceof l)return Jr(t(v.value0))(e);throw new Error("Failed pattern match at Template.Main (line 292, column 26 - line 294, column 56): "+[v.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 290, column 28 - line 294, column 56): "+[c.constructor.name])},i=Ma(u.value0)();f(i)();var _=zn(function(c){return xf(f)(Ma(u.value0))})();return jn("change")(_)(!1)(mr(o.value0))()}throw new Error("Failed pattern match at Template.Main (line 288, column 7 - line 288, column 52): "+[u.constructor.name])}throw new Error("Failed pattern match at Template.Main (line 287, column 3 - line 287, column 79): "+[o.constructor.name])}}}}};var iv=function(n){return function(r){return function(e){return function(t){return uv(n)(r)(e)(function(a){return t(mf(a))})}}}};var Pf=function(n){return function(r){return function(e){return function(t){return iv(n)(r)(e)(function(a){return function(o){return function(){var f=ya(a)();return t(f)(o)()}}})}}}},Hf=function(n){return function(){var e=rv(n)(),t=nv(n)(),a=Z_(n)(),o=ev(n)();return jn("mousedown")(e)(!1)(mr(n.canvasElement))(),jn("mousemove")(t)(!1)(mr(n.canvasElement))(),jn("mouseup")(a)(!1)(mr(n.canvasElement))(),jn("input")(o)(!1)(vf(n.document))()}};var cv=Qn(Yn),lv=Rr(yn)(nr),Of=rr(er),Bf=dn(F),sv=Of(hn),mv=Xn(Dr),_e=ht(Cn),pv=Ei(Cn),dv=Mi(Cn),_v=Rf(hi(Cn)),Af=aa(Cn),kf=ke(Cn),Wf=In(kf(Lt(Cn))),Jf=ef(Dn),Gf=yt(Cn),Uf=In(Jf(Gf)),vv=In(ta(Dn)),gv=In(kf(Gf)),$f=In(Jf(fa(hn))),yv=Sf(Si(Dn));var Vf=function(n){var r=yt(n),e=Pn(r),t=n.Monad0(),a=t.Bind1(),o=N(a),u=m(a.Apply0().Functor0()),f=xi(n),i=xn(r),_=t.Applicative0(),c=T(_),v=An(r),h=Mn(r),W=qn(r),C=Hn(_),M=On(r);return{position:function(L){return e(L.guillotine)},translate:function(L){return function(w){return o(u(function(an){return function(S){return S+L.translateX}(function(S){return S.x}(an))})(e(w.guillotine)))(function(an){return o(f(w.guillotine))(function(S){var B=Fi(w.guillotine).scaleY,Tn=function(){return S instanceof l&&S.value0.width!==0?Ci({scaleX:(w.xMax-an)/S.value0.width,scaleY:B})(w.guillotine):w.guillotine}();return o(i(L)(Tn))(function(sn){return c({xMax:w.xMax,guillotine:sn})})})})}},containsPoint:function(L){return function(w){return v(L)(w.guillotine)}},draw:function(L){return function(w){return h(L)(w.guillotine)}},dragStart:function(L){return function(w){return o(W(L)(w.guillotine))(function(an){return c({xMax:w.xMax,guillotine:an})})}},drag:function(L){return function(w){return C(Vf(n))(w.guillotine.dragOffset)(L)(w)}},dragEnd:function(L){return o(M(L.guillotine))(function(w){return c({xMax:L.xMax,guillotine:w})})}}},zf=function(n){var r=n.Monad0(),e=Vo(r),t=Pn(e),a=r.Bind1(),o=N(a),u=xn(e),f=Vf(n),i=xn(f),_=ke(n)(Lt(n)),c=xn(_),v=cv(a),h=Hi(n),W=r.Applicative0(),C=T(W),M=a.Apply0().Functor0(),L=m(M),w=Of(W),an=Cr(M),S=An(an),B=In(e),Tn=In(f),sn=In(_),pr=Mn(an),zr=qn(e),$t=Hn(W),Qf=On(e);return{position:function(nn){return t(nn.overlayBackground)},translate:function(nn){return function(R){return o(u(nn)(R.overlayBackground))(function(qt){return o(i(nn)(R.guillotine))(function(Xf){return o(c(nn)(R.author))(function(Yf){return o(c(nn)(R.title))(function(Pa){return v(h(_a(function(Ot){return Ot-nn.translateX}))(Pa))(function(){return v(h(_a(function(Ot){return Ot-nn.translateX}))(R.bodyText))(function(){return C({overlayBackground:qt,guillotine:Xf,author:Yf,bodyText:R.bodyText,title:Pa})})})})})})})}},containsPoint:function(nn){return function(R){return L(lv)(w(S(nn))([B(R.overlayBackground),Tn(R.guillotine),sn(R.bodyText),sn(R.author),sn(R.title)]))}},draw:function(nn){return function(R){return Bf(sv(pr(nn))([B(R.overlayBackground),Tn(R.guillotine),sn(R.bodyText),sn(R.author),sn(R.title)]))}},dragStart:function(nn){return function(R){return o(zr(nn)(R.overlayBackground))(function(qt){return C({guillotine:R.guillotine,bodyText:R.bodyText,author:R.author,title:R.title,overlayBackground:qt})})}},drag:function(nn){return function(R){return $t(zf(n))(R.overlayBackground.dragOffset)(nn)(R)}},dragEnd:function(nn){return o(Qf(nn.overlayBackground))(function(R){return C({guillotine:nn.guillotine,bodyText:nn.bodyText,author:nn.author,title:nn.title,overlayBackground:R})})}}},Dv=In(rf(Dn)(zf(Cn))),O=2,qf={scaleX:O,scaleY:O},Tv=function(n){var r=n.Monad0(),e=N(r.Bind1()),t=aa(n),a=T(r.Applicative0());return function(o){return function(u){return function(f){return function(i){return e(t(o)(u)(f)(ie.value))(function(_){return a({guillotine:_,xMax:i})})}}}}},bv=Tv(Cn),hv=function(){return{width:1080,height:1080*5/4}}(),Vr=function(){return Nn(Kr()(_r({reflectSymbol:function(){return"height"}})()(_r({reflectSymbol:function(){return"width"}})()(Yr)(dr))(dr)))({width:2*O,height:O})(hv)}(),Gr=function(){return Vr.height}(),ln=function(){return Vr.width}(),jf=Bf(function(){var r=wf("canvas")(Vr)();if(r instanceof l){var e=ae(r.value0.canvas)(),t=mv(_e)(pv({x:0,y:0})({scaleX:1,scaleY:1})(ie.value))();Pf(r.value0)("image")(t)(dv)(),_v(r.value0)("image-size")(t)();var a=bv("./img/guillotine2x.png")({x:ln/2+285*O,y:60*O})({scaleX:(ln-180*O-(ln/2+285*O))/1560,scaleY:1})(ln-180*O)(),o=Af("./img/jacobinlogo.svg")({x:ln-120*O,y:Gr-200*O})(qf)(ie.value)(),u=Af("./img/jacobinlogowit.svg")({x:ln/2-120*O,y:Gr-200*O})(qf)(ie.value)(),f=_e({text:"Broodtekst",lineHeight:.95,position:{x:ln-O*60,y:O*150},fillStyle:"#f00",fontName:"Oswald",fontStyle:"normal",fontWeight:"500",fontSize:180,align:Re.value,baseline:fr.value,letterSpacing:"-3px",dragOffset:s.value,maxWidth:new l(ln/2-2*60*O),context:e})();Ut(r.value0)("bodytext")(f)(se)(),Na(r.value0)("bodytext-size")(f)();var i={x:60*O,y:800*O},_=_e({text:"Titel",lineHeight:.9,position:i,maxWidth:new l(ln/2-2*60*O),fillStyle:"#fff",fontName:"Oswald",fontStyle:"normal",fontWeight:"700",fontSize:2*100,align:br.value,baseline:ue.value,letterSpacing:"-2px",dragOffset:s.value,context:e})();Ut(r.value0)("title")(_)(se)(),Na(r.value0)("title-size")(_)();var c=_e({text:"AUTEUR",lineHeight:.95,position:i,fillStyle:"#fff",fontName:"Oswald",fontStyle:"normal",fontWeight:"500",fontSize:O*50,align:br.value,baseline:fr.value,letterSpacing:"-3px",dragOffset:s.value,maxWidth:s.value,context:e})();Ra(r.value0)("author")(c)(se)();var v=Di([Wf(_),Wf(c)]),h=_e({text:"AUTEUR",lineHeight:.95,position:{x:ln/2+128*O,y:Gr-200*O},fillStyle:"#f00",fontName:"Oswald",fontStyle:"normal",fontWeight:"500",fontSize:2*50,align:br.value,baseline:fr.value,letterSpacing:"-3px",dragOffset:s.value,maxWidth:s.value,context:e})();Ra(r.value0)("author")(h)(function(B){return se(at(B))})();var W=_e({text:"Titel",lineHeight:.9,position:{x:ln/2+128*O,y:Gr-200*O+50*O},maxWidth:new l(ln/2-(128+2*60+20)*O),fillStyle:"#f00",fontName:"Oswald",fontStyle:"normal",fontWeight:"700",fontSize:2*50,align:br.value,baseline:fr.value,letterSpacing:"-2px",dragOffset:s.value,context:e})();Ut(r.value0)("title")(W)(se)();var C=Gu({x:ln/2+60*O,y:0})({width:ln,height:Gr})(82.5)("#fff"),M={overlayBackground:C,guillotine:a,bodyText:f,author:h,title:W},L=Ni([Uf(Je(u)),Uf(Je(o)),vv(v),Dv(tf(M)),gv(t),$f(Je(ca({x:0,y:0,width:Vr.width,height:Vr.height})("#f00"))),$f(Je(ca({x:0,y:0,width:Vr.width,height:Vr.height})("#f00")))]),w=yv(r.value0)(L)();de(w)(),Hf(w)();var an=Sa("download-left")("jacobin-titel-links.png")({x:0,y:0,width:ln/2,height:Gr})(w)();if(an instanceof l){var S=Sa("download-right")("jacobin-titel-rechts.png")({x:ln/2,y:0,width:ln/2,height:Gr})(w)();if(S instanceof l)return void 0;throw new Error("Failed pattern match at Jacobin.TitleSlide (line 283, column 3 - line 283, column 169): "+[S.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 282, column 3 - line 282, column 153): "+[an.constructor.name])}throw new Error("Failed pattern match at Jacobin.TitleSlide (line 132, column 3 - line 132, column 72): "+[r.constructor.name])});jf();})();
